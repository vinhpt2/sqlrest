/*!
    *
    * Wijmo Library 5.20232.939
    * https://developer.mescius.com/wijmo
    *
    * Copyright(c) MESCIUS inc. All rights reserved.
    *
    * Licensed under the End-User License Agreement For MESCIUS Wijmo Software.
    * us.sales@mescius.com
    * https://developer.mescius.com/wijmo/licensing
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,l){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,l){e.__proto__=l}||function(e,l){for(var t in l)l.hasOwnProperty(t)&&(e[t]=l[t])})(e,l)};return function(e,l){extendStatics(e,l);function __(){this.constructor=e}e.prototype=null===l?Object.create(l):(__.prototype=l.prototype,new __)}}();!function(e){!function(l){!function(l){l.softDetail=function softDetail(){return e._getModule("wijmo.grid.detail")};l.softMultiRow=function softMultiRow(){return e._getModule("wijmo.grid.multirow")};l.softTransposed=function softTransposed(){return e._getModule("wijmo.grid.transposed")};l.softTransposedMultiRow=function softTransposedMultiRow(){return e._getModule("wijmo.grid.transposedmultirow")}}(l.xlsx||(l.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var l;(function(l){"use strict";var t=function(){function FlexGridXlsxConverter(){}FlexGridXlsxConverter.save=function(l,t,o,r){var n=new e.xlsx.Workbook;this._saveFlexGridToWorkbook(n,l,t,!1,null,void 0,r);o&&n.save(o);return n};FlexGridXlsxConverter.saveAsync=function(l,t,o,r,n,i,s,a){var u=this,d=new e.xlsx.Workbook;if(!s){this._saveFlexGridToWorkbook(d,l,t,!1,null,void 0,a);o?d.saveAsync(o,(function(l){e.isFunction(r)&&r(l,d)}),n,null):e.isFunction(r)&&r(null,d);return d}var c=null!=o;this.cancelAsync((function(){var s,f=[l.collectionView&&l.collectionView.collectionChanged,l.columns&&l.columns.collectionChanged,l.rows&&l.rows.collectionChanged,l.resizedColumn,l.resizedRow],removeHandlers=function(){return f.forEach((function(e){e&&e.removeHandler(restart)}))},restart=function(){u._cs&&u._cs.cancel(!1);clearTimeout(s);s=setTimeout((function(){removeHandlers();d=null;u.saveAsync(l,t,o,r,n,i,void 0,a)}),100)},finish=function(){clearTimeout(s);u._cs=null;removeHandlers()};u._cs=new e.xlsx._SyncPromise(null,finish);f.forEach((function(e){e&&e.addHandler(restart)}));u._saveFlexGridToWorkbook(d,l,t,!0,u._cs,(function(l){e.isFunction(i)&&i(c?Math.round(e.xlsx._map(l,0,100,0,50)):l)}),a).then((function(){if(o){d._externalCancellation=function(){return u._cs};d.saveAsync(o,(function(l){finish();e.isFunction(r)&&r(l,d)}),(function(l){finish();e.isFunction(n)&&n(l)}),(function(l){e.isFunction(i)&&i(Math.round(e.xlsx._map(l,0,100,51,100)))}))}else{finish();e.isFunction(i)&&i(100);e.isFunction(r)&&r(null,d)}}),(function(e){finish();throw e}))}));return null};FlexGridXlsxConverter.cancelAsync=function(l){var t=this;if(this._cs){this._cs.cancel();setTimeout((function(){t._cs=null;e.isFunction(l)&&l()}),100)}else e.isFunction(l)&&l()};FlexGridXlsxConverter.load=function(l,t,o){var r=this;if(t instanceof Blob)_blobToBuffer(t,(function(n){t=null;var i=new e.xlsx.Workbook;i.load(n,o?o.includeStyles:void 0);n=null;l.deferUpdate((function(){r._loadToFlexGrid(l,i,o);i=null}))}));else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){r._loadToFlexGrid(l,t,o);t=null}));else{if(!(t instanceof ArrayBuffer||e.isString(t)))throw"Invalid workbook.";var n=new e.xlsx.Workbook;n.load(t,o?o.includeStyles:void 0);t=null;l.deferUpdate((function(){r._loadToFlexGrid(l,n,o);n=null}))}};FlexGridXlsxConverter.loadAsync=function(l,t,o,r,n){var i=this;if(t instanceof Blob)_blobToBuffer(t,(function(s){t=null;var a=new e.xlsx.Workbook;a.loadAsync(s,(function(){s=null;l.deferUpdate((function(){i._loadToFlexGrid(l,a,o);r&&r(a);a=null}))}),n,o?o.includeStyles:void 0)}));else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){i._loadToFlexGrid(l,t,o);r&&r(t);t=null}));else{if(!(t instanceof ArrayBuffer||e.isString(t)))throw"Invalid workbook.";var s=new e.xlsx.Workbook;s.loadAsync(t,(function(){t=null;l.deferUpdate((function(){i._loadToFlexGrid(l,s,o);r&&r(s);s=null}))}),n,o?o.includeStyles:void 0)}};FlexGridXlsxConverter._saveFlexGridToWorkbook=function(t,r,s,a,u,d,c){var f=new e.xlsx._SyncPromise(u),h=new e.xlsx.WorkSheet,x=!s||null==s.includeColumnHeaders||s.includeColumnHeaders,g=!(!s||null==s.includeRowHeaders)&&s.includeRowHeaders,p=o.Cache,v=s?s.includeColumns:null,m=s?s.formatItem:null,w=[],y=s&&null!=s.convertHtmlEntities?e.asEnum(s.convertHtmlEntities,n):n.Auto;if(s){null!=s.includeCellStyles&&e._deprecated("includeCellStyles","includeStyles");p=!1===e.asBoolean(null!=s.includeStyles?s.includeStyles:s.includeCellStyles,!0)?o.None:!1===e.asBoolean(s.quickCellStyles,!0)?o.Regular:o.Cache}var _=p===o.Cache?new i(500):null;null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style);h.name=s?s.sheetName:"";h.visible=!s||!1!==s.sheetVisible;h.rightToLeft=r.rightToLeft;var C,b=r.wj_sheetInfo;if(b&&b.tables&&b.tables.length>0)for(var T=0;T<b.tables.length;T++)h.tables.push(b.tables[T]);if(!b&&(p!==o.None||m)){(C=document.createElement("div")).style.visibility="hidden";C.setAttribute(e.grid.FlexGrid._WJS_MEASURE,"true");r.hostElement.appendChild(C)}var S=g?r.rowHeaders.columns.length:0,k=this._getPerRowColumnsSettings(r,g?[r.topLeftCells,r.columnHeaders]:[r.columnHeaders]),F=k.cols,R=l.softMultiRow()&&r instanceof l.softMultiRow().MultiRow?this._getPerRowColumnsSettings(r,g?[r.rowHeaders,r.cells]:[r.cells],r.rowsPerItem).cols:null,A=F.length,W=[[r.topLeftCells,r.columnHeaders],[r.rowHeaders,r.cells],[r.bottomLeftCells,r.columnFooters]];x||W.shift();var G=W.map((function(e){return e[1].rows.length})).reduce((function(e,l){return e+l}));F.length&&F[0].forEach((function(l,t){var o=k.bndCols[0][t];if(!(t>=S&&v)||v(o)){var r=new e.xlsx.WorkbookColumn;r._deserialize(l);h._addWorkbookColumn(r)}}));this._saveContentToWorksheet(u,a,Date.now(),0,{panels:W,panelIdx:0,globRowIdx:0,rowsOffset:0,totalRows:G},r,h,g,(function(l){return l==e.grid.CellType.Cell&&R?R:F}),p,C,w,_,v,y,m,(function(e){d(Math.round(e/G*100))}),(function(){var l=new e.xlsx.WorkbookFrozenPane;l.rows=x?r.rows.frozen+A:r.rows.frozen;l.columns=g?r.columns.frozen+S:r.columns.frozen;var n=Math.min(r.columns.length,r.columns.frozen);if(v)for(var i=0;i<n;i++)v(r.columns[i])||l.columns--;h.frozenPane=l;t._addWorkSheet(h);if(!b&&(p!==o.None||m)){r.hostElement.removeChild(C);w.forEach((function(e){return e.forEach((function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}))}))}_&&_.clear();t.activeWorksheet=s?s.activeWorksheet:null;f.resolve()}),c);return f};FlexGridXlsxConverter._saveContentToWorksheet=function(l,t,o,r,n,i,s,a,u,d,c,f,h,x,g,p,v,m,w){for(var y=this,_=w||(d?20:200),_loop_1=function(b){if(l&&l.cancelled)return{value:void 0};if(t&&b-r>_&&Date.now()-o>100){setTimeout((function(){if(!l||!l.cancelled){v(b);y._saveContentToWorksheet(l,t,Date.now(),b,n,i,s,a,u,d,c,f,h,x,g,p,v,m,w)}}),0);return{value:void 0}}for(;b-n.rowsOffset>=n.panels[n.panelIdx][1].rows.length;){n.rowsOffset+=n.panels[n.panelIdx][1].rows.length;n.panelIdx++}var T=n.panels[n.panelIdx],S=T[0],k=T[1],F=b-n.rowsOffset,R=k.rows[F];if(k.cellType!==e.grid.CellType.Cell&&R.renderSize<=0||R instanceof e.grid._NewRowTemplate)return"continue";var A=0,W={},G=new e.xlsx.WorkbookRow,B=R instanceof e.grid.GroupRow,M=0;k.cellType===e.grid.CellType.Cell&&(B?M=R.level:i.rows.maxGroupLevel>-1&&(M=i.rows.maxGroupLevel+1));var N=u(k.cellType);a&&(A=C._parseFlexGridRowToSheetRow(s,S,W,F,0,N,d,c,f,h,B,M,x,g,p));C._parseFlexGridRowToSheetRow(s,k,W,F,A,N,d,c,f,h,B,M,x,g,p);if(W.cells.length>0){G._deserialize(W);s._addWorkbookRow(G,n.globRowIdx)}n.globRowIdx++},C=this,b=r;b<n.totalRows;b++){var T=_loop_1(b);if("object"==typeof T)return T.value}e.isFunction(m)&&m()};FlexGridXlsxConverter._loadToFlexGrid=function(t,o,r){if(l.softTransposedMultiRow()&&t instanceof l.softTransposedMultiRow().TransposedMultiRow)throw"Not supported.";r=r||{};var n,i=null!=t.wj_sheetInfo,s={},a=[],u=[],d={};t.itemsSource=null;t.columns.clear();t.columnHeaders.rows.clear();t.rows.clear();t.columns.frozen=0;t.rows.frozen=0;var c=null==r.sheetIndex||isNaN(r.sheetIndex)?0:r.sheetIndex;if(c<0||c>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=r.sheetName)for(var f=0;f<o.sheets.length;f++)if(r.sheetName===o.sheets[f].name){n=o.sheets[f];break}if(null!=(n=n||o.sheets[c]).rows){for(var h=this._getColumnCount(n.rows),x=this._getRowCount(n.rows,h),g=n.columns,p=0;p<h;p++){t.columns.push(new e.grid.Column);if(g[p]){isNaN(+g[p].width)||(t.columns[p].width=+g[p].width);g[p].visible||null==g[p].visible||(t.columns[p].visible=!!g[p].visible);g[p].style&&g[p].style.wordWrap&&(t.columns[p].wordWrap=g[p].style.wordWrap)}}var v,m=(null==r.includeColumnHeaders||r.includeColumnHeaders)&&n.rows.length>0,w=m?this._getColumnHeadersHeight(n):0,y=!1,_=[],C=n.frozenPane&&n.frozenPane.rows,b=n.frozenPane&&n.frozenPane.columns;C=e.isNumber(C)&&!isNaN(C)?C:null;b=e.isNumber(b)&&!isNaN(b)?b:null;for(var T=w;T<x;T++){var S=!1,k=null,F=n.rows[T];if(F)for(var R=T+1;R<n.rows.length;){var A=n.rows[R];if(A){(isNaN(F.groupLevel)&&!isNaN(A.groupLevel)||!isNaN(F.groupLevel)&&F.groupLevel<A.groupLevel)&&(S=!0);break}R++}if(S&&!n.summaryBelow){v&&(v.isCollapsed=y);(v=new e.grid.GroupRow).isReadOnly=!1;y=null!=F.collapsed&&F.collapsed;v.level=isNaN(F.groupLevel)?0:F.groupLevel;d[v.level]=y;this._checkParentCollapsed(d,v.level)&&v._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);t.rows.push(v)}else{var W=new e.grid.Row;F&&this._checkParentCollapsed(d,F.groupLevel)&&W._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);t.rows.push(W)}F&&F.height&&!isNaN(F.height)&&(t.rows[T-w].height=F.height);for(p=0;p<h;p++)if(F){var G=F.cells[p],B=G?G.formula:null;B&&"="!==B[0]&&(B="="+B);if(G&&G.textRuns&&G.textRuns.length>0){t.rows[T-w].isContentHtml=!0;t.setCellData(T-w,p,this._parseTextRunsToHTML(G.textRuns))}else{var M=B&&i?B:this._getItemValue(G);t.setCellData(T-w,p,M,""!=M)}S||this._setColumn(_,p,G);var N=T*h+p,D=G?G.style:null;if(D){k=null==k?!!D.wordWrap:k&&!!D.wordWrap;if(i){var E=e.xlsx.Workbook._parseExcelFormat(G),H=void 0;if(D.hAlign)H=e.xlsx.Workbook._parseHAlignToString(e.asEnum(D.hAlign,e.xlsx.HAlign));else switch(this._getItemType(G)){case e.DataType.Number:H="right";break;case e.DataType.Boolean:H="center";break;default:H=E&&0===E.search(/[n,c,p]/i)?"right":"left"}s[N]={fontWeight:D.font&&D.font.bold?"bold":"none",fontStyle:D.font&&D.font.italic?"italic":"none",textDecoration:D.font&&D.font.underline?"underline":"none",textAlign:H,fontFamily:D.font&&D.font.family?D.font.family:"",fontSize:D.font&&D.font.size?D.font.size+"px":"",color:D.font&&D.font.color?D.font.color:"",backgroundColor:D.fill&&D.fill.color?D.fill.color:"",whiteSpace:D.wordWrap?"pre-wrap":"normal",format:E};if(D.borders){if(D.borders.left){this._parseBorderStyle(D.borders.left.style,"Left",s[N]);s[N].borderLeftColor=D.borders.left.color}if(D.borders.right){this._parseBorderStyle(D.borders.right.style,"Right",s[N]);s[N].borderRightColor=D.borders.right.color}if(D.borders.top){this._parseBorderStyle(D.borders.top.style,"Top",s[N]);s[N].borderTopColor=D.borders.top.color}if(D.borders.bottom){this._parseBorderStyle(D.borders.bottom.style,"Bottom",s[N]);s[N].borderBottomColor=D.borders.bottom.color}}if(D.fill&&D.fill.color){var I=s[N],X=D.borders,z=D.fill.color;if(X){X.left&&X.left.color||(I.borderLeftColor=z);X.right&&X.right.color||p===b-1||(I.borderRightColor=z);X.top&&X.top.color||(I.borderTopColor=z);X.bottom&&X.bottom.color||T===C-1||(I.borderBottomColor=z)}else{I.borderLeftColor=z;p!==b-1&&(I.borderRightColor=z);I.borderTopColor=z;T!==C-1&&(I.borderBottomColor=z)}}D.font&&-1===u.indexOf(D.font.family)&&u.push(D.font.family)}}i&&G&&e.isNumber(G.rowSpan)&&G.rowSpan>0&&e.isNumber(G.colSpan)&&G.colSpan>0&&(G.rowSpan>1||G.colSpan>1)&&a.push(new e.grid.CellRange(T,p,T+G.rowSpan-1,p+G.colSpan-1))}if(F){this._checkParentCollapsed(d,F.groupLevel)||F.visible||null==F.visible||(t.rows[T-w].visible=F.visible);t.rows[T-w].wordWrap=!!F.style&&!!F.style.wordWrap||!!k}}v&&(v.isCollapsed=y);null!=b&&(t.columns.frozen=b);null!=C&&(t.rows.frozen=m&&C>0?C-1:C);for(p=0;p<t.columnHeaders.columns.length;p++){var L=_[p],O=t.columns[p];O.isRequired=!1;if(L){L.dataType===e.DataType.Boolean&&(O.dataType=L.dataType);O.format=L.format;O.align=L.hAlign;O.wordWrap=O.wordWrap||!!L.wordWrap}}for(f=0;f<Math.max(w,1);f++)t.columnHeaders.rows.push(new e.grid.Row);for(f=0;f<w;f++)for(var j=0;j<t.columnHeaders.columns.length;j++){var P=n.rows[f]?n.rows[f].cells[j]:null,V=P&&null!=P.value?P.value:"",U=t.columnHeaders.columns[j];if(V){var Y=e.xlsx.Workbook._parseExcelFormat(P);V=e.Globalize.format(V,Y)}U.header=U.header||V;t.columnHeaders.setCellData(f,j,V)}if(i){var q=null!=r.sheetVisible?r.sheetVisible:!1!==n.visible;t.wj_sheetInfo.name=n.name;t.wj_sheetInfo.visible=q;t.wj_sheetInfo.styledCells=s;t.wj_sheetInfo.mergedRanges=a;t.wj_sheetInfo.fonts=u;t.wj_sheetInfo.tables=n.tables}}};FlexGridXlsxConverter._getColumnHeadersHeight=function(e){var l;if(!e||!(l=e.rows).length)return 0;if(!l[0])return 1;for(var t=0,o=1;t<l.length&&o>0;t++,o--){var r=l[t].cells.reduce((function(e,l){return Math.max(e,l.rowSpan||0)}),1);r>o&&(o=r)}return t};FlexGridXlsxConverter._escapePlainText=function(e){return null==e?"":""===e?"'":"'"===e[0]||e.length>1&&"="===e[0]&&"="===e[1]?"'"+e:e};FlexGridXlsxConverter._parseFlexGridRowToSheetRow=function(t,i,s,a,u,d,c,f,h,x,g,p,v,m,w){var y=i.grid,_=y.wj_sheetInfo,C=i.rows[a],b=0,T=_&&_.evaluateFormula;null==C.recordIndex?i.cellType===e.grid.CellType.ColumnHeader&&i.rows.length>1&&(b=Math.min(a,d.length-1)):b=C.recordIndex;s.cells||(s.cells=[]);s.visible=C.isVisible;s.height=C.renderHeight||i.rows.defaultSize;s.groupLevel=p;g&&(s.collapsed=C.isCollapsed);C.wordWrap&&(s.style={wordWrap:C.wordWrap});for(var S,k=C.constructor===e.grid.Row||C.constructor===e.grid._NewRowTemplate||l.softTransposed()&&y instanceof l.softTransposed().TransposedGrid&&C instanceof e.grid.Row||l.softDetail()&&C.constructor===l.softDetail().DetailRow||l.softMultiRow()&&C.constructor===l.softMultiRow()._MultiRow||l.softTransposedMultiRow()&&C instanceof l.softTransposedMultiRow()._MultiRow,F=l.softDetail()&&C.constructor===l.softDetail().DetailRow,R=0,A=Math.round(e.xlsx._xlsx._parsePixelToCharWidth(y.treeIndent)||0),getTreeIndent=function(e){return e*A},W=!1;R<i.columns.length;R++){var G=void 0,B=void 0,M=void 0,N=1,D=1,E=!1,H=y._getBindingColumn(i,a,i.columns[R]),I=0;if(_&&i===y.cells){var X=a*i.columns.length+R;_.mergedRanges&&(G=this._getMergedRange(a,R,_.mergedRanges));_.styledCells&&(B=_.styledCells[X])}else if(c!==o.None){M=this._getMeasureCell(i,R,f,h);B=(G=y.getMergedRange(i,a,R,!1))?this._getCellStyle(i,M,G.bottomRow,G.rightCol,x,!!w)||{}:this._getCellStyle(i,M,a,R,x,!!w)||{}}G||(G=y.getMergedRange(i,a,R,!1));if(G){if(a===G.topRow&&R===G.leftCol){D=G.bottomRow-G.topRow+1;N=this._getColSpan(i,G,v);E=!0}if(R>G.leftCol&&R<=G.rightCol&&W){E=!0;W=!1;N=G.rightCol-R+1}}else E=!0;if(!v||v(H)){var z=d[b]?d[b][R+u]:null,L=void 0,O=void 0,j=void 0,P=void 0,V=void 0,U=void 0,Y=void 0;if(k||g){j=E?i.getCellData(a,R,!0):null;P=E?i.getCellData(a,R,!1):null;O=this._isFormula(j);L=null;V=e.isDate(P);if(i.cellType===e.grid.CellType.ColumnHeader&&e.isString(j))Y="General";else if(B&&B.format){U=B.format;/[hsmyt\:]/i.test(U={d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy"}[U]||U)&&(V=!0);Y=e.xlsx.Workbook._parseCellFormat(B.format,V)}else if(z&&z.style&&z.style.format){U=H.format;Y=z.style.format}else Y=null;O&&null!=T&&e.isFunction(T)&&(L=T(j));if(!Y)if(V)Y="m/d/yyyy";else if(e.isNumber(P)&&!H.dataMap)Y=e.isInt(P)?"#,##0":"#,##0.00";else if(O){var q=j.toLowerCase();if(q.indexOf("now()")>-1){Y="m/d/yyyy h:mm";V=!0}else if(q.indexOf("today()")>-1||q.indexOf("date(")>-1){Y="m/d/yyyy";V=!0}else if(q.indexOf("time(")>-1){Y="h:mm AM/PM";V=!0}}else Y="General"}else{j=E?y.columnHeaders.getCellData(0,R,!0):null;Y="General"}var J=void 0;if(e.isString(j)&&"{"!==j[0]&&-1!==j.indexOf("<span")){J=this._parseToTextRuns(j);j=null}var K=this._parseCellStyle(B)||{};if(i===y.cells&&g&&C.hasChildren&&R===y.columns.firstVisibleIndex){var $=void 0;if(O&&null!=L)$=L;else{j?$=j:E&&($=C.getGroupHeader());$&&($=$.replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'"))}if(null==$&&!B)continue;!(V=e.isDate($))&&U&&"d"===U.toLowerCase()&&e.isInt($)&&(Y="0");$=e.isString($)?e.xlsx.Workbook._unescapeXML($):$;R===y.columns.firstVisibleIndex&&y.treeIndent&&(I=getTreeIndent(p));S={value:$,isDate:V,formula:O?this._parseToExcelFormula(j,V):null,colSpan:N,rowSpan:D,style:this._extend(K,{format:Y,font:y.childItemsPath?{}:{bold:!0},hAlign:t.rightToLeft?e.xlsx.HAlign.Right:e.xlsx.HAlign.Left,indent:I}),textRuns:J}}else{if(g||m===n.Auto&&H.isContentHtml||m===n.Yes){j=e.isString(j)?e.xlsx.Workbook._unescapeXML(j):j;P=e.isString(P)?e.xlsx.Workbook._unescapeXML(P):P}!V&&U&&"d"===U.toLowerCase()&&e.isInt(P)&&(Y="0");var Q=void 0,Z=void 0;Q=K&&K.hAlign?K.hAlign:z&&z.style&&null!=z.style.hAlign?e.asEnum(z.style.hAlign,e.xlsx.HAlign,!0):e.isDate(P)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General;i===y.cells&&R===y.columns.firstVisibleIndex&&y.treeIndent&&(t.rightToLeft&&Q===e.xlsx.HAlign.Right||!t.rightToLeft&&Q===e.xlsx.HAlign.Left||Q===e.xlsx.HAlign.General)&&(I=getTreeIndent(p));B&&B.verticalAlign&&(Z=e.xlsx.Workbook._parseStringToVAlign(B.verticalAlign));S={value:O?L:"General"!==Y||""===j&&null==P||!0===P||!1===P?this._escapePlainText(P):this._escapePlainText(j),isDate:V,formula:O?this._parseToExcelFormula(j,V):null,colSpan:R<y.columns.firstVisibleIndex?1:N,rowSpan:D,style:this._extend(K,{format:Y,hAlign:Q,vAlign:void 0!==Z?Z:D>1?i===y.cells||!1===y.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:I}),textRuns:J}}w&&w(new r(i,new e.grid.CellRange(a,R),M,f,h,x,S));if(F){var ee=i.getCellElement(a,R);if(ee){var le=C.detail;ee.appendChild(le);e.Control.refreshAll(le)}}s.cells.push(S)}else W=E}return u+R};FlexGridXlsxConverter._parseCellStyle=function(l,t){void 0===t&&(t=!1);if(null==l)return null;var o=l.fontSize;o=o?+o.substring(0,o.indexOf("px")):null;isNaN(o)&&(o=null);var r=l.whiteSpace;r=!!r&&r.indexOf("pre")>-1;var n=l.textAlign;"start"===n&&(n="rtl"===l.direction?"right":"left");"end"===n&&(n="rtl"===l.direction?"left":"right");return{font:{bold:"bold"===l.fontWeight||+l.fontWeight>=700,italic:"italic"===l.fontStyle,underline:"underline"===(l.textDecorationStyle||l.textDecoration),family:this._parseToExcelFontFamily(l.fontFamily),size:o,color:l.color},fill:{color:l.backgroundColor},borders:this._parseBorder(l,t),hAlign:e.xlsx.Workbook._parseStringToHAlign(n),wordWrap:r}};FlexGridXlsxConverter._parseBorder=function(e,l){var t={left:this._parseEgdeBorder(e,"Left"),right:this._parseEgdeBorder(e,"Right"),top:this._parseEgdeBorder(e,"Top"),bottom:this._parseEgdeBorder(e,"Bottom")};if(l){t.vertical=this._parseEgdeBorder(e,"Vertical");t.horizontal=this._parseEgdeBorder(e,"Horizontal")}return t};FlexGridXlsxConverter._parseEgdeBorder=function(l,t){var o,r=l["border"+t+"Style"],n=l["border"+t+"Width"];n&&(n=parseFloat(n));if(r&&"none"!==r&&"hidden"!==r&&0!==n){o={};switch(r=r.toLowerCase()){case"dotted":o.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":o.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":o.style=e.xlsx.BorderStyle.Double;break;default:o.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}o.color=l["border"+t+"Color"]}return o};FlexGridXlsxConverter._parseBorderStyle=function(l,t,o){var r="border"+t+"Style",n="border"+t+"Width";switch(l){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:o[r]="dotted";o[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:o[r]="dashed";o[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:o[r]="dashed";o[n]="2px";break;case e.xlsx.BorderStyle.Double:o[r]="double";o[n]="3px";break;case e.xlsx.BorderStyle.Medium:o[r]="solid";o[n]="2px";break;case e.xlsx.BorderStyle.Thick:o[r]="solid";o[n]="3px";break;default:o[r]="solid";o[n]="1px"}};FlexGridXlsxConverter._parseToExcelFontFamily=function(e){var l;e&&(l=e.split(","))&&l.length>0&&(e=l[0].replace(/\"|\'/g,""));return e};FlexGridXlsxConverter._parseToExcelFormula=function(l,t){var o=l.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi);if(o)for(var r=0;r<o.length;r++){var n=(s=o[r]).substring(0,s.lastIndexOf(")"))+", 1)";l=l.replace(s,n)}o=null;if(o=l.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi)){var i=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;for(r=0;r<o.length;r++){var s,a=(s=o[r]).match(i);if(a&&2===a.length){var u=a[1];if(!/^d{1,4}?$/.test(u)){var d=e.xlsx.Workbook._parseCellFormat(u,t);n=s.replace(u,d);l=l.replace(s,n)}}}}return l};FlexGridXlsxConverter._parseToTextRuns=function(e){for(var l=e.split("<span "),t=[],o=0;o<l.length;o++){var r=l[o],n=void 0;n=-1!==r.indexOf("</span>")?{text:r.substring(r.indexOf(">")+1,r.indexOf("</span>")),font:this._parseToTextRunFont(r.substring(r.indexOf('style="')+7,r.indexOf(';"')))}:{text:r};t.push(n)}return t};FlexGridXlsxConverter._parseToTextRunFont=function(e){var l,t=e.split(";");if(t.length>0){for(var o=void 0,r=void 0,n=void 0,i=void 0,s=void 0,a=void 0,u=0;u<t.length;u++){var d=t[u].split(":");if(2===d.length){d[1]=d[1].trim();switch(d[0]){case"font-size":i=+d[1].substring(0,d[1].indexOf("px"));isNaN(i)&&(i=null);break;case"font-weight":o="bold"===d[1]||+d[1]>=700;break;case"font-style":r="italic"===d[1];break;case"text-decoration-style":case"text-decoration":n="underline"===d[1];break;case"font-family":s=this._parseToExcelFontFamily(d[1]);break;case"color":a=d[1]}}}l={bold:o,italic:r,underline:n,family:s,size:i,color:a}}return l};FlexGridXlsxConverter._getMeasureCell=function(e,l,t,o){var r=o[e.cellType],n=r&&r[l],i=null==n;if(n){if(this.hasCssText){n.style.cssText="";n.style.visibility="hidden"}}else{r||(o[e.cellType]=r=[]);r[l]=n=t.cloneNode()}!i&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n));return n};FlexGridXlsxConverter._getColumnSetting=function(l,t,o){var r=l;null!=l.colspan&&(r=this._getRenderColumn(t,o));return r?{autoWidth:!0,width:r.renderWidth||o.defaultSize,visible:r.visible&&0!==r.width&&!r._getFlag(e.grid.RowColFlags.ParentCollapsed),style:{format:l.format?e.xlsx.Workbook._parseCellFormat(l.format,l.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(r.getAlignment())),wordWrap:r.wordWrap}}:null};FlexGridXlsxConverter._getPerRowColumnsSettings=function(e,l,t){var o=this,r=[],n=[];l.forEach((function(i,s){for(var a=0,u=s>0?l[0].columns.length:0,_loop_2=function(l){if(null!=t&&l>=t)return"break";if(i.rows[l].renderSize<=0)return"continue";r[a]=r[a]||[];n[a]=n[a]||[];i.columns.forEach((function(t,s){var d=e._getBindingColumn(i,l,t),c=o._getColumnSetting(d,s,i.columns);if(c){r[a][u+s]=c;n[a][u+s]=d}}));a++},d=0;d<i.rows.length&&"break"!==_loop_2(d);d++);}));return{cols:r,bndCols:n}};FlexGridXlsxConverter._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e};FlexGridXlsxConverter._getColumnCount=function(l){for(var t=0,o=0;o<l.length;o++){var r=l[o]&&l[o].cells?l[o].cells:[];if(r&&r.length>0){var n=r.length;e.isInt(r[n-1].colSpan)&&r[n-1].colSpan>1&&(n=n+r[n-1].colSpan-1);n>t&&(t=n)}}return t};FlexGridXlsxConverter._getRowCount=function(l,t){for(var o=l.length,r=o-1,n=0;n<t;n++)e:for(;r>=0;r--){var i=l[r],s=(i&&i.cells?i.cells:[])[n];if(s&&(null!=s.value&&""!==s.value||e.isInt(s.rowSpan)&&s.rowSpan>1)){e.isInt(s.rowSpan)&&s.rowSpan>1&&r+s.rowSpan>o&&(o=r+s.rowSpan);break e}}return o};FlexGridXlsxConverter._numAlpha=function(e){var l=Math.floor(e/26)-1;return(l>-1?this._numAlpha(l):"")+String.fromCharCode(65+e%26)};FlexGridXlsxConverter._getItemType=function(l){return null==l||null==l.value||isNaN(l.value)?null:e.getType(l.value)};FlexGridXlsxConverter._setColumn=function(l,t,o){var r=l[t],n=this._getItemType(o);n===e.DataType.Boolean&&o.formula&&(n=null);if(r){r.dataType!==n&&r.dataType===e.DataType.Boolean&&n!==e.DataType.Boolean&&(r.dataType=n);if(o&&null!=o.value&&(!e.isString(o.value)||!e.isNullOrWhiteSpace(o.value))){var i=e.xlsx.Workbook._parseExcelFormat(o);i&&r.format!==i&&"General"!==i&&(r.format=i)}var s=void 0,a=void 0;if(o&&o.style){o.style.hAlign&&(s=e.xlsx.Workbook._parseHAlignToString(e.asEnum(o.style.hAlign,e.xlsx.HAlign)));o.style.vAlign&&(a=e.xlsx.Workbook._parseVAlignToString(e.asEnum(o.style.vAlign,e.xlsx.VAlign)));null==r.wordWrap?r.wordWrap=!!o.style.wordWrap:r.wordWrap=r.wordWrap&&!!o.style.wordWrap}s||n!==e.DataType.Number||(s="right");r.hAlign=s;r.vAlign=a}else l[t]={dataType:n,format:e.xlsx.Workbook._parseExcelFormat(o),hAlign:"",vAlign:"",wordWrap:null}};FlexGridXlsxConverter._getItemValue=function(l){if(null==l||null==l.value)return null;var t=l.value;e.isString(t)&&"'"===t[0]&&(t=t.substr(1));return e.isNumber(t)&&isNaN(t)?"":t instanceof Date&&isNaN(t.getTime())?"":t};FlexGridXlsxConverter._getCellStyle=function(e,l,t,o,r,n){var i,s=e.grid;try{var a=!(r&&!s.formatItem.hasHandlers&&!s.itemFormatter&&!n);s.cellFactory.updateCell(e,t,o,l,null,a);l.className=l.className.replace("wj-state-selected","");l.className=l.className.replace("wj-state-multi-selected","")}catch(e){return null}if(r){var u=e.hostElement,d=l,c=d.style.cssText.split(/;\s+/).filter((function(e){var l=e.substring(0,e.indexOf(":"));return/^(color|background|border|font|text|whitespace)/i.test(l)})).join(";");do{c=d.className+c}while(d!==u&&(d=d.parentElement));if(!(i=r.getValue(c))){i=window.getComputedStyle(l);r.add(c,i)}}else i=window.getComputedStyle(l);return i};FlexGridXlsxConverter._parseTextRunsToHTML=function(e){for(var l="",t=0;t<e.length;t++){var o=e[t],r=o.font;l+=r?'<span style="'+(r.bold?"font-weight: bold;":"")+(r.italic?"font-style: italic;":"")+(r.underline?"text-decoration: underline;":"")+(r.family?"font-family: "+r.family+";":"")+(null!=r.size?"font-size: "+r.size+"px;":"")+(r.color?"color: "+r.color+";":"")+'">'+o.text+"</span>":o.text}return l};FlexGridXlsxConverter._extend=function(l,t){for(var o in t){var r=t[o];e.isObject(r)&&l[o]?e.copy(l[o],r):l[o]=r}return l};FlexGridXlsxConverter._checkParentCollapsed=function(e,l){var t=!1;Object.keys(e).forEach((function(o){!0===e[o]&&!1===t&&!isNaN(l)&&+o<l&&(t=!0)}));return t};FlexGridXlsxConverter._getColSpan=function(e,l,t){for(var o=0,r=l.leftCol;r<=l.rightCol;r++)t&&!t(e.columns[r])||o++;return o};FlexGridXlsxConverter._getRenderColumn=function(e,l){return e>=l.length?null:l[e]};FlexGridXlsxConverter._getMergedRange=function(e,l,t){for(var o=0;o<t.length;o++){var r=t[o];if(e>=r.topRow&&e<=r.bottomRow&&l>=r.leftCol&&l<=r.rightCol)return r}return null};FlexGridXlsxConverter._isFormula=function(e){return e&&"string"==typeof e&&e.length>1&&"="===e[0]&&"="!==e[1]};return FlexGridXlsxConverter}();l.FlexGridXlsxConverter=t;var o,r=function(e){__extends(XlsxFormatItemEventArgs,e);function XlsxFormatItemEventArgs(l,t,o,r,n,i,s){var a=e.call(this,l,t)||this;a._cell=o;a._patternCell=r;a._xlsxCell=s;a._cellsCache=n;a._styleCache=i;return a}Object.defineProperty(XlsxFormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(XlsxFormatItemEventArgs.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0});XlsxFormatItemEventArgs.prototype.getFormattedCell=function(){if(!this._cell){this._cell=t._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache);t._getCellStyle(this.panel,this._cell,this.row,this.col,this._styleCache,!0)}return this._cell};return XlsxFormatItemEventArgs}(e.grid.CellRangeEventArgs);l.XlsxFormatItemEventArgs=r;!function(e){e[e.None=0]="None";e[e.Regular=1]="Regular";e[e.Cache=2]="Cache"}(o||(o={}));var n,i=function(){function _StyleCache(e){this._cache={};this._size=0;this._max=e}_StyleCache.prototype.add=function(e,l){this._size>=this._max&&this.clear();this._cache[e]=this._cloneStyle(l);this._size++};_StyleCache.prototype.clear=function(){this._cache={};this._size=0};_StyleCache.prototype.getValue=function(e){return this._cache[e]||null};_StyleCache.prototype.hasKey=function(e){return!!this._cache[e]};_StyleCache.prototype._cloneStyle=function(e){if(!e)return null;for(var l={},toCamel=function(e){return e.replace(/\-([a-z])/g,(function(e,l,t){return t>0?l.toUpperCase():l}))},t=0,o=e.length;t<o;t++){var r=e[t];l[toCamel(r)]=e.getPropertyValue(r)}return l};return _StyleCache}();l._StyleCache=i;function _blobToBuffer(e,l){if(e&&l)if(e.arrayBuffer)e.arrayBuffer().then((function(e){return l(e)}));else{var t=new FileReader;t.onload=function(){l(t.result);t=null};t.readAsArrayBuffer(e)}}l._blobToBuffer=_blobToBuffer;!function(e){e[e.Auto=0]="Auto";e[e.No=1]="No";e[e.Yes=2]="Yes"}(n=l.HtmlEntityConversion||(l.HtmlEntityConversion={}))})((l=e.grid||(e.grid={})).xlsx||(l.xlsx={}))}(wijmo||(wijmo={}));!function(e){!function(l){l.xlsx||(l.xlsx={}),e._registerModule("wijmo.grid.xlsx",e.grid.xlsx)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));