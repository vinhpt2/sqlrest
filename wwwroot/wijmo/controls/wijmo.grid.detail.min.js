/*!
    *
    * Wijmo Library 5.20232.939
    * https://developer.mescius.com/wijmo
    *
    * Copyright(c) MESCIUS inc. All rights reserved.
    *
    * Licensed under the End-User License Agreement For MESCIUS Wijmo Software.
    * us.sales@mescius.com
    * https://developer.mescius.com/wijmo/licensing
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){!function(t){!function(t){"use strict";var i=function(e){__extends(DetailRow,e);function DetailRow(t){var i=e.call(this)||this;i.isReadOnly=!0;return i}Object.defineProperty(DetailRow.prototype,"detail",{get:function(){return this._detail},set:function(e){this._detail=e},enumerable:!0,configurable:!0});return DetailRow}(e.grid.Row);t.DetailRow=i}(t.detail||(t.detail={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var i=function(i){__extends(DetailMergeManager,i);function DetailMergeManager(e){var t=i.call(this)||this;t._originalMergeManager=e.mergeManager;return t}DetailMergeManager.prototype.getMergedRange=function(i,r,o,n){void 0===n&&(n=!0);switch(i.cellType){case e.grid.CellType.Cell:if(i.rows[r]instanceof t.DetailRow){i.columns.frozen>0&&i.grid&&(i.grid.cloneFrozenCells=!1);return new e.grid.CellRange(r,0,r,i.columns.length-1)}break;case e.grid.CellType.RowHeader:var l=_isFrozen(i,r),a=_isNew(i,r),s=i.rows[r].dataItem;!s&&r>0&&i.rows[r]instanceof t.DetailRow&&(s=i.rows[r-1].dataItem);for(var d=r;d>0&&i.rows[d-1].dataItem==s&&_isFrozen(i,d-1)==l&&_isNew(i,d-1)==a;)d--;for(var c=r;c<i.rows.length-1&&i.rows[c+1].dataItem==s&&_isFrozen(i,c+1)==l&&_isNew(i,c+1)==a;)c++;c<i.rows.length-1&&i.rows[c+1]instanceof t.DetailRow&&_isFrozen(i,c+1)==l&&_isNew(i,c+1)==a&&c++;return d!=c?new e.grid.CellRange(d,o,c,o):null}return this._originalMergeManager.getMergedRange(i,r,o,n)};return DetailMergeManager}(e.grid.MergeManager);t.DetailMergeManager=i;function _isFrozen(e,t){return t<e.rows.frozen}function _isNew(t,i){return t.rows[i]instanceof e.grid._NewRowTemplate}})((t=e.grid||(e.grid={})).detail||(t.detail={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";e._addCultureInfo("FlexGridDetailProvider",{ariaLabels:{toggleDetail:"Toggle Row Detail"}});var i,r;!function(e){e[e.None=0]="None";e[e.ToggleDetail=1]="ToggleDetail"}(i=t.KeyAction||(t.KeyAction={}));!function(e){e[e.Code=0]="Code";e[e.Selection=1]="Selection";e[e.ExpandSingle=2]="ExpandSingle";e[e.ExpandMulti=3]="ExpandMulti"}(r=t.DetailVisibilityMode||(t.DetailVisibilityMode={}));var o=function(){function FlexGridDetailProvider(o,n){var l=this;this._maxHeight=null;this._mode=r.ExpandSingle;this._animated=!1;this._keyActionEnter=i.None;this._g=o;o.mergeManager=new t.DetailMergeManager(o);o.rowHeaders.hostElement.addEventListener("click",this._hdrClick.bind(this));o.rowHeaders.hostElement.addEventListener("mousedown",(function(e){var t=o.editableCollectionView;if(o.activeEditor||t&&t.currentEditItem){l._hdrClick(e);e.preventDefault()}}));setTimeout((function(){o.formatItem.addHandler(l._formatItem,l)}),100);o.selectionChanged.addHandler(this._selectionChanged,this);o.resizedRow.addHandler(this._resizedRow,this);o.loadingRows.addHandler((function(){return l.hideDetail()}));o.deletingRow.addHandler((function(e,t){l.hideDetail(t.row)}));o.updatedView.addHandler(this._handleFrozenCells,this);o.cloneFrozenCells=!1;o.draggingRow.addHandler((function(e,i){if(i.row<e.rows.length-1&&e.rows[i.row+1]instanceof t.DetailRow){i.cancel=!0;l.hideDetail(i.row)}}));o.hostElement.addEventListener("keydown",(function(t){if(t.keyCode==e.Key.Enter&&l._keyActionEnter==i.ToggleDetail){var r=l._g.selection.row;l._toggleRowDetail(r)&&t.preventDefault()}}),!0);o._root.addEventListener("scroll",(function(){e.hasClass(o.activeCell,"wj-detail")&&e.Control.sharedState.InvalidScroll||e.Control.refreshAll(o._root)}));e.copy(this,n)}Object.defineProperty(FlexGridDetailProvider.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridDetailProvider.prototype,"detailVisibilityMode",{get:function(){return this._mode},set:function(t){if((t=e.asEnum(t,r))!=this._mode){this._mode=t;this.hideDetail();this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridDetailProvider.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(t){if((t=e.asNumber(t,!0))!=this._maxHeight){this._maxHeight=t;this.hideDetail()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridDetailProvider.prototype,"isAnimated",{get:function(){return this._animated},set:function(t){t!=this._animated&&(this._animated=e.asBoolean(t))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridDetailProvider.prototype,"keyActionEnter",{get:function(){return this._keyActionEnter},set:function(t){this._keyActionEnter=e.asEnum(t,i)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridDetailProvider.prototype,"createDetailCell",{get:function(){return this._createDetailCellFn},set:function(t){this._createDetailCellFn=e.asFunction(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridDetailProvider.prototype,"disposeDetailCell",{get:function(){return this._disposeDetailCellFn},set:function(t){this._disposeDetailCellFn=e.asFunction(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridDetailProvider.prototype,"rowHasDetail",{get:function(){return this._rowHasDetailFn},set:function(t){if((t=e.asFunction(t,!0))!=this._rowHasDetailFn){this._rowHasDetailFn=t;this.hideDetail();this._g.invalidate()}},enumerable:!0,configurable:!0});FlexGridDetailProvider.prototype.getDetailRow=function(e){for(var i=this._g.rows,r=this._toIndex(e),o=i[r]?i[r].dataItem:void 0;r<i.length;r++){var n=i[r];if(n instanceof t.DetailRow)return n;if(n.dataItem!=o)return null}return null};FlexGridDetailProvider.prototype.isDetailVisible=function(e){return null!=this.getDetailRow(e)};FlexGridDetailProvider.prototype.isDetailAvailable=function(e){e=this._toIndex(e);return this._hasDetail(e)};FlexGridDetailProvider.prototype.hideDetail=function(i){var r=this._g,o=r.rows;if(null!=i){var n=this._toIndex(i);if(n<=r.rows.frozen-1){r.rows.frozenDetailChildren-=1;r.rows.frozen-=1}for(;!(o[n]instanceof t.DetailRow)&&n<o.length-1;)n++;var l=o[n];if(l instanceof t.DetailRow){var a=l.detail.parentElement;if(a)for(var s=a.querySelectorAll(".wj-control"),d=0;d<s.length;d++){var c=e.Control.getControl(s[d]);c&&c.containsFocus()&&r.focus(!0)}var u=this.disposeDetailCell;u&&u(l)||e.Control.disposeAll(l.detail);o.removeAt(n)}}else for(var f=0;f<o.length;f++)o[f]instanceof t.DetailRow&&this.hideDetail(f)};FlexGridDetailProvider.prototype.showDetail=function(i,r){void 0===r&&(r=!1);var o=this._g,n=o.rows,l=this._toIndex(i);if(l<=o.rows.frozen-1){o.rows.frozenDetailChildren+=1;o.rows.frozen+=1}l>0&&n[l]instanceof t.DetailRow&&l--;for(var a=n[l].dataItem;l<n.length-1&&n[l+1].dataItem==a;)l++;if(r){for(var s=o.selection,d=!1,c=0;c<n.length-1;c++)if(c!=l&&n[c+1]instanceof t.DetailRow){this.hideDetail(c);c<l&&l--;if(c<s.row){s.row--;s.row2--;d=!0}}d&&o.select(s,!1)}if(!this.isDetailVisible(l)&&this._hasDetail(l)){var u=new t.DetailRow(n[l]),f=this._createDetailCell(n[l]);u.detail=f;if(f){n.insert(l+1,u);var h=o.containsFocus();if(this._animated){var g=f.style;g.transform="translateY(-100%)";g.opacity="0";e.animate((function(t){if(t<1){g.transform="translateY("+(100*-(1-t)).toFixed(0)+"%)";g.opacity=(t*t).toString()}else{g.transform=g.opacity="";e.Control.invalidateAll(f);h&&o.scrollIntoView(l+1,-1)}}))}else h&&o.scrollIntoView(l+1,-1,!0)}}};FlexGridDetailProvider.prototype._sizeDetailRow=function(t,i){void 0===i&&(i=!1);var r=this._g,o=t.detail;e.Control.refreshAll(o);var n=i?o.scrollHeight:o.offsetHeight,l=n+r._cellPadVert+1,a=this._maxHeight;e.isNumber(a)&&a>0&&l>a&&(l=a);t.height=l;o.style.height||(o.style.height="100%");var s=o.querySelector(".wj-flexgrid");s&&!s.style.height&&(s.style.height="100%");return n};FlexGridDetailProvider.prototype._handleFrozenCells=function(){var t=this._g,i=t.hostElement,r=e.Control.getControl(i.querySelector(".wj-flexgrid"));if(r instanceof e.grid.FlexGrid&&(r.rows.frozen||r.columns.frozen)){e.setCss([t._eTL,t._eBL,t._eCFtr,t._eRHdr,t._eMarquee],{zIndex:"13"});e.setCss(t._eCHdr,{zIndex:"14"});for(var o=i.querySelectorAll(".wj-frozen"),n=0;n<o.length;n++){var l=o[n];if(e.closest(l,".wj-flexgrid")==i){var a=parseInt(l.style.zIndex);l.style.zIndex=(a%10+10).toString()}}}};FlexGridDetailProvider.prototype._toIndex=function(t){return t instanceof e.grid.Row?t.index:e.asNumber(t)};FlexGridDetailProvider.prototype._hdrClick=function(t){if(!t.defaultPrevented&&0==t.button&&e.closestClass(t.target,FlexGridDetailProvider._WJC_DETAIL)){var i=r;switch(this._mode){case i.ExpandMulti:case i.ExpandSingle:var o=this._g,n=o.hitTest(t.target);n.panel||(n=o.hitTest(t));n.panel&&this._toggleRowDetail(n.row)&&t.preventDefault()}}};FlexGridDetailProvider.prototype._toggleRowDetail=function(t){if(t>-1){if(this.isDetailVisible(t)){this.hideDetail(t);return!0}if(this._hasDetail(t)){var i=this._g;i.select(new e.grid.CellRange(t,0,t,i.columns.length-1));this.showDetail(t,this._mode==r.ExpandSingle);return!0}}return!1};FlexGridDetailProvider.prototype._selectionChanged=function(e,t){var i=this;if(this._mode==r.Selection){this._toSel&&clearTimeout(this._toSel);this._toSel=setTimeout((function(){var t=e._selHdl.selection.row;t>-1?i.showDetail(t,!0):i.hideDetail()}),300)}};FlexGridDetailProvider.prototype._formatItem=function(i,o){var n=this,l=this._g,a=o.cell,s=o.getRow(),d=r;if(o.panel==l.cells&&s instanceof t.DetailRow&&null!=s.detail&&!e.hasClass(a,"wj-detail")){e.addClass(a,"wj-detail");a.textContent="";a.style.textAlign="";a.className=a.className.replace(/wj\-align\-[\S]+/g,"");a.appendChild(s.detail);null==s.height?0===this._sizeDetailRow(s)&&setTimeout((function(){n._sizeDetailRow(s,!0)}),1):e.Control.refreshAll(s.detail)}if(o.panel==l.rowHeaders&&0==o.col&&this._hasDetail(o.row)){a.style.cursor="";switch(this._mode){case d.ExpandMulti:case d.ExpandSingle:var c=this.isDetailVisible(o.row),u=c?"minus":"plus",f=FlexGridDetailProvider._WJC_DETAIL;a.innerHTML='<div class="wj-btn wj-btn-glyph '+f+'" role="button" tabindex="-1"><span class="wj-glyph-'+u+'"></span></div>';var h=a.children[0],g=e.culture.FlexGridDetailProvider.ariaLabels.toggleDetail;e.setAriaLabel(h,g);e.setAttribute(h,"aria-expanded",c)}}};FlexGridDetailProvider.prototype._resizedRow=function(i,r){var o=r.getRow();o instanceof t.DetailRow&&o.detail&&e.Control.refreshAll(o.detail)};FlexGridDetailProvider.prototype._hasDetail=function(t){var i=this._g.rows[t];return e.isFunction(this._rowHasDetailFn)?this._rowHasDetailFn(i):this._isRegularRow(i)};FlexGridDetailProvider.prototype._isRegularRow=function(i){return!(i instanceof e.grid._NewRowTemplate||i instanceof t.DetailRow||i instanceof e.grid.GroupRow&&!this._g.childItemsPath)};FlexGridDetailProvider.prototype._createDetailCell=function(e){return this.createDetailCell?this.createDetailCell(e):null};FlexGridDetailProvider._WJC_DETAIL="wj-elem-detail";return FlexGridDetailProvider}();t.FlexGridDetailProvider=o})((t=e.grid||(e.grid={})).detail||(t.detail={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.detail||(t.detail={}),e._registerModule("wijmo.grid.detail",e.grid.detail)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));