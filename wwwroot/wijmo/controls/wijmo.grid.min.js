/*!
    *
    * Wijmo Library 5.20232.939
    * https://developer.mescius.com/wijmo
    *
    * Copyright(c) MESCIUS inc. All rights reserved.
    *
    * Licensed under the End-User License Agreement For MESCIUS Wijmo Software.
    * us.sales@mescius.com
    * https://developer.mescius.com/wijmo/licensing
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){!function(t){"use strict";var i=null;t._getSafariVer=function _getSafariVer(){return i};if(e.isSafari()){var o=navigator.userAgent.match(/version\/([\d\.]+)/i);if(null!=o){var n=o[1],r=(o=n.match(/(\d+)/g)).map((function(e){return parseInt(e)}));i={full:n,major:r[0],minor:r[1]}}}}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";!function(e){e[e.AutoComplete=0]="AutoComplete";e[e.DropDownList=1]="DropDownList";e[e.RadioButtons=2]="RadioButtons"}(t.DataMapEditor||(t.DataMapEditor={}));var i=function(){function DataMap(t,i,o){this._keyPath="";this._displayPath="";this._sortByVal=!0;this._editable=!1;this._serK=!0;this.mapChanged=new e.Event;if(e.isArray(t)&&!i&&!o){t=t.map((function(e){return{value:e}}));i=o="value"}this._cv=e.asCollectionView(t);this._keyPath=e.asString(i,!1);this._displayPath=e.asString(o,!1);this._cv.collectionChanged.addHandler(this.onMapChanged,this)}Object.defineProperty(DataMap.prototype,"sortByDisplayValues",{get:function(){return this._sortByVal},set:function(t){this._sortByVal=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"serializeKeys",{get:function(){return this._serK},set:function(t){if((t=e.asBoolean(t))!==this._serK){var i=this._map,o=i&&i.size;this._map=null;this._serK=t;o&&this.onMapChanged(e.EventArgs.empty)}},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"selectedValuePath",{get:function(){return this._keyPath},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"displayMemberPath",{get:function(){return this._displayPath},enumerable:!0,configurable:!0});DataMap.prototype.getDataItem=function(t){var i=this;if(!this._map){var o=this._cv.sourceCollection,n=new e._Map(this.serializeKeys);e.isArray(o)&&this._keyPath&&o.forEach((function(e){var t=e[i._keyPath];n.has(t)||n.set(t,e)}));this._map=n}return this._map.get(t)};DataMap.prototype.getDisplayValue=function(e){var t=this._displayPath,i=this.getDataItem(e);return t&&i?i[t]:e};DataMap.prototype.getKeyValue=function(e,t){var i=this._displayPath,o=this._indexOf(e,i,t,!0);o<0&&(o=this._indexOf(e,i,t,!1));return o>-1?this._cv.sourceCollection[o][this._keyPath]:null};DataMap.prototype.getDisplayValues=function(e){var t=this;return this._cv&&this._displayPath?this._cv.items.map((function(e){return e[t._displayPath]})):[]};DataMap.prototype.getKeyValues=function(){var e=this;return this._cv&&this._keyPath?this._cv.items.map((function(t){return t[e._keyPath]})):[]};Object.defineProperty(DataMap.prototype,"isEditable",{get:function(){return this._editable},set:function(t){this._editable=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"search",{get:function(){return this._search},set:function(t){t&&(this._search=e.asFunction(t))},enumerable:!0,configurable:!0});DataMap.prototype.onMapChanged=function(e){this._map=null;this.mapChanged.raise(this,e)};DataMap.prototype._indexOf=function(t,i,o,n){var r=-1,l=-1;if(this._cv&&i){var s=null!=t?t.toString():"";s&&o&&(t=e.toPlainText(s));for(var a=n?s:s.toLowerCase(),c=this._cv.sourceCollection,u=0;u<c.length;u++){var d=c[u],h=d[i];null!=h&&null!=h||(h="");o&&e.isString(h)&&(h=e.toPlainText(h));h==t?r=u:n||h.length!=a.length||h.toLowerCase()!=a?null!=h&&h.toString()==s&&(r=u):r=u;if(r==u){if(!this._cv.filter||this._cv.filter(d))return r;l<0&&(l=r)}}}return l};return DataMap}();t.DataMap=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function CellRange(e,t,i,o){void 0===e&&(e=-1);void 0===t&&(t=-1);void 0===i&&(i=e);void 0===o&&(o=t);this.setRange(e,t,i,o)}CellRange.prototype.setRange=function(t,i,o,n){void 0===t&&(t=-1);void 0===i&&(i=-1);void 0===o&&(o=t);void 0===n&&(n=i);this._row=e.asInt(t);this._col=e.asInt(i);this._row2=e.asInt(o);this._col2=e.asInt(n)};Object.defineProperty(CellRange.prototype,"row",{get:function(){return this._row},set:function(t){this._row=e.asInt(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"col",{get:function(){return this._col},set:function(t){this._col=e.asInt(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"row2",{get:function(){return this._row2},set:function(t){this._row2=e.asInt(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"col2",{get:function(){return this._col2},set:function(t){this._col2=e.asInt(t)},enumerable:!0,configurable:!0});CellRange.prototype.clone=function(){return new CellRange(this._row,this._col,this._row2,this._col2)};CellRange.prototype.copy=function(e){this.setRange(e._row,e._col,e._row2,e._col2)};Object.defineProperty(CellRange.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"isSingleCell",{get:function(){return this._row==this._row2&&this._col==this._col2},enumerable:!0,configurable:!0});CellRange.prototype.contains=function(t,i){var o=e.tryCast(t,CellRange);if(o)return o.topRow>=this.topRow&&o.bottomRow<=this.bottomRow&&o.leftCol>=this.leftCol&&o.rightCol<=this.rightCol;if(e.isInt(t)&&e.isInt(i))return t>=this.topRow&&t<=this.bottomRow&&i>=this.leftCol&&i<=this.rightCol;throw"contains expects a CellRange or row/column indices."};CellRange.prototype.containsRow=function(t){return e.asInt(t)>=this.topRow&&t<=this.bottomRow};CellRange.prototype.containsColumn=function(t){return e.asInt(t)>=this.leftCol&&t<=this.rightCol};CellRange.prototype.intersects=function(e){return this.intersectsRow(e)&&this.intersectsColumn(e)};CellRange.prototype.intersectsRow=function(e){return e&&!(this.bottomRow<e.topRow||this.topRow>e.bottomRow)};CellRange.prototype.intersectsColumn=function(e){return e&&!(this.rightCol<e.leftCol||this.leftCol>e.rightCol)};CellRange.prototype.getRenderSize=function(t){var i=new e.Size(0,0);if(this.isValid){for(var o=this.topRow;o<=this.bottomRow;o++)t.rows[o]&&(i.height+=t.rows[o].renderSize);for(var n=this.leftCol;n<=this.rightCol;n++)t.columns[n]&&(i.width+=t.columns[n].renderSize)}return i};CellRange.prototype.equals=function(e){return e instanceof CellRange&&this._row==e._row&&this._col==e._col&&this._row2==e._row2&&this._col2==e._col2};CellRange.prototype.combine=function(e){return e?new CellRange(Math.min(this.topRow,e.topRow),Math.min(this.leftCol,e.leftCol),Math.max(this.bottomRow,e.bottomRow),Math.max(this.rightCol,e.rightCol)):this};CellRange.prototype.toString=function(){return e.format("({row}, {col})-({row2}, {col2})",this)};return CellRange}();t.CellRange=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None";e[e.Cell=1]="Cell";e[e.ColumnHeader=2]="ColumnHeader";e[e.RowHeader=3]="RowHeader";e[e.TopLeft=4]="TopLeft";e[e.ColumnFooter=5]="ColumnFooter";e[e.BottomLeft=6]="BottomLeft"}(i=t.CellType||(t.CellType={}));var o=function(){function GridPanel(i,o,n,r,l){this._offsetY=0;this._rng=new t.CellRange;this._g=e.asType(i,t.FlexGrid);this._ct=e.asInt(o);this._rows=e.asType(n,t.RowCollection);this._cols=e.asType(r,t.ColumnCollection);this._e=e.asType(l,HTMLElement);this._vrb=new t.CellRange;this._uid=e.uidGenerator()}Object.defineProperty(GridPanel.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"cellType",{get:function(){return this._ct},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"viewRange",{get:function(){return this._getViewRange()},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"width",{get:function(){return this._cols.getTotalSize()},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"height",{get:function(){return this._rows.getTotalSize()},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0});GridPanel.prototype.getCellData=function(o,n,r){var l,s=this._g,a=this._rows[e.asNumber(o,!1,!0)],c=null;if(!a)return null;n=this._toIndex(n);l=this._cols[e.asNumber(n,!1,!0)];var u=s?s._getBindingColumn(this,o,l):l,d=null;a instanceof t.GroupRow&&a.dataItem instanceof e.collections.CollectionViewGroup&&!s.childItemsPath&&(d=a.dataItem);u.binding&&a.dataItem&&!d?c=u._binding.getValue(a.dataItem):a._ubv&&(c=a._ubv[l._hash]);if(null==c){var h=i;switch(this._ct){case h.TopLeft:case h.ColumnHeader:o!=this._rows.length-1&&u==l||(c=u.header);break;case h.ColumnFooter:if(a instanceof t.GroupRow&&u.aggregate!=e.Aggregate.None){var f=this._g.collectionView;if(f){var p=e.tryCast(f,e.collections.CollectionView);c=p?p.getAggregate(u.aggregate,u.binding):e.getAggregate(u.aggregate,f.items,u.binding)}}break;case h.Cell:a instanceof t.GroupRow&&(n==this._cols.firstVisibleIndex?c=a.getGroupHeader():d&&u.aggregate!=e.Aggregate.None&&(c=d.getAggregate(u.aggregate,u.binding,this._g.collectionView,this._g)))}}if(r){var g=u.dataMap||a.dataMap;if(this.cellType==i.Cell&&u._edt&&u._edt._ctl instanceof e.input.MultiSelect&&c){var _=new e.Binding(u._edt._ctl.displayMemberPath),m=_&&e.isArray(c)?c.map((function(e){return _.getValue(e)})):c;if(e.isArray(m)&&m.length>0){var w=m.join(", ");c=e.format(w||e.culture.MultiSelect.itemsSelected,{count:m.length})}}else this.cellType==i.Cell&&g&&(c=g.getDisplayValue(c));c=null!=c?e.Globalize.format(c,u.format||a.format):""}return c};GridPanel.prototype.setCellData=function(t,o,n,r,l,s){void 0===r&&(r=!0);void 0===l&&(l=!0);void 0===s&&(s=!1);var a=this._g,c=this._rows[e.asNumber(t,!1,!0)],u=this._cols[e.asNumber(this._toIndex(o),!1,!0)],d=e.DataType;if(!c)return!1;var h=a?a._getBindingColumn(this,t,u):u,f=h.dataMap||c.dataMap;if(this._ct==i.Cell){var p=h.getIsRequired(c),g=h.isContentHtml||c.isContentHtml;if(!s&&f&&null!=n){var _=f.getKeyValue(n,g);if(null==_&&null==f.getDisplayValue(null)){if(f.getDisplayValue(n)!=n);else if(!f.isEditable||f.displayMemberPath!=f.selectedValuePath){if(""!=n||p||!a.commitEmptyEdits)return!1;n=null}}else n=_}var m=d.Object,w=h.dataType||c.dataType,C=this.getCellData(t,o,!1);m=w||e.getType(C);if(null==n||""===n&&r&&!f){if(p||!a.commitEmptyEdits&&(null==C||""===C))return!1;m!=d.String&&(n=null);r=!1}if("NaN"==n&&Number.isNaN(C)&&!a.commitEmptyEdits)return!1;if(r){var v=h.format||c.format;v||m!=d.Date||(v="d");h.mask&&e.isString(n)&&m!=d.String&&(n=n.replace(/_/g,""));n=e.changeType(n,m,v,C);if(m!=d.Object&&e.getType(n)!=m)return!1}}if(c.dataItem&&h.binding){var y=h._binding,b=c.dataItem,R=y.getValue(b);if(n!==R&&(f&&!f.serializeKeys||!e.DateTime.equals(n,R))){var E=a.collectionView,x=E instanceof e.collections.CollectionView&&b!=E.currentEditItem&&E.trackChanges,S=null;x&&(S=E._extend({},b));y.setValue(b,n);if(x){var H=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,b,E.items.indexOf(b));E.onCollectionChanged(H,S)}}}else{c._ubv||(c._ubv={});c._ubv[u._hash]=n}l&&a&&a.invalidate();return!0};GridPanel.prototype.getCellBoundingRect=function(t,i,o){var n=this._g,r=this.rows[t],l=this.columns[this._toIndex(i)],s=new e.Rect(l.pos,r.pos,l.renderSize,r.renderSize);if(n.rightToLeft){s.left=this.hostElement.clientWidth-s.right;e.isIE()||(s.left-=n._root.offsetWidth-n._root.clientWidth)}if(!o){var a=this.hostElement.getBoundingClientRect();s.left+=a.left;s.top+=a.top-this._offsetY}t<this.rows.frozen&&(s.top-=n.scrollPosition.y);Number(i)<Number(this.columns.frozen)&&(s.left-=n.scrollPosition.x*(n.rightToLeft?-1:1));return s};GridPanel.prototype.getCellElement=function(e,t){var i=this.hostElement.children,o=Math.min(e+2,i.length);t=this._toIndex(t);for(var n=0;n<o;n++)for(var r=i[n].children,l=Math.min(t+2,r.length),s=0;s<l;s++){var a=r[s],c=a[GridPanel._INDEX_KEY];if(c&&(c.row==e&&c.col==t||c.rng&&c.rng.contains(e,t)))return a}return null};GridPanel.prototype.getSelectedState=function(e,o,n){var r=this._g,l=r.selectionMode,s=r._selHdl.selection,a=t.SelectionMode,c=t.SelectedState;if(l==a.None)return c.None;o=this._toIndex(o);switch(this._ct){case i.Cell:n||(n=r.getMergedRange(this,e,o));var u=r._getAnchorCell();if(n){if(n.contains(s.row,s.col)){if(!r.anchorCursor||null==u)return r.showMarquee?c.Active:c.Cursor;if(e==u.y&&o==u.x||n.row==u.y&&n.col==u.x)return r.showMarquee?c.Active:c.Cursor}if(n.intersects(s)&&r.anchorCursor&&null!=u&&(e==u.y&&o==u.x||n.row==u.y&&n.col==u.x))return r.showMarquee?c.Active:c.Cursor;if(n.intersects(s)&&l!=a.ListBox)return c.Selected;for(var d=n.leftCol;d<=n.rightCol;d++)if(r.columns[d]&&r.columns[d].isSelected)return c.Selected;for(var h=n.topRow;h<=n.bottomRow;h++)if(r.rows[h].isSelected)return c.Selected}if(r.anchorCursor&&null!=u){if(e==u.y&&o==u.x)return r.showMarquee?c.Active:c.Cursor}else if(s.row==e&&s.col==o)return r.showMarquee?c.Active:c.Cursor;if(r.rows[e].isSelected||r.columns[o].isSelected)return c.Selected;if(l==a.MultiRange)for(var f=r._selHdl.extendedSelection,p=0;p<f.length;p++)if(f[p].contains(e,o)||n&&n.intersects(f[p]))return c.Selected;if(n)switch(l){case a.Row:case a.RowRange:if(n.containsRow(s.row))return c.Selected}return l==a.ListBox?c.None:(s=this._getAdjustedSelection(s)).containsRow(e)&&s.containsColumn(o)?c.Selected:c.None;case i.ColumnHeader:if(r.showSelectedHeaders&t.HeadersVisibility.Column&&(r.columns[o].isSelected||s.containsColumn(o)||s.intersectsColumn(n))){n&&(e=n.bottomRow);if(e==this.rows.length-1)return c.Selected}break;case i.RowHeader:if(r.showSelectedHeaders&t.HeadersVisibility.Row&&(r.rows[e].isSelected||s.containsRow(e)||s.intersectsRow(n))){n&&(o=n.rightCol);if(o==this.columns.length-1)return c.Selected}}return c.None};Object.defineProperty(GridPanel.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0});GridPanel.prototype._toIndex=function(t){if(e.isString(t)&&(t=this._cols.indexOf(t))<0)throw"Invalid column name or binding.";return t};GridPanel.prototype._getAdjustedSelection=function(e){var i=this._g,o=this._rng,n=t.SelectionMode;switch(i.selectionMode){case n.Cell:o.setRange(e.row,e.col,e.row,e.col);break;case n.Row:o.setRange(e.row,0,e.row,i.columns.length-1);break;case n.RowRange:case n.ListBox:o.setRange(e.row,0,e.row2,i.columns.length-1);break;default:o.copy(e)}return o};GridPanel.prototype._getOffsetY=function(){return this._offsetY};GridPanel.prototype._updateContent=function(e,o,n){var r=this._g,l=this._e,s=this._rows,a=this._cols,c=this._ct;if(c==i.ColumnHeader||c==i.ColumnFooter||c==i.RowHeader){var u=r._ptScrl,d=l.style;c==i.RowHeader?d.top=u.y+"px":r.rightToLeft?d.right=u.x+"px":d.left=u.x+"px"}if(this._offsetY!=n){e=!1;this._offsetY=n}var h=this._getViewRange(),f=h;if(f.isValid){var p=s.length<=r._vtRows?s.length:0,g=a.length<=r._vtCols?a.length:0;f=new t.CellRange(Math.max(h.row-p,s.frozen),Math.max(h.col-g,a.frozen),Math.min(h.row2+p,s.length-1),Math.min(h.col2+g,a.length-1))}if(e&&!o&&this._vrb.contains(h)&&!s.frozen&&!a.frozen)return this._activeCell;e&&f.equals(this._vrb)||(o=!1);e&&!o&&this._ct!=i.TopLeft&&this._reorderCells(f,this._vrb);this._activeCell=null;this._vru=h;this._vrb=f;this._recycle=e;var _=0;this._ct!=i.Cell||[t.HeadersFocusability.All,t.HeadersFocusability.Column].includes(this._g.headersFocusability)||(_=this._renderColHdrRow(f,o));this._updateCells(o,_);return this._activeCell};GridPanel.prototype._updateCells=function(e,t){this._e;for(var i=this._rows,o=0;o<i.frozen&&o<i.length;o++)t=this._renderRow(o,this._vrb,e,t);for(o=this._vrb.topRow;o<=this._vrb.bottomRow&&o>-1;o++)t=this._renderRow(o,this._vrb,e,t);this._scanAndRemoveExtraCells(t)};GridPanel.prototype._scanAndRemoveExtraCells=function(t){for(var i=this._e;i.childElementCount>t;){var o=i.lastElementChild;e.removeChild(o);this._removeExtraCells(o,0)}};GridPanel.prototype._clearCells=function(){for(var t=this.hostElement,i=this._g.cellFactory,o=t.childElementCount-1;o>=0;o--){var n=t.children[o];e.removeChild(n);for(var r=n.childElementCount-1;r>=0;r--)i.disposeCell(n.children[r])}};GridPanel.prototype._reorderCells=function(t,o){var n=this;if(this._g._reorderCells&&o.isValid&&t.isValid&&t.intersects(o)){var relocateForScrollToBeginning=function(t,i,o,r,l,s){e.assert(o<0,"Scroll delta must be a negative number");var a,c,u=-o,d=i+(r-l+1),h=t.childElementCount-d;if(h<u&&h>0){a=h;c=u-h}else{a=u;c=0}if(a>0){var f=n._createRange(t,d,d+a);f&&t.insertBefore(f.extractContents(),t.children[i])}if(c>0)for(var p=t.children[i],g=0;g<c;g++){var _=document.createElement("div");_.className=s;t.insertBefore(_,p)}};if(t.row!=o.row){var r=this._e;if(0!=(u=t.row-o.row)){var l=this._ct==i.Cell?1:0,s=r.childElementCount;l+=this.rows.frozen;if(u>0){var a=l,c=Math.min(l+u,s);(f=this._createRange(r,a,c))&&r.appendChild(f.extractContents())}else relocateForScrollToBeginning(r,l,u,t.row2,o.row,"wj-row")}}if(t.col!=o.col){var u;r=this._e;if(0!=(u=t.col-o.col)){l=this._ct==i.Cell&&this._g.rowHeaderPath?1:0;l+=this.columns.frozen;for(var d=0;d<r.children.length;d++){var h=r.children[d];s=h.children.length;if(e.hasClass(h,"wj-row"))if(u>0){var f;a=l,c=Math.min(l+u,s);(f=this._createRange(h,a,c))&&h.appendChild(f.extractContents())}else relocateForScrollToBeginning(h,l,u,t.col2,o.col,"wj-cell")}}}}};GridPanel.prototype._createRange=function(e,t,i){if(i>t&&i<=e.children.length&&t>-1){this._docRange||(this._docRange=document.createRange());var o=this._docRange;o.setStart(e,t);o.setEnd(e,i);return o}return null};GridPanel.prototype._renderColHdrRow=function(i,o){if(o)return 1;var n=this._e.children[0];n||(n=e.createElement('<div class="wj-row" role="row"></div>',this._e));var r=this._g,l=r?r.columnHeaders.rows.ariaLabel:null;e.setAttribute(n,"aria-label",l);e.setAttribute(n,"aria-selected",null);var s=0,a=this._g._getRowHeaderPath();a&&(s=this._renderRowHdrCell(n,-1,a.path));for(var c=0;c<this.columns.frozen&&c<this.columns.length;c++)s=this._renderColHdrCell(n,c,i,o,s);for(c=i.leftCol;c<=i.rightCol&&c>-1;c++)s=this._renderColHdrCell(n,c,i,o,s);[t.HeadersVisibility.None,t.HeadersVisibility.Row].includes(r.headersVisibility)&&e.setAttribute(n.closest(".wj-row"),"aria-hidden","true");this._removeExtraCells(n,s);return 1};GridPanel.prototype._renderColHdrCell=function(i,o,n,r,l){var s=this.grid,a=this.columns[o];if(a.renderSize<=0)return l;if(r)return l+1;var c=i.children[l];c||(c=e.createElement(GridPanel._HTML_CELL,i));if(c&&this._recycle&&s._lazyRender){var u=c[GridPanel._INDEX_KEY];if(u&&-1==u.row&&u.col==o&&o>=this.columns.frozen)return l+1}c.textContent=this.columns[o].header;e.setCss(c,{position:"fixed",left:a.pos,top:-32e3,width:a.renderSize,height:.1,overflow:"hidden",opacity:"0",pointerEvents:"none"});t.colHdrAriaAttributes(c,a,this,s);c[GridPanel._INDEX_KEY]={row:-1,col:o,panel:this};return l+1};GridPanel.prototype._renderRowHdrCell=function(t,i,o){var n=t.children[0];n||(n=e.createElement(GridPanel._HTML_CELL,t));n.setAttribute("role",i<0?"columnheader":"rowheader");n.textContent=o?o.toString():"";e.setCss(n,{position:"fixed",left:-32e3,top:-32e3,width:.1,height:.1,overflow:"hidden",opacity:"0"});n[GridPanel._INDEX_KEY]={row:i,col:-1,panel:this};return 1};GridPanel.prototype._renderRow=function(o,n,r,l){var s=this._g,a=this.rows[o];if(a.renderSize<=0)return l;var c=this._e.children[l];c||(c=e.createElement('<div class="wj-row"></div>',this._e));if(this._ct==i.Cell){c.setAttribute("role","row");var u=t.SelectionMode,d=a.isSelected;switch(s.selectionMode){case u.Row:case u.RowRange:d=d||this._g._selHdl.selection.containsRow(o)}e.setAttribute(c,"aria-selected",!!d||null);e.setAttribute(c,"aria-level",a instanceof t.GroupRow?a.level+1:null);e.setAttribute(c,"aria-expanded",a instanceof t.GroupRow?!a.isCollapsed:null);this.rows.ariaLabel&&e.setAttribute(c,"aria-label",this.rows.ariaLabel)}var h=0;if(this._ct==i.Cell){var f=this._g._getRowHeaderPath();f&&(h=this._renderRowHdrCell(c,o,f.getValue(a.dataItem)))}for(var p=0;p<this.columns.frozen&&p<this.columns.length;p++)h=this._renderCell(c,o,p,n,r,h);for(p=n.leftCol;p<=n.rightCol&&p>-1;p++)h=this._renderCell(c,o,p,n,r,h);this._removeExtraCells(c,h);return l+1};GridPanel.prototype._renderCell=function(o,n,r,l,s,a){var c=this._g,u=this._ct==i.Cell?c.getMergedRange(this,n,r,!1):c.getMergedRange(this,n,r);if(u){for(var d=Math.max(l.row,u.row);d<n;d++)if(this.rows[d].renderSize)return a;for(d=Math.max(l.col,u.col);d<r;d++)if(this.columns[d].renderSize)return a;if(n>=u.row&&n<=u.row2&&r>u.col&&r<=u.col2&&this._ct===i.Cell&&u.isSingleCell)return a;var h=this.columns.frozen;if(h&&u.col<h&&u.col2>=h&&r>u.col)return a}var f=this.columns[r];if((!f||f.renderSize<=0)&&(!u||u.getRenderSize(this).width<=0))return a;var p=o.children[a];if(p&&!s&&this._recycle&&c._lazyRender&&!c.activeEditor){var g=p[GridPanel._INDEX_KEY];g&&g.row==n&&g.col==r&&g.rng==u&&n>=this.rows.frozen&&r>=this.columns.frozen&&(s=!0)}var _=t.SelectedState,m=this.getSelectedState(n,r,u),w=m==_.Cursor||m==_.Active;if(p&&s){e.toggleClass(p,"wj-state-active",w);e.toggleClass(p,"wj-state-selected",m==_.Cursor);e.toggleClass(p,"wj-state-multi-selected",m==_.Selected);var C=p.querySelector(".wj-column-selector");C?w||m!=_.None?e.setAttribute(p,"aria-selected",!!C.checked):e.setAttribute(p,"aria-selected",null):e.setAttribute(p,"aria-selected",!(!w&&m==_.None)||null);w&&(this._activeCell=p);return a+1}p||(p=e.createElement(GridPanel._HTML_CELL,o));w&&(this._activeCell=p);if(this._ct==i.Cell){e.setAttribute(p,"role","gridcell");e.setAttribute(p,"aria-selected",!(m==_.None&&!w)||null);var v=!c.canEditCell(n,r)||null;e.setAttribute(p,"aria-readonly",v);e.setAttribute(p,"aria-required",v?null:f.getIsRequired())}c.cellFactory.updateCell(this,n,r,p,u);p[GridPanel._INDEX_KEY]={row:n,col:r,rng:u,panel:this};return a+1};GridPanel.prototype._removeExtraCells=function(t,i){for(var o=this._g.cellFactory;t.childElementCount>i;){var n=t.lastElementChild;e.removeChild(n);o.disposeCell(n)}for(var r=t.childElementCount-1;r>-1;--r){var l=[t.children[r],t.children[r-1]],s=l[1];if((n=l[0])&&s){var a=n.getAttribute("style")===s.getAttribute("style"),c=n.innerHTML===s.innerHTML;if(!a||!c)break;e.removeChild(n);o.disposeCell(n)}}};GridPanel.prototype._getViewRange=function(){var e=this._g,o=e._ptScrl,n=e._szClientSB,r=this._rows,l=this._cols,s=new t.CellRange(0,0,r.length-1,l.length-1);if(this._ct==i.Cell||this._ct==i.RowHeader){var a=-o.y+this._offsetY,c=n.height;if((f=Math.min(r.frozen,r.length-1))>0){a+=_=r[f-1].pos;c-=_}if(f>0&&r[f].pos>n.height)s.row=s.row2=-1;else{s.row=Math.min(r.length-1,Math.max(f,r.getItemAt(a)));s.row2=Math.max(s.row,r.getItemAt(a+c))}var u=e.hostElement;if(e._clipToScreen&&u){var d=u.getBoundingClientRect(),h=-d.top-e.cells._e.offsetTop;d.top<0&&(s.row=Math.max(s.row,r.getItemAt(h)-1));d.bottom>innerHeight&&(s.row2=Math.min(s.row2,r.getItemAt(h+innerHeight)+1))}}if(this._ct==i.Cell||this._ct==i.ColumnHeader){var f,p=-o.x,g=n.width;if((f=Math.min(l.frozen,l.length-1))>0){var _;p+=_=l[f-1].pos;g-=_}if(f>0&&l[f].pos>n.width)s.col=s.col2=-1;else{s.col=Math.min(l.length-1,Math.max(f,l.getItemAt(p)));s.col2=Math.max(s.col,l.getItemAt(p+g))}}r.length<=r.frozen&&(s.row=s.row2=-1);l.length<=l.frozen&&(s.col=s.col2=-1);return s};GridPanel.prototype._getFrozenPos=function(){var t=this._rows.frozen,i=this._cols.frozen,o=t>0?this._rows[t-1]:null,n=i>0?this._cols[i-1]:null,r=o?o.pos+o.renderSize:0,l=n?n.pos+n.renderSize:0;return new e.Point(l,r)};GridPanel._INDEX_KEY="wj-cell-index";GridPanel._HTML_CELL='<div class="wj-cell" tabindex="-1"></div>';return GridPanel}();t.GridPanel=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(i){__extends(CellRangeEventArgs,i);function CellRangeEventArgs(o,n,r){var l=i.call(this)||this;l._p=e.asType(o,t.GridPanel,!0);l._rng=e.asType(n,t.CellRange,!0);l._data=r;return l}Object.defineProperty(CellRangeEventArgs.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"range",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0});CellRangeEventArgs.prototype.getRow=function(){return this._p&&this.row>-1?this._p.rows[this.row]:null};CellRangeEventArgs.prototype.getColumn=function(e){var i=this._p,o=i&&this.col>-1?i.columns[this.col]:null;if(o&&e){var n=i.grid;o=i.cellType===t.CellType.ColumnHeader&&n._hasColumnGroups()?n._getColumnGroup(this.row,this.col):i.grid._getBindingColumn(i,this.row,o)}return o};return CellRangeEventArgs}(e.CancelEventArgs);t.CellRangeEventArgs=i;var o=function(t){__extends(FormatItemEventArgs,t);function FormatItemEventArgs(i,o,n,r){void 0===r&&(r=!0);var l=t.call(this,i,o)||this;l._updateContent=!0;l._cell=e.asType(n,HTMLElement);return l}Object.defineProperty(FormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(FormatItemEventArgs.prototype,"updateContent",{get:function(){return this._updateContent},enumerable:!0,configurable:!0});return FormatItemEventArgs}(i);t.FormatItemEventArgs=o;var n=function(t){__extends(CellEditEndingEventArgs,t);function CellEditEndingEventArgs(){var e=null!==t&&t.apply(this,arguments)||this;e._stayInEditMode=!1;e._refresh=!0;return e}Object.defineProperty(CellEditEndingEventArgs.prototype,"stayInEditMode",{get:function(){return this._stayInEditMode},set:function(t){this._stayInEditMode=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellEditEndingEventArgs.prototype,"refresh",{get:function(){return this._refresh},set:function(t){this._refresh=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellEditEndingEventArgs.prototype,"previousData",{get:function(){return null!=this._previousData?this._previousData:this._data},set:function(e){this._previousData=e},enumerable:!0,configurable:!0});return CellEditEndingEventArgs}(i);t.CellEditEndingEventArgs=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i,o;!function(e){e[e.None=0]="None";e[e.Cell=1]="Cell";e[e.CellRange=2]="CellRange";e[e.Row=3]="Row";e[e.RowRange=4]="RowRange";e[e.ListBox=5]="ListBox";e[e.MultiRange=6]="MultiRange"}(i=t.SelectionMode||(t.SelectionMode={}));!function(e){e[e.None=0]="None";e[e.Selected=1]="Selected";e[e.Cursor=2]="Cursor";e[e.Active=3]="Active"}(t.SelectedState||(t.SelectedState={}));!function(e){e[e.None=0]="None";e[e.Next=1]="Next";e[e.Prev=2]="Prev";e[e.NextPage=3]="NextPage";e[e.PrevPage=4]="PrevPage";e[e.Home=5]="Home";e[e.End=6]="End";e[e.NextCell=7]="NextCell";e[e.PrevCell=8]="PrevCell";e[e.NextEditableCell=9]="NextEditableCell";e[e.PrevEditableCell=10]="PrevEditableCell"}(o=t.SelMove||(t.SelMove={}));var n=function(){function _SelectionHandler(o){this._sel=new t.CellRange(0,0);this._xSel=new e.collections.ObservableArray;this._mode=i.CellRange;this._g=o;this._e=new t.CellRangeEventArgs(o.cells,new t.CellRange(0,0));this._xSel.collectionChanged.addHandler((function(){o.invalidate()}))}Object.defineProperty(_SelectionHandler.prototype,"selectionMode",{get:function(){return this._mode},set:function(e){e!=this._mode&&this._setSelectionMode(e)},enumerable:!0,configurable:!0});Object.defineProperty(_SelectionHandler.prototype,"selection",{get:function(){return this._sel},set:function(e){this.select(e)},enumerable:!0,configurable:!0});Object.defineProperty(_SelectionHandler.prototype,"extendedSelection",{get:function(){return this._xSel},enumerable:!0,configurable:!0});_SelectionHandler.prototype.select=function(o,n,r){void 0===n&&(n=!0);void 0===r&&(r=!1);var l=this._g,s=this._e.range,a=this._sel,c=s,u=!1,d=i;if(e.isNumber(o)&&e.isString(n)){var h=l.columns.indexOf(n);if(h<0)throw"Invalid column name or binding.";s.setRange(o,h);n=!0}else if(e.isNumber(o)&&e.isNumber(n)){s.setRange(o,n);n=!0}else o instanceof t.CellRange?s.copy(o):e.assert(!1,"CellRange expected");switch(l.selectionMode){case d.Cell:c.row2=c.row;c.col2=c.col;break;case d.Row:c.row2=c.row;break;case d.ListBox:u=!0}var f=c.equals(a);if(f&&u)for(var p=0;p<l.rows.length;p++)if(l.rows[p].isSelected!==c.containsRow(p)){f=!1;break}if(f){n&&l.isRangeValid(c)&&this._showSelection();return!0}var g=e.Control.getControl(e.closest(e.getActiveElement(),".wj-flexgrid"));if(g&&g.activeEditor&&!g.finishEditing())return!1;var _=this._e;_._rng=c;_.cancel=!1;if(!l.onSelectionChanging(_)&&!r)return!1;u&&l.rows.forEach((function(e,i){e._setFlag(t.RowColFlags.Selected,c.containsRow(i),!0)}));c.row=Math.min(c.row,l.rows.length-1);c.row2=Math.min(c.row2,l.rows.length-1);this._sel.copy(c);l.refreshCells(!1,!0,!0);n&&this._showSelection();var m=l.collectionView;if(m){var w=l._getCvIndex(c.row);m.moveCurrentToPosition(w)}this._g.errorTip.hide();var C=e.getActiveElement();C.classList.contains("wj-state-invalid")&&this._g.errorTip._showAutoTip(void 0,C);l.onSelectionChanged(_);return!0};_SelectionHandler.prototype.moveSelection=function(e,i,n){var r=this._g,l=this._sel,s=n&&r.anchorCursor?new t.CellRange(l.row2,l.col2):new t.CellRange(l.row,l.col),a=s.row,c=s.col,u=r.columns,d=Math.max(0,r._szClient.height-r.columnHeaders.height),h=o,f=-1,p=r.getMergedRange(r.cells,a,c);p&&(i==h.NextCell||i==h.NextEditableCell?c=p.rightCol:i!=h.PrevCell&&i!=h.PrevEditableCell||(c=p.leftCol));switch(i){case h.NextCell:case h.NextEditableCell:f=c;(c=this._getNextColumnCell(a,f,i))!=f&&(p=r.getMergedRange(r.cells,a,c))&&c<p.col2&&(c=p.col2);if(c==f)for(;;){if(a==r.rows.length-1){c=s.col;a=s.row;break}var g=!1;if((a=this._getNextRowCell(a,c,i))>s.row){f=-1;for(;f<u.length;){if((c=this._getNextColumnCell(a,f,i))==f){g=!0;break}(p=r.getMergedRange(r.cells,a,c))&&c<p.col2&&(c=p.col2);break}if(g)continue}break}r.select(a,c);break;case h.PrevCell:case h.PrevEditableCell:f=c;(c=this._getNextColumnCell(a,f,i))!=f&&(p=r.getMergedRange(r.cells,a,c))&&c>p.col&&(c=p.col);if(c==f)for(;;){if(0==a){c=s.col;a=s.row;break}g=!1;if((a=this._getNextRowCell(a,c,i))<s.row){f=u.length;for(;f>-1;){(c=this._getNextColumnCell(a,f,i))!=f?(p=r.getMergedRange(r.cells,a,c))&&c>p.col&&(c=p.col):g=!0;break}if(g)continue}break}r.select(a,c);break;default:if(!this.moveHeaderCells(e,i,a,c)){a=this._getNextRowCell(a,c,e,d);c=this._getNextColumnCell(a,c,i,d);n?r.selection=r.anchorCursor?new t.CellRange(l.row,l.col,a,c):new t.CellRange(a,c,l.row2,l.col2):r.select(a,c);break}}};_SelectionHandler.prototype.moveHeaderCells=function(e,i,o,n){var r=this._g,l=[t.HeadersFocusability.Column,t.HeadersFocusability.All].includes(r.headersFocusability),s=[t.HeadersFocusability.Row,t.HeadersFocusability.All].includes(r.headersFocusability),a=r.activePanelType===t.CellType.ColumnHeader,c=r.activePanelType===t.CellType.RowHeader,u=r.activePanelType===t.CellType.TopLeft,d=r.activePanelType===t.CellType.Cell,h=2===e?"up":1===e?"down":2===i?"left":1===i?"right":void 0,f=Array.from(r.activePanel.hostElement.getElementsByClassName("wj-focus-header-cell"))[0];if(d&&l&&0===o&&"up"===h){r.activePanelType=t.CellType.ColumnHeader;var p=Array.from(r.activePanel.hostElement.getElementsByClassName("wj-row")),g=Array.from(r._gpCells.hostElement.getElementsByClassName("wj-row"))[0],_=p[p.length-1];(Array.from(g.getElementsByClassName("wj-cell")).find((function(e){return e["wj-cell-index"].col===n}))||Array.from(g.getElementsByClassName("wj-cell"))[0]).setAttribute("tabindex","-1");(w=Array.from(_.getElementsByClassName("wj-cell")).find((function(e){return e["wj-cell-index"].col===n}))).classList.add("wj-focus-header-cell");w.setAttribute("tabindex","0");r._hideMarquee();w.focus();return!0}if(d&&s&&0===n&&"left"===h){r.activePanelType=t.CellType.RowHeader;var m=(p=Array.from(r.activePanel.hostElement.getElementsByClassName("wj-row"))).find((function(e){return Array.from(e.getElementsByClassName("wj-cell")).some((function(e){return e["wj-cell-index"].row===o}))}));if(!m)return!0;var w,C=Array.from(m.getElementsByClassName("wj-cell"));(w=C[C.length-1]).classList.add("wj-focus-header-cell");w.setAttribute("tabindex","0");r._hideMarquee();w.focus();return!0}if(a&&f){var v=f.nextElementSibling,y=f.previousElementSibling;if(f&&"right"===h&&v){f.classList.remove("wj-focus-header-cell");f.setAttribute("tabindex","-1");r.scrollIntoView(0,f["wj-cell-index"].col+1);setTimeout((function(){v.classList.add("wj-focus-header-cell");v.setAttribute("tabindex","0");r._hideMarquee();v.focus()}),10)}else if(f&&"left"===h){f.classList.remove("wj-focus-header-cell");f.setAttribute("tabindex","-1");if(y){r.scrollIntoView(0,f["wj-cell-index"].col-1);setTimeout((function(){y.classList.add("wj-focus-header-cell");y.setAttribute("tabindex","0");r._hideMarquee();y.focus()}),10)}else{r.activePanelType=t.CellType.TopLeft;var b=Array.from(r.activePanel.hostElement.getElementsByClassName("wj-cell"))[0];b&&setTimeout((function(){b.classList.add("wj-focus-header-cell");b.setAttribute("tabindex","0");r._hideMarquee();b.focus()}),10)}}else if(f&&"down"===h){var R=Array.from(f.parentElement.children).indexOf(f);r.activePanelType=t.CellType.Cell;r.focus();r.select(0,R);r._updateMarquee()}return!0}if(c&&f){R=Array.from(f.parentElement.children).indexOf(f);var E=f["wj-cell-index"].row,x=f.parentElement.nextElementSibling&&Array.from(f.parentElement.nextElementSibling.children)[R],S=f.parentElement.previousElementSibling&&Array.from(f.parentElement.previousElementSibling.children)[R];if("up"===h){f.classList.remove("wj-focus-header-cell");f.setAttribute("tabindex","-1");if(S){r.scrollIntoView(E-1,0);setTimeout((function(){S.classList.add("wj-focus-header-cell");S.setAttribute("tabindex","0");S.focus()}),10)}else{r.activePanelType=t.CellType.TopLeft;var H=Array.from(r.activePanel.hostElement.getElementsByClassName("wj-cell"))[0];H&&setTimeout((function(){H.classList.add("wj-focus-header-cell");H.setAttribute("tabindex","0");r._hideMarquee();H.focus()}),10)}}else if("down"===h&&x){f.classList.remove("wj-focus-header-cell");f.setAttribute("tabindex","-1");r.scrollIntoView(E+1,0);setTimeout((function(){x.classList.add("wj-focus-header-cell");x.setAttribute("tabindex","0");x.focus()}),10)}else if(f&&"right"===h){r.activePanelType=t.CellType.Cell;f.classList.remove("wj-focus-header-cell");f.setAttribute("tabindex","-1");r.focus();r.select(E,0)}return!0}if(u&&f){if("down"===h&&s){r.activePanelType=t.CellType.RowHeader;f.classList.remove("wj-focus-header-cell");f.setAttribute("tabindex","-1");var M=Array.from(r.activePanel.hostElement.getElementsByClassName("wj-cell"))[0];M&&setTimeout((function(){M.classList.add("wj-focus-header-cell");M.setAttribute("tabindex","0");M.focus()}),10)}if("right"===h&&l){r.activePanelType=t.CellType.ColumnHeader;f.classList.remove("wj-focus-header-cell");f.setAttribute("tabindex","-1");var G=Array.from(r.activePanel.hostElement.getElementsByClassName("wj-cell"))[0];G&&setTimeout((function(){G.classList.add("wj-focus-header-cell");G.setAttribute("tabindex","0");G.focus()}),10)}return!0}return!1};_SelectionHandler.prototype._getNextColumnCell=function(e,t,i,o){void 0===o&&(o=0);return this._g.columns.getNextCell(t,i,o)};_SelectionHandler.prototype._getNextRowCell=function(e,t,i,o){void 0===o&&(o=0);return this._g.rows.getNextCell(e,i,o)};_SelectionHandler.prototype._setSelectionMode=function(e){var t=this._g,i=t.rows;this._mode=e;this._xSel.clear();if(i.length){this._adjustSelection(this._sel,e,!0);t.invalidate()}};_SelectionHandler.prototype._adjustSelection=function(e,o,n){void 0===n&&(n=!1);var r=this._g.rows,l=i,s=this._g.hostElement.querySelector("input.wj-column-selector")instanceof HTMLInputElement;if(!s)for(var a=0;a<r.length;a++)r[a]._setFlag(t.RowColFlags.Selected,!1,!0);var c=e.clone();switch(o){case l.None:c=new t.CellRange;break;case l.Cell:c=new t.CellRange(e.row,e.col);break;case l.ListBox:if(s)return;for(a=0;a<r.length;a++)r[a]._setFlag(t.RowColFlags.Selected,c.containsRow(a),!0)}this.select(c,!1,n)};_SelectionHandler.prototype._expandSelection=function(){var e=this._g,o=e.selectionMode;if(e.expandSelectionOnCopyPaste&&o){var n=this.selection,r=i;switch(o){case r.Cell:case r.Row:break;case r.ListBox:this._expandSelectedRows();break;case r.RowRange:n=new t.CellRange(n.topRow,0,n.bottomRow,e.columns.length-1);default:var l=this._expandSelectionRange(n);l&&this.select(l,!1)}}};_SelectionHandler.prototype._deselectRange=function(e){var i=this.selection,o=this.extendedSelection;if(i.contains(e)){var n=o.length;this._sel=n?o[n-1]:new t.CellRange;n&&o.removeAt(n-1);return!0}for(var r=0;r<o.length;r++)if(o[r].contains(e)){o.removeAt(r);return!0}return!1};_SelectionHandler.prototype._expandSelectedRows=function(){e.assert(this.selectionMode==i.ListBox,"ListBox mode expected");for(var o=this._g,n=o.selectedRows.map((function(e){return e.index})),r=[],l=0;l<n.length;l++)for(var s=new t.CellRange(n[l],0,n[l],o.columns.length-1),a=this._expandSelectionRange(s)||s,c=a.topRow;c<=a.bottomRow;c++)-1===r.indexOf(c)&&r.push(c);r.sort();this._selectRows(r)};_SelectionHandler.prototype._expandSelectionRange=function(e){var i=this._g,o=i.cells,n=i.getMergedRange(o,e.topRow,e.leftCol,!1),r=i.getMergedRange(o,e.bottomRow,e.leftCol,!1),l=i.getMergedRange(o,e.topRow,e.rightCol,!1),s=i.getMergedRange(o,e.bottomRow,e.rightCol,!1);if(n||r||l||s){n=n||new t.CellRange(e.topRow,e.leftCol);r=r||new t.CellRange(e.bottomRow,e.leftCol);l=l||new t.CellRange(e.topRow,e.rightCol);s=s||new t.CellRange(e.bottomRow,e.rightCol);return new t.CellRange(Math.min(n.topRow,r.topRow,l.topRow,s.topRow),Math.min(n.leftCol,r.leftCol,l.leftCol,s.leftCol),Math.max(n.bottomRow,r.bottomRow,l.bottomRow,s.bottomRow),Math.max(n.rightCol,r.rightCol,l.rightCol,s.rightCol))}return null};_SelectionHandler.prototype._selectRows=function(t){e.assert(this.selectionMode==i.ListBox,"ListBox mode expected");for(var o=this._g,n=0,r=!0;n<o.rows.length;n++){var l=o.rows[n],s=t&&t.indexOf(l.index)>-1;if(s&&r){r=!1;this.select(n,this.selection.col)}l.isSelected=s}};_SelectionHandler.prototype._showSelection=function(){var e=this._g,t=this._sel;e.anchorCursor?e.scrollIntoView(t.row2,t.col2):e.scrollIntoView(t.row,t.col)};_SelectionHandler.prototype._adjustReferenceCell=function(e,t,i){var n=this._g,r=n.getMergedRange(n.cells,e.row,e.col);if(r&&!r.isSingleCell){var l=o;switch(t){case l.Next:case l.NextCell:case l.NextEditableCell:e.row=r.bottomRow;break;case l.Prev:case l.PrevCell:case l.PrevEditableCell:e.row=r.topRow}switch(i){case l.Next:case l.NextCell:case l.NextEditableCell:e.col=r.rightCol;break;case l.Prev:case l.PrevCell:case l.PrevEditableCell:e.col=r.leftCol}}};return _SelectionHandler}();t._SelectionHandler=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.Visible=1]="Visible";e[e.AllowResizing=2]="AllowResizing";e[e.AllowDragging=4]="AllowDragging";e[e.AllowMerging=8]="AllowMerging";e[e.AllowSorting=16]="AllowSorting";e[e.AutoGenerated=32]="AutoGenerated";e[e.Collapsed=64]="Collapsed";e[e.ParentCollapsed=128]="ParentCollapsed";e[e.Selected=256]="Selected";e[e.ReadOnly=512]="ReadOnly";e[e.HtmlContent=1024]="HtmlContent";e[e.WordWrap=2048]="WordWrap";e[e.MultiLine=4096]="MultiLine";e[e.HasTemplate=8192]="HasTemplate";e[e.RowDefault=3]="RowDefault";e[e.ColumnDefault=23]="ColumnDefault"}(i=t.RowColFlags||(t.RowColFlags={}));var o=function(){function RowCol(){this._type=null;this._align=null;this._inpType=null;this._mask=null;this._maxLen=null;this._required=null;this._fmt=null;this._map=null;this._ddCssClass=null;this._cssClass=null;this._cssClassAll=null;this._szMin=null;this._szMax=null;this._sz=null;this._pos=0;this._idx=-1;this._idxVis=-1;this._idxData=-1;this.gridChanged=new e.Event}Object.defineProperty(RowCol.prototype,"binding",{get:function(){return this._binding?this._binding.path:null},set:function(t){if(t!=this.binding){var i=e.asString(t);this._binding=i?new e.Binding(i):null;if(!this._type&&this.grid&&this._binding){var o=this.grid.collectionView;if(o&&o.sourceCollection&&o.sourceCollection.length){var n=o.sourceCollection[0];this._type=e.getType(this._binding.getValue(n))}}this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"sortMemberPath",{get:function(){return this._bindingSort?this._bindingSort.path:null},set:function(t){if(t!=this.sortMemberPath){var i=e.asString(t);this._bindingSort=i?new e.Binding(i):null;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"dataType",{get:function(){return this._type},set:function(t){t=e.asEnum(t,e.DataType,!0);if(this._type!=t){this._type=t;this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"inputType",{get:function(){return this._inpType},set:function(t){this._inpType=e.asString(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask=e.asString(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"maxLength",{get:function(){return this._maxLen},set:function(t){this._maxLen=e.asNumber(t,!0,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"align",{get:function(){return this._align},set:function(e){if(this._align!=e){this._align=e;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"format",{get:function(){return this._fmt},set:function(e){if(this._fmt!=e){this._fmt=e;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"dataMap",{get:function(){return this._map},set:function(i){if(this._map!=i){this._map&&this._map.mapChanged.removeHandler(this.onPropertyChanged,this);e.isArray(i)&&(i=new t.DataMap(i,null,null));this._map=e.asType(i,t.DataMap,!0);this._map&&this._map.mapChanged.addHandler(this.onPropertyChanged,this);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"dataMapEditor",{get:function(){return null!=this._mapEditor?this._mapEditor:t.DataMapEditor.DropDownList},set:function(i){if(i!=this._mapEditor){this._mapEditor=e.asEnum(i,t.DataMapEditor);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"showDropDown",{get:function(){return this.dataMapEditor==t.DataMapEditor.DropDownList},set:function(i){e._deprecated("showDropDown","dataMapEditor");this.dataMapEditor=i?t.DataMapEditor.DropDownList:t.DataMapEditor.AutoComplete},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"dropDownCssClass",{get:function(){return this._ddCssClass},set:function(t){this._ddCssClass=e.asString(t)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"visible",{get:function(){return this._getFlag(i.Visible)},set:function(e){this._setFlag(i.Visible,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isVisible",{get:function(){return!!this._getFlag(i.Visible)&&(!this._getFlag(i.ParentCollapsed)||this instanceof t._NewRowTemplate)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"pos",{get:function(){this._list&&this._list._dirty&&this._list._update();return this._pos},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"index",{get:function(){this._list&&this._list._dirty&&this._list._update();return this._idx},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"visibleIndex",{get:function(){this._list&&this._list._dirty&&this._list._update();return this.isVisible?this._idxVis:-1},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"size",{get:function(){return this._sz},set:function(t){if(t!=this._sz){this._sz=e.asNumber(t,!0);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"renderSize",{get:function(){var e=0,t=this._list;if(this.isVisible){(null==(e=this._sz)||e<0)&&(e=t?t.defaultSize:0);t&&null!=t.minSize&&e<t.minSize&&(e=t.minSize);t&&null!=t.maxSize&&e>t.maxSize&&(e=t.maxSize);null!=this._szMin&&e<this._szMin&&(e=this._szMin);null!=this._szMax&&e>this._szMax&&(e=this._szMax)}return e},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"allowResizing",{get:function(){return this._getFlag(i.AllowResizing)},set:function(e){this._setFlag(i.AllowResizing,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"allowDragging",{get:function(){return this._getFlag(i.AllowDragging)},set:function(e){this._setFlag(i.AllowDragging,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"allowMerging",{get:function(){return this._getFlag(i.AllowMerging)},set:function(e){this._setFlag(i.AllowMerging,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isSelected",{get:function(){return this._getFlag(i.Selected)},set:function(e){if(!!e!=this.isSelected){var o=this.grid;if(o){var n=new t.CellRangeEventArgs(o?o.cells:null,o.selection);if(o.onSelectionChanging(n)&&this._setFlag(i.Selected,e,!0)){o.refreshCells(!1,!0,!0);o.onSelectionChanged(n)}}else this._setFlag(i.Selected,e)}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isReadOnly",{get:function(){return this._getFlag(i.ReadOnly)},set:function(e){this._setFlag(i.ReadOnly,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isRequired",{get:function(){return this._required},set:function(t){this._required=e.asBoolean(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isContentHtml",{get:function(){return this._getFlag(i.HtmlContent)},set:function(e){if(this.isContentHtml!=e){this._setFlag(i.HtmlContent,e);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"wordWrap",{get:function(){return this._getFlag(i.WordWrap)},set:function(e){this._setFlag(i.WordWrap,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"multiLine",{get:function(){return this._getFlag(i.MultiLine)},set:function(e){this._setFlag(i.MultiLine,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){if(t!=this._cssClass){this._cssClass=e.asString(t);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"cssClassAll",{get:function(){return this._cssClassAll},set:function(t){if(t!=this._cssClassAll){this._cssClassAll=e.asString(t);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"grid",{get:function(){return this._list?this._list._g:null},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"collectionView",{get:function(){return this.grid?this.grid.collectionView:null},enumerable:!0,configurable:!0});RowCol.prototype.onPropertyChanged=function(){if(this._list){this._list._dirty=!0;this.grid.invalidate()}};RowCol.prototype.onGridChanged=function(e){this.gridChanged.raise(this,e)};RowCol.prototype._setList=function(e){if(e!=this._list){this._list=e;this.onGridChanged()}};RowCol.prototype._getFlag=function(e){return 0!=(this._f&e)};RowCol.prototype._setFlag=function(e,t,i){if(!!t!=this._getFlag(e)){this._f=t?this._f|e:this._f&~e;i||this.onPropertyChanged();return!0}return!1};return RowCol}();t.RowCol=o;var n=function(o){__extends(Column,o);function Column(t){var n=o.call(this)||this;n._hdr=null;n._name=null;n._agg=null;n._quickSize=null;n._descById=null;n._tpl=null;n._f=i.ColumnDefault;n._hash=Column._ctr.toString(36);Column._ctr++;e.copy(n,t);n._uid=e.uidGenerator();return n}Object.defineProperty(Column.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"width",{get:function(){return null!=this._szStar?this._szStar:this.size},set:function(t){if(null!=Column._parseStarSize(t)){this._szStar=t;this.onPropertyChanged()}else{this._szStar=null;this.size=e.asNumber(t,!0)}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"minWidth",{get:function(){return this._szMin},set:function(t){if(t!=this._szMin){this._szMin=e.asNumber(t,!0,!0);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"maxWidth",{get:function(){return this._szMax},set:function(t){if(t!=this._szMax){this._szMax=e.asNumber(t,!0,!0);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(t){this._quickSize=e.asBoolean(t,!0)},enumerable:!0,configurable:!0});Column.prototype._getQuickAutoSize=function(){return!!this.grid._getQuickAutoSize()&&(e.isBoolean(this._quickSize)?this._quickSize:!(this.isContentHtml||this.wordWrap||this.multiLine||this._getFlag(i.HasTemplate)))};Object.defineProperty(Column.prototype,"renderWidth",{get:function(){return this.renderSize},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"header",{get:function(){return this._hdr?this._hdr:this.binding},set:function(e){if(this._hdr!=e){this._hdr=e;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"cellTemplate",{get:function(){return this._tpl},set:function(t){if(t!=this._tpl){e.assert(null==t||e.isString(t)||e.isFunction(t),"cellTemplate should be a string or an ICellTemplateFunction.");this._tpl=t;this._setFlag(i.HasTemplate,null!=t&&""!=t);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"editor",{get:function(){var e=this._edt;return e?e.control:null},set:function(i){if(i!=this.editor){if(this._edt){this._edt.dispose();this._edt=null}if(null!=i){i=e.asType(i,e.Control);this._edt=new t._CustomEditor(this,i)}}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"allowSorting",{get:function(){return this._getFlag(i.AllowSorting)},set:function(e){this._setFlag(i.AllowSorting,e)},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"currentSort",{get:function(){var e=this.currentSortIndex;if(e>-1){return this.grid.collectionView.sortDescriptions[e].ascending?"+":"-"}return null},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"currentSortIndex",{get:function(){var e=this.grid?this.grid.collectionView:null,t=e?e.sortDescriptions:null,i=t&&t.length?this._getBindingSort():null;if(i)for(var o=0;o<t.length;o++)if(t[o].property==i)return o;return-1},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"aggregate",{get:function(){return null!=this._agg?this._agg:e.Aggregate.None},set:function(t){if((t=e.asEnum(t,e.Aggregate))!=this._agg){this._agg=t;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"describedById",{get:function(){return this._descById},set:function(t){if(t!=this._descById){this._descById=e.asString(t);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Column.prototype.getIsRequired=function(t){return null!=this._required?this._required:t&&null!=t.isRequired?t.isRequired:this.dataType==e.DataType.String?null!=this.dataMap||null!=this._mask&&this._mask.length>0:!t||t.dataType!=e.DataType.String||(null!=t.dataMap||null!=t.mask&&t.mask.length>0)};Column.prototype.getAlignment=function(t){if(null!=this._align)return this._align;if(t&&null!=t.align)return t.align;if(!this._map)switch(this.dataType){case e.DataType.Boolean:return"center";case e.DataType.Number:return"right"}if(t&&!t.dataMap)switch(t.dataType){case e.DataType.Boolean:return"center";case e.DataType.Number:return"right"}return""};Column.prototype._getBindingSort=function(){return this.sortMemberPath?this.sortMemberPath:this.binding?this.binding:null};Column._parseStarSize=function(t){if(e.isString(t)){var i=t.length;if(i>0&&"*"==t[i-1]){var o=1==i?1:parseFloat(t);if(o>0&&!isNaN(o))return o}}return null};Column._ctr=0;return Column}(o);t.Column=n;var r=function(e){__extends(Row,e);function Row(t){var o=e.call(this)||this;o.resizedManually=!1;o._f=i.ColumnDefault;o._data=t||null;return o}Object.defineProperty(Row.prototype,"dataItem",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0});Object.defineProperty(Row.prototype,"dataIndex",{get:function(){this._list&&this._list._dirty&&this._list._update();return this._idxData},enumerable:!0,configurable:!0});Object.defineProperty(Row.prototype,"height",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0});Object.defineProperty(Row.prototype,"renderHeight",{get:function(){return this.renderSize},enumerable:!0,configurable:!0});return Row}(o);t.Row=r;var l=function(o){__extends(GroupRow,o);function GroupRow(t){var i=o.call(this,t)||this;i._level=-1;i.level=t instanceof e.collections.CollectionViewGroup?t.level:-1;i.isReadOnly=!0;return i}Object.defineProperty(GroupRow.prototype,"level",{get:function(){return this._level},set:function(t){e.asInt(t);if(t!=this._level){this._level=t;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(GroupRow.prototype,"hasChildren",{get:function(){if(null!=this.grid&&null!=this._list){this._list._update();var i=this.index<this._list.length-1?this._list[this.index+1]:null,o=e.tryCast(i,GroupRow),n=e.tryCast(i,t._NewRowTemplate);return null!=i&&null==n&&(null==o||o.level>this.level)}return!0},enumerable:!0,configurable:!0});Object.defineProperty(GroupRow.prototype,"isCollapsed",{get:function(){return this._getFlag(i.Collapsed)},set:function(t){!!t!=this.isCollapsed&&null!=this._list&&this._setCollapsed(e.asBoolean(t))},enumerable:!0,configurable:!0});GroupRow.prototype.getGroupHeader=function(){var t=this.grid,i=t.groupHeaderFormat||e.culture.FlexGrid.groupHeaderFormat,o=this.dataItem;if(o instanceof e.collections.CollectionViewGroup&&i&&t.showGroups&&!t.childItemsPath){var n=o.groupDescription.propertyName,r=o.name,l=t.getColumn(n),s=this.isContentHtml;if(l){s=s||l.isContentHtml;l.header&&(n=l.header);var a=l.dataMap;a&&(r=a.getDisplayValue(r));l.dataType==e.getType(r)&&(r=e.Globalize.format(r,l.format))}else n=e.toHeaderCase(n);var c=o.getAggregate(e.Aggregate.CntAll,null,t.collectionView);return e.format(i,{name:e.escapeHtml(n),value:s?r:e.escapeHtml(r),level:o.level,count:c})}return""};GroupRow.prototype._setCollapsed=function(e){var o=this,n=this.grid,r=n.rows,l=this.getCellRange(),s=new t.CellRangeEventArgs(n.cells,new t.CellRange(this.index,-1));if(n.onGroupCollapsedChanging(s)){n.deferUpdate((function(){r.deferUpdate((function(){o._setFlag(i.Collapsed,e,!0);for(var t=l.topRow+1;t<=l.bottomRow&&t>-1&&t<r.length;t++){r[t]._setFlag(i.ParentCollapsed,e,!0);var n=r[t];n instanceof GroupRow&&n.isCollapsed&&(t=n.getCellRange().bottomRow)}}))}));n.onGroupCollapsedChanged(s)}};GroupRow.prototype.getCellRange=function(){for(var e=this._list,i=this.index,o=e.length-1,n=i+1;n<=o;n++){var r=e[n];if(r instanceof GroupRow&&r.level<=this.level){o=n-1;break}}return new t.CellRange(i,0,o,this.grid.columns.length-1)};return GroupRow}(r);t.GroupRow=l;var s=function(i){__extends(RowColCollection,i);function RowColCollection(o,n){var r=i.call(this)||this;r.frozenDetailChildren=0;r._frozen=0;r._lastFrozen=-1;r._firstVisible=-1;r._vlen=0;r._szDef=28;r._szTot=0;r._szCustom=!1;r._dirty=!1;r._g=e.asType(o,t.FlexGrid);r._szDef=e.asNumber(n,!1,!0);r._uid=e.uidGenerator();return r}Object.defineProperty(RowColCollection.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0});Object.defineProperty(RowColCollection.prototype,"defaultSize",{get:function(){return this._szDef},set:function(t){this._szCustom=!0;if(this._szDef!=t){this._szDef=e.asNumber(t,!1,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowColCollection.prototype,"frozen",{get:function(){return this._frozen},set:function(t){if(t!=this._frozen){this._frozen=e.asNumber(t,!1,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});RowColCollection.prototype.isFrozen=function(e){return e<this.frozen};Object.defineProperty(RowColCollection.prototype,"minSize",{get:function(){return this._szMin},set:function(t){if(t!=this._szMin){this._szMin=e.asNumber(t,!0,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowColCollection.prototype,"maxSize",{get:function(){return this._szMax},set:function(t){if(t!=this._szMax){this._szMax=e.asNumber(t,!0,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});RowColCollection.prototype.getTotalSize=function(){this._dirty&&this._update();return this._szTot};Object.defineProperty(RowColCollection.prototype,"visibleLength",{get:function(){this._dirty&&this._update();return this._vlen},enumerable:!0,configurable:!0});RowColCollection.prototype.getItemAt=function(e){this._dirty&&this._update();if(e<=0&&this.length>0&&this[0].renderSize)return 0;for(var t,i,o=this.length,n=0,r=o-1;n<=r;)if((i=this[t=n+r>>>1])._pos>=e&&t>0)r=t-1;else{if(!(i._pos+i.renderSize<=e&&t<o-1)){for(;t>0&&!this[t].renderSize;)t--;for(;t<o-1&&!this[t].renderSize;)t++;return t}n=t+1}return r};RowColCollection.prototype.getNextCell=function(e,i,o){void 0===o&&(o=0);var n,r=t.SelMove;switch(i){case r.Next:case r.NextCell:for(n=e+1;n<this.length;n++)if(this[n].renderSize>0)return n;break;case r.NextEditableCell:for(n=e+1;n<this.length;n++)if(this[n].renderSize>0&&!this[n].isReadOnly)return n;break;case r.Prev:case r.PrevCell:for(n=e-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case r.PrevEditableCell:for(n=e-1;n>=0;n--)if(this[n].renderSize>0&&!this[n].isReadOnly)return n;break;case r.End:for(n=this.length-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case r.Home:for(n=0;n<this.length;n++)if(this[n].renderSize>0)return n;break;case r.NextPage:return(n=this.getItemAt(this[e].pos+this[e].renderSize+o))<0?this.getNextCell(e,t.SelMove.End,o):n==e&&n<this.length-1&&this[n+1].renderSize?n+1:n;case r.PrevPage:return(n=this.getItemAt(this[e].pos-o))<0?this.getNextCell(e,t.SelMove.Home,o):n==e&&n>0&&this[n-1].renderSize?n-1:n}return e};RowColCollection.prototype.canMoveElement=function(e,i,o){void 0===o&&(o=!0);if(i==e)return!1;if(e<0||e>=this.length||i>=this.length)return!1;if(o){i<0&&(i=this.length-1);for(var n=Math.min(e,i),r=Math.max(e,i),l=n;l<=r;l++)if(!this[l].allowDragging)return!1}return!(this[i]instanceof t._NewRowTemplate)};RowColCollection.prototype.moveElement=function(e,t,i){void 0===i&&(i=!0);if(this.canMoveElement(e,t,i)){var o=this[e];this.removeAt(e);t<0&&(t=this.length);this.insert(t,o);if(i){var n=this.frozen;e<n&&t>=n?this.frozen--:e>=n&&t<n&&this.frozen++}return!0}return!1};RowColCollection.prototype.onCollectionChanged=function(t){void 0===t&&(t=e.collections.NotifyCollectionChangedEventArgs.reset);this._dirty=!0;this._g.invalidate();i.prototype.onCollectionChanged.call(this,t)};RowColCollection.prototype.push=function(e){e._setList(this);return i.prototype.push.call(this,e)};RowColCollection.prototype.splice=function(e,t){for(var n=this,r=[],l=2;l<arguments.length;l++)r[l-2]=arguments[l];for(var s=e;s<e+t&&s<this.length;s++){var a=this[s];a instanceof o&&a._setList(null)}r.forEach((function(e){return e._setList(n)}));return i.prototype.splice.apply(this,[e,t].concat(r))};RowColCollection.prototype.beginUpdate=function(){this._update();i.prototype.beginUpdate.call(this)};RowColCollection.prototype._setDefaultSize=function(e){if(!this._szCustom){this.defaultSize=e;this._szCustom=!1}};RowColCollection.prototype._update=function(){if(this._dirty&&!this.isUpdating){this._dirty=!1;this._lastFrozen=-1;this._firstVisible=-1;for(var e=0,t=0,i=void 0,o=void 0,n=0;n<this.length;n++){(o=this[n])._idx=n;o._idxVis=e;o._pos=t;o._setList(this);if((i=o.renderSize)>0){t+=i;e++;n<this._frozen&&(this._lastFrozen=n)}this._firstVisible<0&&o.visible&&(this._firstVisible=n)}this._vlen=e;this._szTot=t;return!0}return!1};return RowColCollection}(e.collections.ObservableArray);t.RowColCollection=s;var a=function(t){__extends(ColumnCollection,t);function ColumnCollection(){return null!==t&&t.apply(this,arguments)||this}ColumnCollection.prototype.getColumn=function(t){var i=e.isNumber(t)?t:this.indexOf(t);return i>-1?this[i]:null};ColumnCollection.prototype.indexOf=function(e){if(e instanceof n)return t.prototype.indexOf.call(this,e);for(var i=0;i<this.length;i++)if(this[i].name==e)return i;for(i=0;i<this.length;i++)if(this[i].binding==e)return i;return-1};Object.defineProperty(ColumnCollection.prototype,"describedById",{get:function(){return this._descById},set:function(t){if(t!=this._descById){this._descById=e.asString(t);this._g&&this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(ColumnCollection.prototype,"firstVisibleIndex",{get:function(){this._dirty&&this._update();return this._firstVisible},enumerable:!0,configurable:!0});ColumnCollection.prototype._updateStarSizes=function(e){var t,i=!1,o=0;e-=.5;for(var r=0;r<this.length;r++){if((s=this[r]).isVisible)if(s._szStar){o+=n._parseStarSize(s._szStar);t=s}else e-=s.renderWidth}if(t){var l=e;for(r=0;r<this.length;r++){var s;if((s=this[r]).isVisible&&s._szStar){var a=s._sz;s==t&&l>0?a=l:l-=a=Math.max(0,Math.round(n._parseStarSize(s._szStar)/o*e));if(a!=s._sz){s._sz=a;i=!0}}}if(i){this._dirty=!0;this._update()}return i}return!1};return ColumnCollection}(s);t.ColumnCollection=a;var c=function(t){__extends(RowCollection,t);function RowCollection(){var e=null!==t&&t.apply(this,arguments)||this;e._maxLevel=-1;return e}Object.defineProperty(RowCollection.prototype,"ariaLabel",{get:function(){return this._ariaLabel},set:function(t){if(t!=this.ariaLabel){this._ariaLabel=e.asString(t);this._g&&this._g.refresh()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCollection.prototype,"maxGroupLevel",{get:function(){this._dirty&&this._update();return this._maxLevel},enumerable:!0,configurable:!0});RowCollection.prototype._update=function(){var e=this;if(t.prototype._update.call(this)){var i=this.grid?this.grid.collectionView:null,o=i?i.items:null,n=0;this._maxLevel=-1;this.forEach((function(t){t instanceof l&&t.level>e._maxLevel&&(e._maxLevel=t.level);var i=t.dataItem;i&&o?i===o[n]?t._idxData=n:i===o[n+1]?t._idxData=++n:i!==o[t._idxData]&&(t._idxData=-1):t._idxData=-1}));return!0}return!1};return RowCollection}(s);t.RowCollection=c}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.colHdrAriaAttributes=function(t,i,o,n,r){void 0===r&&(r=!1);e.setAttribute(t,"role",r?"rowheader":"columnheader");if(i.describedById||o.columns.describedById){var l=[i.describedById,o.columns.describedById].join(" ").trim();e.setAttribute(t,"aria-describedby",l||null)}if(n.allowSorting){var s="none";switch(n._getBindingColumn(o,0,i).currentSort){case"+":s="ascending";break;case"-":s="descending"}e.setAttribute(t,"aria-sort",s)}if(!n.isReadOnly){e.setAttribute(t,"aria-readonly",i.isReadOnly);e.setAttribute(t,"aria-required",i.isReadOnly?null:i.getIsRequired())}var a=t.closest(".wj-row");e.setAttribute(a,"role","row")}}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){var i=function(){function _ColumnGroupHandler(e){this._updatingCollection=0;this._initialized=!1;this._grid=e;this._initializeColumnGroups();this._initialized=!0}Object.defineProperty(_ColumnGroupHandler.prototype,"columnGroups",{get:function(){return this._colGroups},enumerable:!0,configurable:!0});_ColumnGroupHandler.prototype.createColumnGroups=function(e){this._initialized=!1;this._createColumnGroups(e);this._initialized=!0};_ColumnGroupHandler.prototype.hasColumnGroups=function(){return null!=this._colGroups&&this._colGroups.length>0};_ColumnGroupHandler.prototype.getGroupDefinitions=function(){return this._groupDefs};_ColumnGroupHandler.prototype.getColumnGroup=function(e,t){return this._getColumnGroup(e,t)};_ColumnGroupHandler.prototype.canMoveColumnGroup=function(e,t,i,o){if(e==i&&t==o)return!1;var n=this._grid,r=n.columnHeaders.rows,l=n.columns;if(e<0||e>=r.length||t<0||t>=l.length||i<0||i>=r.length||o<0||o>=l.length)return!1;var s=this._getColumnGroup(e,t),a=this._getColumnGroup(i,o);if(!s||!a||s==a)return!1;if(s.level<a.level&&s._containsGroup(a))return!1;var c=s.parentGroup,u=a.parentGroup;return!c||c===u||!c._isCollapseTo(s)};_ColumnGroupHandler.prototype.moveColumnGroup=function(e,t,i,o,n){if(this.canMoveColumnGroup(e,t,i,o)){var r=this._getColumnGroup(e,t),l=this._getColumnGroup(i,o);if(!r||!l||r==l)return!1;if(n&&!l.isEmpty)return!1;var s=this._getCollection(r),a=n?l.columns:this._getCollection(l);if(!s||!a)return!1;var c=n?0:a.indexOf(l);if(c<0)return!1;!n&&s!=a&&o>t&&c++;this._deferCollectionUpdate((function(){if(!s.remove(r))return!1;a.insert(c,r)}));return!0}return!1};_ColumnGroupHandler.prototype.handleCollectionChange=function(){if(this._initialized&&!this._updatingCollection){this._initialized=!1;this._buildColumnGroups();this._initialized=!0}};_ColumnGroupHandler.prototype.handlePropertyChange=function(e){if(e&&this._initialized){var t=this._grid,i=e._rng,o=e.header;if(o!=e._curr_header)for(var n=i.topRow;n<=i.bottomRow;n++)for(var r=i.leftCol;r<=i.rightCol;r++){t.columnHeaders.setCellData(n,r,o);e._curr_header=o}e.columns.length>0&&t.invalidate()}};_ColumnGroupHandler.prototype._initializeColumnGroups=function(){var e=this._grid,t=new n;this._groupDefs=t;this._colGroups=t;this._colGroups._setOwner(e);this._colGroups._setChangeHandler(this)};_ColumnGroupHandler.prototype._createColumnGroups=function(t){this._grid;this._groupDefs=e.asArray(t);this._colGroups&&this._colGroups._setOwner(null);this._colGroups=n._parse(t);this._buildColumnGroups()};_ColumnGroupHandler.prototype._buildColumnGroups=function(){var i=this,o=this._grid;this._colGroups._removeChangeHandler();this._assertColumnGroups(this._colGroups);o.autoGenerateColumns=!1;o.columns.clear();this._colGroups._setOwner(o);this._colGroups.forEach((function(e){e._beginBuild()}));var n=0;this._colGroups.forEach((function(e){i._addColumnGroup(e);n=Math.max(n,e._getMaxLevel())}));this._colGroups.forEach((function(e){e._expandRange(n)}));var r=o.columnHeaders.rows;r.clear();for(var l=0;l<=n;l++){var s=new t.Row;r.splice(l,0,s);l<n&&(s.cssClassAll="wj-colgroup")}for(l=0;l<r.length;l++)for(var a=0;a<o.columns.length;a++){var c=this._getColumnGroup(l,a);if(c){var u=c.header||e.toHeaderCase(c.binding);o.columnHeaders.setCellData(l,a,u);if(c.height){var d=o.columnHeaders.rows[l].height;o.columnHeaders.rows[l].height=d<=c.height?c.height:d}c._curr_header=c.header}}this._colGroups._setChangeHandler(this);this._colGroups.forEach((function(e){e._checkIfCollapsed()}))};_ColumnGroupHandler.prototype._getColumnGroup=function(e,t){var i=this._grid;if(e<i.columnHeaders.rows.length&&t<i.columns.length)for(var o=this._colGroups;o;){for(var n=o,r=0;r<o.length;r++){var l=o[r],s=l._rng;if(s.containsColumn(t)){if(s.containsRow(e)||0==l.columns.length)return l;o=l.columns;break}}if(o==n)break}return null};_ColumnGroupHandler.prototype._getCollection=function(e){var t=e.parentGroup;return t?t.columns:this._colGroups};_ColumnGroupHandler.prototype._assertColumnGroups=function(t){var i=this;e.assert(t instanceof n,"column groups contain items of invalid collection type");t.forEach((function(t){e.assert(t instanceof o,"column groups contain items of invalid type");i._assertColumnGroups(t.columns)}))};_ColumnGroupHandler.prototype._addColumnGroup=function(e){var t=this,i=this._grid;e._rng.col=i.columns.length;0==e.columns.length?i.columns.push(e):e.columns.forEach((function(e){t._addColumnGroup(e)}));e._rng.col2=i.columns.length-1};_ColumnGroupHandler.prototype._beginCollectionUpdate=function(){this._updatingCollection++};_ColumnGroupHandler.prototype._endCollectionUpdate=function(){this._updatingCollection--;this._updatingCollection<=0&&this.handleCollectionChange()};_ColumnGroupHandler.prototype._deferCollectionUpdate=function(e){try{this._beginCollectionUpdate();e()}finally{this._endCollectionUpdate()}};return _ColumnGroupHandler}();t._ColumnGroupHandler=i;var o=function(i){__extends(ColumnGroup,i);function ColumnGroup(o,r){var l=i.call(this)||this;l._rng=new t.CellRange(0,-1);l._lvl=0;l._collapsed=!1;l._cols=new n;e.copy(l,o);var s=r&&r.columns;s&&s.indexOf(l)<0&&s.push(l);return l}ColumnGroup.prototype._copy=function(t,i){if("columns"==t){var o=e.asArray(i);this._cols=n._parse(o);return!0}return!1};Object.defineProperty(ColumnGroup.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"columnGroups",{get:function(){return this._cols},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"height",{get:function(){return this._cgHeight},set:function(e){this._cgHeight=e},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"isEmpty",{get:function(){return 0===this._cols.length},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"parentGroup",{get:function(){var e=this._ownerList,t=e&&e.owner;return t instanceof ColumnGroup?t:null},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"level",{get:function(){for(var e=this,t=0;e.parentGroup;){e=e.parentGroup;t++}return t},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"collapseTo",{get:function(){return this._collTo},set:function(t){e.assert(e.isArray(t)||e.isString(t),"collapseTo should be an array or a string.");if(this._collTo!=t){this._collTo=t;this._updateCollapsedState()}},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"isCollapsed",{get:function(){return this._collapsed},set:function(i){var o=this.grid,n=null;if(i!=this._collapsed)if(o){n=new t.CellRangeEventArgs(o.columnHeaders,this._rng,this);o.onColumnGroupCollapsedChanging(n)?this._collapsed=e.asBoolean(i):n=null}else this._collapsed=e.asBoolean(i);this._updateCollapsedState();o&&n&&o.onColumnGroupCollapsedChanged(n)},enumerable:!0,configurable:!0});Object.defineProperty(ColumnGroup.prototype,"grid",{get:function(){var e=this._ownerList,i=e&&e.owner;return i instanceof ColumnGroup?i.grid:i instanceof t.FlexGrid?i:null},enumerable:!0,configurable:!0});ColumnGroup.prototype._beginBuild=function(){var e=this;this._lvl=0;for(var i=this.parentGroup;i;i=i.parentGroup)this._lvl++;setTimeout((function(){if(e.parentGroup&&0!==e._lvl&&e.parentGroup.width&&(null===e.width||void 0===e.width)){var t=0,i=0;e.parentGroup._cols.forEach((function(e){t+=e.width;null!==e.width&&void 0!==e.width||i++}));e.width=(e.parentGroup.width-t)/i}}),0);this._rng=new t.CellRange(0,-1);this._rng.row=this._rng.row2=this._lvl;this._cols.forEach((function(e){e._beginBuild()}))};ColumnGroup.prototype._setChangeHandler=function(e){this._changeHdl=e;this._cols._setChangeHandler(e)};ColumnGroup.prototype._removeChangeHandler=function(){this._changeHdl=null;this._cols._removeChangeHandler()};ColumnGroup.prototype._setOwnerList=function(e){e!=this._ownerList&&(this._ownerList=e)};ColumnGroup.prototype._checkIfCollapsed=function(){var e=this.grid;(e?e.columns:null)&&(this._collapsed?this._updateCollapsedState():this._cols.forEach((function(e){e._checkIfCollapsed()})))};ColumnGroup.prototype._updateCollapsedState=function(){var e=this.grid,i=e?e.columns:null,o=this._rng,n=this._collapsed;if(i){this._cols.forEach((function(e){if(e instanceof ColumnGroup){e._collapsed=n;e._updateCollapsedState()}}));for(var r=this._getCollapseToIndices(),l=o.leftCol;l<=o.rightCol;l++){var s=!n||r.indexOf(l)>-1;i[l]._setFlag(t.RowColFlags.ParentCollapsed,!s)}}};ColumnGroup.prototype._getMaxLevel=function(){var e=this._lvl;this.columns.forEach((function(t){e=Math.max(e,t._getMaxLevel())}));return e};ColumnGroup.prototype._expandRange=function(e){var t=e-this._getMaxLevel();if(t>0){this._rng.row2+=t;this._cols.forEach((function(e){e._shiftRange(t)}))}for(var i=this.grid.columns,o=this._rng,n=o.col;n<=o.col2;n++){i[n]._rng.row2=e}};ColumnGroup.prototype._shiftRange=function(e){this._rng.row+=e;this._rng.row2+=e;this._cols.forEach((function(t){t._shiftRange(e)}))};ColumnGroup.prototype._containsGroup=function(e){for(var t=0;t<this._cols.length;t++){var i=this._cols[t];if(i==e||i._containsGroup(e))return!0}return!1};ColumnGroup.prototype._isCollapseTo=function(e){var t=this.grid,i=t?t.columns:null;if(!e||!i)return!1;var o=this._getCollapseToBindings();if(o&&o.length)for(var n=0;n<o.length;n++)switch(o[n]){case"$first":case"$last":continue;default:if(e===i.getColumn(o[n]))return!0}return!1};ColumnGroup.prototype._getCollapseToBindings=function(){var t=this.collapseTo;return e.isString(t)?[t]:t};ColumnGroup.prototype._getCollapseToIndices=function(){var e=this.grid,t=this._rng,i=this._getCollapseToBindings();if(i&&i.length){for(var o=[],n=e.columns,r=0;r<i.length;r++)switch(i[r]){case"$first":o.push(t.leftCol);break;case"$last":o.push(t.rightCol);break;default:var l=n.getColumn(i[r]),s=n.indexOf(l);l&&t.containsColumn(s)&&o.push(s)}if(o.length)return o}return[t.rightCol]};ColumnGroup.prototype.onPropertyChanged=function(){var e=this._changeHdl;e&&e.handlePropertyChange(this);i.prototype.onPropertyChanged.call(this)};return ColumnGroup}(t.Column);t.ColumnGroup=o;var n=function(t){__extends(ColumnGroupCollection,t);function ColumnGroupCollection(){return null!==t&&t.apply(this,arguments)||this}ColumnGroupCollection.prototype.getColumn=function(t){return e.isNumber(t)?this._getColByIdx(t):this._findColByProp("name",t)||this._findColByProp("binding",t)};Object.defineProperty(ColumnGroupCollection.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0});ColumnGroupCollection.prototype.push=function(e){e._setOwnerList(this);return t.prototype.push.call(this,e)};ColumnGroupCollection.prototype.splice=function(e,i){for(var n=this,r=[],l=2;l<arguments.length;l++)r[l-2]=arguments[l];for(var s=e;s<e+i&&s<this.length;s++){var a=this[s];a instanceof o&&a._setOwnerList(null)}r.forEach((function(e){return e._setOwnerList(n)}));return t.prototype.splice.apply(this,[e,i].concat(r))};ColumnGroupCollection._parse=function(e){var t=null;if(e)if(e instanceof ColumnGroupCollection)t=e;else{t=new ColumnGroupCollection;e.forEach((function(e){var i=e instanceof o?e:new o(e);t.indexOf(i)<0&&t.push(i)}))}else t=new ColumnGroupCollection;return t};ColumnGroupCollection.prototype._setChangeHandler=function(e){this._changeHdl=e;this.forEach((function(t){return t._setChangeHandler(e)}))};ColumnGroupCollection.prototype._removeChangeHandler=function(){this._changeHdl=null;this.forEach((function(e){return e._removeChangeHandler()}))};ColumnGroupCollection.prototype._setOwner=function(e){this._owner=e;this.forEach((function(e){return e.columns._setOwner(e)}))};ColumnGroupCollection.prototype._getColByIdx=function(e){return e>-1&&e<this.length?this[e]:null};ColumnGroupCollection.prototype._findColByProp=function(e,t){for(var i=0;i<this.length;i++){var o=this[i];if(o[e]===t)return o;if(null!==(o=o.columns._findColByProp(e,t)))return o}return null};ColumnGroupCollection.prototype.onCollectionChanged=function(i){void 0===i&&(i=e.collections.NotifyCollectionChangedEventArgs.reset);var o=this._changeHdl;o&&o.handleCollectionChange();t.prototype.onCollectionChanged.call(this,i)};return ColumnGroupCollection}(e.collections.ObservableArray);t.ColumnGroupCollection=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i,o,n,r,l,s,a;e._addCultureInfo("FlexGrid",{groupHeaderFormat:"{name}: <b>{value}</b> ({count:n0} items)",ariaLabels:{toggleDropDown:"Toggle Dropdown",toggleGroup:"Toggle Group"}});!function(e){e[e.None=0]="None";e[e.SingleColumn=1]="SingleColumn";e[e.MultiColumn=2]="MultiColumn"}(o=t.AllowSorting||(t.AllowSorting={}));!function(e){e[e.None=0]="None";e[e.SingleColumn=1]="SingleColumn";e[e.ColumnRange=2]="ColumnRange";e[e.Both=3]="Both"}(n=t.AllowPinning||(t.AllowPinning={}));!function(e){e[e.None=0]="None";e[e.Column=1]="Column";e[e.Row=2]="Row";e[e.All=3]="All"}(r=t.HeadersVisibility||(t.HeadersVisibility={}));!function(e){e[e.Default=0]="Default";e[e.CSV=1]="CSV";e[e.QuoteAll=2]="QuoteAll";e[e.SkipMerged=4]="SkipMerged";e[e.Unformatted=8]="Unformatted";e[e.InvisibleRows=16]="InvisibleRows";e[e.InvisibleColumns=32]="InvisibleColumns";e[e.InvisibleCells=48]="InvisibleCells"}(l=t.ClipStringOptions||(t.ClipStringOptions={}));!function(e){e[e.None=0]="None";e[e.Column=1]="Column";e[e.Row=2]="Row";e[e.All=3]="All"}(s=t.HeadersFocusability||(t.HeadersFocusability={}));!function(e){e[e.Column=0]="Column";e[e.Row=1]="Row"}(a=t.FrozenRowCol||(t.FrozenRowCol={}));var c=function(c){__extends(FlexGrid,c);function FlexGrid(i,l){var a=c.call(this,i,null,!0)||this;a._activeCell=null;a._activePanelType=t.CellType.Cell;a._szClient=new e.Size(0,0);a._szClientSB=new e.Size(0,0);a._offsetY=0;a._cssPage=0;a._ptScrl=new e.Point(0,0);a._cellPadLeft=3;a._cellPadHorz=3;a._cellPadVert=0;a._clipToScreen=!1;a._anchorCell=null;a._autoGenCols=!0;a._autoClipboard=!0;a._xOnCopyPaste=!0;a._autoScroll=!0;a._autoSearch=!1;a._caseSensitive=!1;a._readOnly=!1;a._indent=14;a._autoSizeMode=t.AutoSizeMode.Both;a._autoHeights=!1;a._quickSize=null;a._hdrVis=r.All;a._hdrFoc=s.None;a._alSorting=o.SingleColumn;a._alPinning=n.None;a._alAddNew=!1;a._alDelete=!1;a._alResizing=t.AllowResizing.Columns;a._alDragging=t.AllowDragging.Columns;a._alMerging=t.AllowMerging.None;a._ssHdr=r.None;a._shSort=!0;a._shGroups=!0;a._shMarquee=!1;a._shPlcHld=!1;a._altStep=1;a._shErr=!0;a._shDropDown=!0;a._valEdt=!0;a._gHdrFmt=null;a._childItemsPath=null;a._sortRowIndex=null;a._editColIndex=null;a._deferResizing=!1;a._pSel=!0;a._pOutline=!0;a._stickyHdr=!1;a._anchorCursor=!1;a._copyHeaders=r.None;a._bigChecks=!1;a._skipMerged=!1;a._commitEmptyEdits=!0;a._fzClone=null;a._vt=0;a._vtRows=0;a._vtCols=0;a._lazyRender=!0;a._refreshOnEdit=!0;a._reorderCells=!0;a._isISChanging=!1;a._isScrollingByWheel=!1;a._touchEdit=!1;a.itemsSourceChanging=new e.Event;a.itemsSourceChanged=new e.Event;a.scrollPositionChanged=new e.Event;a.selectionChanging=new e.Event;a.selectionChanged=new e.Event;a.loadingRows=new e.Event;a.loadedRows=new e.Event;a.updatingLayout=new e.Event;a.updatedLayout=new e.Event;a.resizingColumn=new e.Event;a.resizedColumn=new e.Event;a.autoSizingColumn=new e.Event;a.autoSizedColumn=new e.Event;a.starSizedColumns=new e.Event;a.draggingColumn=new e.Event;a.draggingColumnOver=new e.Event;a.draggedColumn=new e.Event;a.pinningColumn=new e.Event;a.pinnedColumn=new e.Event;a.resizingRow=new e.Event;a.resizedRow=new e.Event;a.autoSizingRow=new e.Event;a.autoSizedRow=new e.Event;a.draggingRow=new e.Event;a.draggingRowOver=new e.Event;a.draggedRow=new e.Event;a.groupCollapsedChanging=new e.Event;a.groupCollapsedChanged=new e.Event;a.columnGroupCollapsedChanging=new e.Event;a.columnGroupCollapsedChanged=new e.Event;a.sortingColumn=new e.Event;a.sortedColumn=new e.Event;a.beginningEdit=new e.Event;a.prepareCellForEdit=new e.Event;a.cellEditEnding=new e.Event;a.cellEditEnded=new e.Event;a.rowEditStarting=new e.Event;a.rowEditStarted=new e.Event;a.rowEditEnding=new e.Event;a.rowEditEnded=new e.Event;a.rowAdded=new e.Event;a.deletingRow=new e.Event;a.deletedRow=new e.Event;a.copying=new e.Event;a.copied=new e.Event;a.pasting=new e.Event;a.pasted=new e.Event;a.pastingCell=new e.Event;a.pastedCell=new e.Event;a.formatItem=new e.Event((function(){a._clearCells()}));a.updatingView=new e.Event;a.updatedView=new e.Event;a._mappedColumns=null;var u=a.hostElement;e.isIE()&&(u.style.borderRadius="0");var d=a.getTemplate();a.applyTemplate("wj-control wj-content wj-flexgrid",d,{_root:"root",_eSz:"sz",_eCt:"cells",_fCt:"fcells",_eTL:"tl",_eBL:"bl",_eCHdr:"ch",_eRHdr:"rh",_eCFtr:"cf",_eTLCt:"tlcells",_eBLCt:"blcells",_eCHdrCt:"chcells",_eCFtrCt:"cfcells",_eRHdrCt:"rhcells",_eMarquee:"marquee",_eFocus:"focus"});e.setCss(a._root.parentElement,{position:"relative",left:"0",top:"0",width:"100%",height:"100%",overflow:"hidden",minWidth:"inherit",minHeight:"inherit",maxWidth:"inherit",maxHeight:"inherit"});e.setCss(a._root,{position:"absolute",left:"0",top:"0",width:"100%",height:"100%",minWidth:"inherit",minHeight:"inherit",maxWidth:"inherit",maxHeight:"inherit",overflow:"auto",webkitOverflowScrolling:"touch"});e.setCss(a._eCt,{position:"absolute"});e.setCss(a._eMarquee,{display:"none"});e.setCss(a._eMarquee.firstChild,{width:"100%",height:"100%"});e.setCss(a._fCt,{position:"absolute",top:0,left:0,overflow:"hidden",pointerEvents:"none"});e.setCss(a._eFocus,{position:"fixed",left:"-32000px"});e.setCss(a._eSz,{position:"relative",visibility:"hidden"});[a._eRHdr,a._eCFtr,a._eCHdr,a._eBL,a._eTL].forEach((function(t){e.setAttribute(t,"aria-hidden",!0);e.setCss(t,{position:"absolute",overflow:"hidden",outline:"none"});e.setCss(t.firstElementChild,{position:"relative"})}));[a._eFocus,a._eMarquee,a._fCt,a._eSz].forEach((function(t){e.setAttribute(t,"aria-hidden",!0)}));if(e.isIE9()||e.isIE10()){var h=a._eMarquee;["click","dblclick","mousedown","mouseup"].forEach((function(e){a.addEventListener(h,e,(function(t){var i=h.style.display;h.style.display="none";var o=document.elementFromPoint(t.clientX,t.clientY);h.style.display=i;var n=document.createEvent("Event");n.initEvent(e,!0,!0);for(var r in t)try{n[r]=t[r]}catch(e){}o.dispatchEvent(n)}))}))}u.tabIndex=-1;a._uid=e.uidGenerator();a.deferUpdate((function(){var i=a._getDefaultRowHeight();a._rows=new t.RowCollection(a,i);a._cols=new t.ColumnCollection(a,4*i);a._hdrRows=new t.RowCollection(a,i);a._hdrCols=new t.ColumnCollection(a,Math.round(1.25*i));a._ftrRows=new t.RowCollection(a,i);var o=t.CellType;a._gpTL=new t.GridPanel(a,o.TopLeft,a._hdrRows,a._hdrCols,a._eTLCt);a._gpCHdr=new t.GridPanel(a,o.ColumnHeader,a._hdrRows,a._cols,a._eCHdrCt);a._gpRHdr=new t.GridPanel(a,o.RowHeader,a._rows,a._hdrCols,a._eRHdrCt);a._gpCells=new t.GridPanel(a,o.Cell,a._rows,a._cols,a._eCt);a._gpBL=new t.GridPanel(a,o.BottomLeft,a._ftrRows,a._hdrCols,a._eBLCt);a._gpCFtr=new t.GridPanel(a,o.ColumnFooter,a._ftrRows,a._cols,a._eCFtrCt);a.activePanel=a._gpCells;a._hdrRows.push(new t.Row);a._hdrCols.push(new t.Column({align:"center"}));a._cf=new t.CellFactory;a._keyHdl=new t._KeyboardHandler(a);a._mouseHdl=new t._MouseHandler(a);a._edtHdl=new t._EditHandler(a);a._selHdl=a._createSelHdl();a._addHdl=new t._AddNewHandler(a);a._grpHdl=new t._ColumnGroupHandler(a);a._mrgMgr=new t.MergeManager;a._bndSortConverter=a._sortConverter.bind(a);a._errorTip=new e.Tooltip({isContentHtml:!1,showDelay:0,cssClass:"wj-error-tip"});a.selectionMode=t.SelectionMode.CellRange;a._root.tabIndex=-1;a.initialize(l)}));a.addEventListener(a._root,"scroll",(function(t){if(a._updateScrollPosition()||a._forceScrollUpdate){var i=a.activeEditor,o=a.activeCell,n=o?o.className:null;if((e.hasClass(o,"wj-detail")||e.hasClass(i,"wj-numeric"))&&e.Control.sharedState.InvalidScroll){setTimeout((function(){e.Control.sharedState.InvalidScroll=!1}),0);return}a._forceScrollUpdate||e.Control.sharedState.InvalidScroll||a.finishEditing();a._forceScrollUpdate=!1;if("React"===a.workingAs)requestAnimationFrame((function(){a._updateContent(!0);setTimeout((function(){e.Control.sharedState.InvalidScroll=!1}),0)}));else{a._updateContent(!0);setTimeout((function(){e.Control.sharedState.InvalidScroll=!1}),0)}var r=a.activeEditor,l=a.activeCell;if(r&&l&&i&&n){r.value=i.value;l.className=n;a._setFocusNoScroll(r)}else r&&!l&&(e.Control.sharedState.InvalidScroll||a.finishEditing(!0));a.columns.frozen&&setTimeout((function(){var e=a.columnHeaders.hostElement.style,t=parseInt(e.left),i=a._ptScrl.x;Math.abs(t-i)>1&&a.invalidate()}));setTimeout((function(){a._isScrollingByWheel=!1;e.Control.sharedState.InvalidScroll=!1}),0)}}));a.addEventListener(u,"focus",(function(e){if(u.tabIndex>-1){var t=e.target;t instanceof HTMLElement&&t.tabIndex<0&&a._setFocus(!0)}}),!0);return a}Object.defineProperty(FlexGrid.prototype,"activePanel",{get:function(){return this._activePanel},set:function(e){this._activePanel=e},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"activePanelType",{get:function(){return this._activePanelType},set:function(e){if(this._activePanelType!==e){Array.from(this.hostElement.getElementsByClassName("wj-focus-header-cell")).forEach((function(e){e.classList.remove("wj-focus-header-cell");e.setAttribute("tabindex","-1")}));this._activePanelType=e;e!==t.CellType.Cell?e!==t.CellType.ColumnHeader?e!==t.CellType.RowHeader?e!==t.CellType.TopLeft||(this.activePanel=this._gpTL):this.activePanel=this._gpRHdr:this.activePanel=this._gpCHdr:this.activePanel=this._gpCells}},enumerable:!0,configurable:!0});FlexGrid.prototype._handleResize=function(){var e=this;this._rcBounds=null;this.activeEditor&&this.isTouching||this._touchEdit?setTimeout((function(){if(!e.activeEditor){e._touchEdit=!0;e.startEditing(!0)}}),50):c.prototype._handleResize.call(this);this._touchEdit=!1};Object.defineProperty(FlexGrid.prototype,"headersVisibility",{get:function(){return this._hdrVis},set:function(t){if((t=e.asEnum(t,r))!=this._hdrVis){this._hdrVis=t;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"headersFocusability",{get:function(){return this._hdrFoc},set:function(t){if((t=e.asEnum(t,s))!=this._hdrFoc){this._hdrFoc=t;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"stickyHeaders",{get:function(){return this._stickyHdr},set:function(t){if(t!=this._stickyHdr){this._stickyHdr=e.asBoolean(t);this._updateStickyHeaders();this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"preserveSelectedState",{get:function(){return this._pSel},set:function(t){this._pSel=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"preserveOutlineState",{get:function(){return this._pOutline},set:function(t){this._pOutline=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"anchorCursor",{get:function(){return this._anchorCursor},set:function(t){this._anchorCursor=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"copyHeaders",{get:function(){return this._copyHeaders},set:function(t){this._copyHeaders=e.asEnum(t,r)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"lazyRender",{get:function(){return this._lazyRender},set:function(t){this._lazyRender=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"refreshOnEdit",{get:function(){return this._refreshOnEdit},set:function(t){this._refreshOnEdit=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"virtualizationThreshold",{get:function(){return this._vt},set:function(t){this._vt=t;if(e.isNumber(t))this._vtRows=this._vtCols=e.asNumber(t);else if(t)if(e.isArray(t)&&2==t.length){this._vtRows=e.asNumber(t[0]);this._vtCols=e.asNumber(t[1])}else e.assert(!1,"virtualizationThreshold should be a number or an array with two numbers.");else this._vtRows=this._vtCols=0},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoGenerateColumns",{get:function(){return this._autoGenCols},set:function(t){this._autoGenCols=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoClipboard",{get:function(){return this._autoClipboard},set:function(t){this._autoClipboard=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"expandSelectionOnCopyPaste",{get:function(){return this._xOnCopyPaste},set:function(t){this._xOnCopyPaste=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoScroll",{get:function(){return this._autoScroll},set:function(t){this._autoScroll=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoSearch",{get:function(){return this._autoSearch},set:function(t){this._autoSearch=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"caseSensitiveSearch",{get:function(){return this._caseSensitive},set:function(t){this._caseSensitive=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnLayout",{get:function(){var i,o=this._hasColumnGroups(),n=o?t.ColumnGroup:t.Column,r=o?"columnGroups":"columns",l=FlexGrid._getSerializableProperties(n),s=o?["collapseTo"]:[],a=["size"],c=new n,u=o?this.getColumnGroups():this.columns,serializeColumns=function(t){var i=[];t.forEach((function(t){var n={};l.forEach((function(i){var o=t[i];(function(t,i){return i!=c[t]&&a.indexOf(t)<0&&(e.isPrimitive(i)||s.indexOf(t)>-1)})(i,o)&&(n[i]=o)}));if(o){var r=t.columns;r.length&&(n.columns=serializeColumns(r))}i.push(n)}));return i},d=serializeColumns(u);return JSON.stringify(((i={})[r]=d,i))},set:function(i){var o=this,n=JSON.parse(e.asString(i));e.assert(n,"Invalid columnLayout data.");this.columns.deferUpdate((function(){o.columns.clear();o._hasColumnGroups()&&(o.columnGroups=new t.ColumnGroupCollection);o.initialize(n)}))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnGroups",{get:function(){return this._grpHdl.getGroupDefinitions()},set:function(t){this.columns.clear();this._grpHdl.createColumnGroups(e.asArray(t))},enumerable:!0,configurable:!0});FlexGrid.prototype.getColumnGroups=function(){return this._grpHdl.columnGroups};Object.defineProperty(FlexGrid.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){if(t!=this._readOnly){this._readOnly=e.asBoolean(t);this.finishEditing();this.invalidate(!0);this._addHdl.updateNewRowTemplate();e.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly);this._setAria("readonly",this.isReadOnly?"true":null)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"bigCheckboxes",{get:function(){return this._bigChecks},set:function(t){this._bigChecks=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"skipMerged",{get:function(){return this._skipMerged},set:function(t){this._skipMerged=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"isDisabled",{get:function(){return this._e&&null!=this._e.getAttribute("disabled")},set:function(t){if((t=e.asBoolean(t,!0))!=this.isDisabled){var i=this._e;if(i){e.enable(i,!t);this._updateTabIndex();this.invalidate()}}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"imeEnabled",{get:function(){return null!=this._imeHdl},set:function(i){if(e.asBoolean(i)!=this.imeEnabled&&this.finishEditing()){var o=this.containsFocus();if(this._imeHdl){this._imeHdl.dispose();this._imeHdl=null}i&&(this._imeHdl=new t._ImeHandler(this));o&&this.focus()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowResizing",{get:function(){return this._alResizing},set:function(i){this._alResizing=e.asEnum(i,t.AllowResizing)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"deferResizing",{get:function(){return this._deferResizing},set:function(t){this._deferResizing=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoSizeMode",{get:function(){return this._autoSizeMode},set:function(i){this._autoSizeMode=e.asEnum(i,t.AutoSizeMode)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoRowHeights",{get:function(){return this._autoHeights},set:function(t){this._autoHeights=e.asBoolean(t);this._autoRowHeights()},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(t){this._quickSize=e.asBoolean(t,!0)},enumerable:!0,configurable:!0});FlexGrid.prototype._getQuickAutoSize=function(){return e.isBoolean(this._quickSize)?this._quickSize:!this.formatItem.hasHandlers&&null==this.itemFormatter};Object.defineProperty(FlexGrid.prototype,"allowSorting",{get:function(){return this._alSorting},set:function(t){e.isBoolean(t)&&(t=t?o.SingleColumn:o.None);this._alSorting=e.asEnum(t,o)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowPinning",{get:function(){return this._alPinning},set:function(t){if(t!=this._alPinning){e.isBoolean(t)&&(t=t?n.SingleColumn:n.None);this._alPinning=e.asEnum(t,n);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowAddNew",{get:function(){return this._alAddNew},set:function(t){if(t!=this._alAddNew){this._alAddNew=e.asBoolean(t);this._addHdl.updateNewRowTemplate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"newRowAtTop",{get:function(){return this._addHdl.newRowAtTop},set:function(t){this._addHdl.newRowAtTop=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowDelete",{get:function(){return this._alDelete},set:function(t){t!=this._alDelete&&(this._alDelete=e.asBoolean(t))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowMerging",{get:function(){return this._alMerging},set:function(i){if((i=e.asEnum(i,t.AllowMerging))!=this._alMerging){this._alMerging=i;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showSelectedHeaders",{get:function(){return this._ssHdr},set:function(t){if((t=e.asEnum(t,r))!=this._ssHdr){this._ssHdr=t;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showMarquee",{get:function(){return this._shMarquee},set:function(t){if(t!=this._shMarquee){this._shMarquee=e.asBoolean(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showPlaceholders",{get:function(){return this._shPlcHld},set:function(t){this._shPlcHld=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showSort",{get:function(){return this._shSort},set:function(t){if(t!=this._shSort){this._shSort=e.asBoolean(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showGroups",{get:function(){return this._shGroups},set:function(t){if(t!=this._shGroups){this._shGroups=e.asBoolean(t);this._bindGrid(!1)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"alternatingRowStep",{get:function(){return this._altStep},set:function(t){if(t!=this._altStep){this._altStep=e.asInt(t,!1,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showAlternatingRows",{get:function(){return this._altStep>0},set:function(t){e._deprecated("showAlternatingRows","alternatingRowStep");this.alternatingRowStep=t?1:0},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showErrors",{get:function(){return this._shErr},set:function(t){if(t!=this._shErr){this._clearCells();this._shErr=e.asBoolean(t)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"errorTip",{get:function(){return this._errorTip},set:function(t){if(t!=this._errorTip){this._clearCells();this._errorTip=e.asType(t,e.Tooltip,!0)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(t){if(t!=this.itemValidator){this._itemValidator=e.asFunction(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"validateEdits",{get:function(){return this._valEdt},set:function(e){this._setvalidateEdits(e)},enumerable:!0,configurable:!0});FlexGrid.prototype._setvalidateEdits=function(t){this._valEdt=e.asBoolean(t)};Object.defineProperty(FlexGrid.prototype,"groupHeaderFormat",{get:function(){return this._gHdrFmt},set:function(t){if(t!=this._gHdrFmt){this._gHdrFmt=e.asString(t);this._bindGrid(!1)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowDragging",{get:function(){return this._alDragging},set:function(i){if((i=e.asEnum(i,t.AllowDragging))!=this._alDragging){this._alDragging=i;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"ariaLabel",{get:function(){return this._ariaLabel},set:function(e){this._ariaLabel=e},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"itemsSource",{get:function(){return this._items},set:function(t){var i=this;if(t!=this._items){var o=new e.CancelEventArgs;if(this.onItemsSourceChanging(o)){if(this._cv){(n=this._cv).currentChanged.removeHandler(null,this);n.collectionChanged.removeHandler(null,this);n instanceof e.collections.CollectionView&&n.sortConverter==this._bndSortConverter&&(n.sortConverter=null);this._cv=null}this._items=t;this._cv=this._getCollectionView(t);this._lastCount=0;if(this._cv){var n;(n=this._cv).currentChanged.addHandler((function(e,t){return i._cvCurrentChanged(e,t)}),this);n.collectionChanged.addHandler((function(e,t){return i._cvCollectionChanged(e,t)}),this);if(n instanceof e.collections.CollectionView){t&&(n.trackChanges=Boolean(t.trackChanges));n.sortConverter||(n.sortConverter=this._bndSortConverter)}}this._isISChanging=!0;this._bindGrid(!0);this._isISChanging=!1;this.onItemsSourceChanged(o)}}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"editableCollectionView",{get:function(){return e.tryCast(this._cv,"IEditableCollectionView")},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(t){if(t!=this._childItemsPath){e.assert(null==t||e.isArray(t)||e.isString(t),"childItemsPath should be an array or a string.");this._childItemsPath=t;this._bindGrid(!0)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"rowHeaderPath",{get:function(){return this._rowHdrPath?this._rowHdrPath.path:null},set:function(t){if(t!=this.rowHeaderPath){t=e.asString(t);this._rowHdrPath=t?new e.Binding(t):null;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"cells",{get:function(){return this._gpCells},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnHeaders",{get:function(){return this._gpCHdr},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnFooters",{get:function(){return this._gpCFtr},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"rowHeaders",{get:function(){return this._gpRHdr},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"topLeftCells",{get:function(){return this._gpTL},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"bottomLeftCells",{get:function(){return this._gpBL},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0});FlexGrid.prototype.getColumn=function(e,t){if(this._hasColumnGroups()&&t){var i=this.getColumnGroups();return null!==i?i.getColumn(e):null}return this.columns.getColumn(e)};Object.defineProperty(FlexGrid.prototype,"frozenRows",{get:function(){return this.rows.frozen-this.rows.frozenDetailChildren},set:function(e){this.rows.frozen=e+this.rows.frozenDetailChildren},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"frozenColumns",{get:function(){return this.columns.frozen},set:function(e){this.columns.frozen=e},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"cloneFrozenCells",{get:function(){return this._fzClone},set:function(t){if(t!=this._fzClone){e.setText(this._fCt,null);this._fzClone=e.asBoolean(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"sortRowIndex",{get:function(){return this._sortRowIndex},set:function(t){if(t!=this._sortRowIndex){this._sortRowIndex=e.asNumber(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"editColumnIndex",{get:function(){return this._editColIndex},set:function(t){if(t!=this._editColIndex){this._editColIndex=e.asNumber(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"scrollPosition",{get:function(){return this._ptScrl.clone()},set:function(e){var t=this._root,i=-e.x;if(this.rightToLeft)switch(FlexGrid._getRtlMode()){case"rev":i=t.scrollWidth-t.clientWidth+e.x;break;case"neg":i=e.x;break;default:i=-e.x}t.scrollLeft=i;t.scrollTop=-e.y;this._updateScrollPosition()&&(this._forceScrollUpdate=!0)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"commitEmptyEdits",{get:function(){return this._commitEmptyEdits},set:function(t){if(t!=this._commitEmptyEdits){this._commitEmptyEdits=e.asBoolean(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"clientSize",{get:function(){return this._szClient},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"controlRect",{get:function(){this._rcBounds||(this._rcBounds=e.getElementRect(this._root));return this._rcBounds},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"scrollSize",{get:function(){return new e.Size(this._gpCells.width,this._heightBrowser)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"viewRange",{get:function(){return this._gpCells.viewRange},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"cellFactory",{get:function(){return this._cf},set:function(i){if(i!=this._cf){this._clearCells();this._cf=e.asType(i,t.CellFactory,!1)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){if(t!=this._itemFormatter){this._clearCells();this._itemFormatter=e.asFunction(t)}},enumerable:!0,configurable:!0});FlexGrid.prototype.canEditCell=function(e,t){return this._edtHdl._allowEdit(e,t)};FlexGrid.prototype.getCellData=function(e,t,i){return this.cells.getCellData(e,t,i)};FlexGrid.prototype.getCellBoundingRect=function(e,t,i){return this.cells.getCellBoundingRect(e,t,i)};FlexGrid.prototype.setCellData=function(e,t,i,o,n){void 0===o&&(o=!0);void 0===n&&(n=!0);return this.cells.setCellData(e,t,i,o,n)};FlexGrid.prototype.hitTest=function(i,o){e.isNumber(i)&&e.isNumber(o)&&(i=new e.Point(i,o));e.isBoolean(o)&&o&&(this._rcBounds=null);return new t.HitTestInfo(this,i)};FlexGrid.prototype.getClipString=function(t,i,o,n){var r;r=this.skipMerged?l.SkipMerged:null==i||e.isBoolean(i)?i?l.CSV:l.Default:i;e.assert(e.isNumber(r),"Unexpected value for ClipStringOptions parameter.");return this._edtHdl.getClipString(t,r,o,n)};FlexGrid.prototype.setClipString=function(e,t){this._edtHdl.setClipString(e,t)};FlexGrid.prototype.focus=function(e){this.isDisabled||this._setFocus(e)};FlexGrid.prototype.dispose=function(){this.finishEditing(!0);this.itemsSource=null;c.prototype.dispose.call(this)};FlexGrid.prototype.refresh=function(t){void 0===t&&(t=!0);c.prototype.refresh.call(this,t);this.finishEditing();if(t){this._updateColumnTypes();this.scrollPosition=this._ptScrl;this._updateDefaultSizes();clearTimeout(this._toInv);this._toInv=null}this.refreshCells(t);var i=this._e;i&&(this._szCtl=new e.Size(i.offsetWidth,i.offsetHeight))};FlexGrid.prototype.refreshCells=function(e,t,i){this.isUpdating||(e?this._updateLayout():this._updateContent(t,i))};FlexGrid.prototype.refreshRange=function(e){for(var i=e.topRow;i<=e.bottomRow;i++)for(var o=e.leftCol;o<=e.rightCol;o++){var n=this.cells.getCellElement(i,o);if(n){var r=n[t.GridPanel._INDEX_KEY];this.cellFactory.updateCell(this.cells,i,o,n,r.rng)}}};FlexGrid.prototype.autoSizeColumn=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=4);this.autoSizeColumns(e,e,t,i)};FlexGrid.prototype.autoSizeColumns=function(i,o,n,r){var l=this;void 0===n&&(n=!1);void 0===r&&(r=4);var s=0,a=n?this.topLeftCells:this.columnHeaders,c=n?this.bottomLeftCells:this.columnFooters,u=n?this.rowHeaders:this.cells,d=this.viewRange;i=null==i?0:e.asInt(i);o=null==o?u.columns.length-1:e.asInt(o);d.row=Math.max(0,d.row-1e3);d.row2=Math.min(d.row2+1e3,this.rows.length-1);this.finishEditing()&&this.columns.deferUpdate((function(){e.setCss(l._eCt,{width:l._gpCells.width});for(var n=e.createElement("<div "+FlexGrid._WJS_MEASURE+'="true"/>',u.hostElement,{visibility:"hidden"}),h=l._getCanvasContext(),f=i;f<=o&&f>-1&&f<u.columns.length;f++){var p=u.columns[f];if(p.isVisible){s=0;if(l.autoSizeMode&t.AutoSizeMode.Headers){for(var g=0;g<a.rows.length;g++)a.rows[g].isVisible&&(s=Math.max(l._getDesiredWidth(a,g,f,n),s));for(g=0;g<c.rows.length;g++)c.rows[g].isVisible&&(s=Math.max(l._getDesiredWidth(c,g,f,n),s))}if(l.autoSizeMode&t.AutoSizeMode.Cells&&d.row>-1&&d.row2>-1)if(p._getQuickAutoSize()){g=l._getWidestRow(u,d,f,h);s=Math.max(l._getDesiredWidth(u,g,f,n),s)}else for(g=d.row;g<=d.row2&&g<u.rows.length;g++)u.rows[g].isVisible&&(s=Math.max(l._getDesiredWidth(u,g,f,n),s));s>0&&(p.width=s+r+2)}}l.cellFactory.disposeCell(n);e.removeChild(n)}))};FlexGrid.prototype.autoSizeRow=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=0);this.autoSizeRows(e,e,t,i)};FlexGrid.prototype.autoSizeRows=function(i,o,n,r){var l=this;void 0===n&&(n=!1);void 0===r&&(r=0);var s=0,a=1==n?this.topLeftCells:null==n?this.bottomLeftCells:this.rowHeaders,c=1==n?this.columnHeaders:null==n?this.columnFooters:this.cells;r=e.asNumber(r);i=null==i?0:e.asInt(i);if((o=null==o?c.rows.length-1:e.asInt(o))>=i&&this.finishEditing()){e.setCss(this._eCt,{width:this._gpCells.width});var u=e.createElement("<div "+FlexGrid._WJS_MEASURE+'="true"/>',c.hostElement,{visibility:"hidden"});this.rows.deferUpdate((function(){for(var e={},n=l._autoSizeMode,d=t.AutoSizeMode,h=i;h<=o&&h>-1&&h<c.rows.length;h++){if(c.rows[h].isVisible){s=0;n&d.Headers&&(s=l._getDesiredRowHeight(a,h,u,e));n&d.Cells&&(s=Math.max(l._getDesiredRowHeight(c,h,u,e),s));s>0&&(c.rows[h].height=s+r)}}}));this.cellFactory.disposeCell(u);e.removeChild(u)}};Object.defineProperty(FlexGrid.prototype,"treeIndent",{get:function(){return this._indent},set:function(t){if(t!=this._indent){this._indent=e.asNumber(t,!1,!0);this.columns.onCollectionChanged()}},enumerable:!0,configurable:!0});FlexGrid.prototype.collapseGroupsToLevel=function(e){var i=this;this.finishEditing()&&this.deferUpdate((function(){var o=i.rows;o.deferUpdate((function(){for(var i=0;i<o.length;i++){var n=o[i];n instanceof t.GroupRow&&(n.isCollapsed=n.level>=e)}}))}))};Object.defineProperty(FlexGrid.prototype,"selectionMode",{get:function(){return this._selHdl.selectionMode},set:function(i){if((i=e.asEnum(i,t.SelectionMode))!=this.selectionMode){this._selHdl.selectionMode=i;this._updateTabIndex()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"selection",{get:function(){return this._selHdl.selection.clone()},set:function(e){this._selHdl.selection=e},enumerable:!0,configurable:!0});FlexGrid.prototype.select=function(e,i){void 0===i&&(i=!0);this.activePanelType=t.CellType.Cell;return this._selHdl.select(e,i)};FlexGrid.prototype.selectAll=function(){var e=this.rows.length,i=this.columns.length;return!(!e||!i)&&this.select(new t.CellRange(0,0,e-1,i-1),!1)};FlexGrid.prototype.getSelectedState=function(e,t){return this.cells.getSelectedState(e,t)};Object.defineProperty(FlexGrid.prototype,"selectedRows",{get:function(){var e=this,i=this.selectionMode,o=this.rows.filter((function(e){return e.isSelected}));if(0==o.length&&i!=t.SelectionMode.None){var n=[];this.selectedRanges.forEach((function(t){for(var i=t.topRow;i<=t.bottomRow&&i>-1&&i<e.rows.length;i++)n.indexOf(i)<0&&n.push(i)}));n.sort();o=n.map((function(t){return e.rows[t]}))}return o},set:function(i){var o=this;e.assert(this.selectionMode==t.SelectionMode.ListBox,"This property can be set only in ListBox mode.");i=e.asArray(i);this.deferUpdate((function(){for(var e=0,t=!0;e<o.rows.length;e++){var n=o.rows[e],r=i&&i.indexOf(n)>-1;if(r&&t){t=!1;o.select(e,o.selection.col)}n.isSelected=r}}))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"selectedItems",{get:function(){var e=[];this.selectedRows.forEach((function(t){var i=t?t.dataItem:null;i&&e.indexOf(i)<0&&e.push(i)}));return e},set:function(i){var o=this;e.assert(this.selectionMode==t.SelectionMode.ListBox,"This property can be set only in ListBox mode.");i=e.asArray(i);this.deferUpdate((function(){for(var e=0,t=!0;e<o.rows.length;e++){var n=o.rows[e],r=i&&i.indexOf(n.dataItem)>-1;if(r&&t){t=!1;o.select(e,o.selection.col)}n.isSelected=r}}))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"selectedRanges",{get:function(){var e=[this.selection];this._selHdl.extendedSelection.forEach((function(t){e.push(t)}));return e},set:function(i){if((i=e.asArray(i))&&i.length>0){this.select(i[0]);if(this.selectionMode==t.SelectionMode.MultiRange){var o=this._selHdl.extendedSelection;o.deferUpdate((function(){o.clear();for(var e=1;e<i.length;e++)o.push(i[e])}))}}},enumerable:!0,configurable:!0});FlexGrid.prototype.scrollIntoView=function(t,i,o){(null==this._maxOffsetY||this._rows._dirty||this._cols._dirty)&&this._updateLayout();var n=this.scrollPosition,r=this._szClient,l=r.width,s=r.height-this._gpCFtr.rows.getTotalSize(),a=this.cells._getFrozenPos();t=e.asInt(t);var c=this._rows[t];if(t>-1&&t<this._rows.length&&t>=this._rows.frozen){var u=this._getCssPage(c.pos);if(u!=this._cssPage){for(var d=this._maxOffsetY,h=Math.round(d*u);h>c.pos;u-=.1)h=Math.round(d*u);this._offsetY=h}var f=c.pos-this._offsetY,p=f+c.renderSize;p>s-n.y&&(n.y=Math.max(-f,s-p));f-a.y<-n.y&&(n.y=-(f-a.y));u!=this._cssPage&&(this._cssPage=this._getCssPage(-n.y))}e.isString(i)&&(i=this.columns.indexOf(i));if((i=e.asInt(i))>-1&&i<this._cols.length&&i>=this._cols.frozen){var g=this._cols[i],_=g.pos+g.renderSize;_>-n.x+l&&(n.x=Math.max(-g.pos,l-_));g.pos-a.x<-n.x&&(n.x=-(g.pos-a.x))}if(!n.equals(this._ptScrl)){n.x<this._ptScrl.x&&(0!==n.x?n.x-=1:this.rightToLeft&&(n.x+=1));0!==n.y&&n.y<this._ptScrl.y&&(n.y-=1);this.scrollPosition=n;if(o){this._updateScrollPosition();this._forceScrollUpdate=!1;this.refresh()}return!0}if(c&&this.hostElement.clientHeight>document.scrollingElement.clientHeight){var m=document.scrollingElement.scrollTop-a.y,w=m+document.scrollingElement.clientHeight,C=this.hostElement.offsetTop+this.cells.hostElement.offsetTop+c.pos,v=C+c.renderSize;this._stickyHdr&&(C-=this._eCHdr.offsetHeight);var y=void 0;C<m?y=m-(m-C)+a.y:v>w&&(y=m+(v-w)+a.y);void 0!==y&&document.scrollingElement.scrollTo({top:y})}if(this._activeCell&&t>-1&&i>-1){var b=this._root,R=b.scrollWidth==b.clientWidth,E=b.scrollHeight==b.clientHeight;if(R||E){var x=this._activeCell.getBoundingClientRect(),S=innerWidth,H=innerHeight,M=x.right<0||x.left>S,G=x.bottom<0||x.top>H;n.x=pageXOffset+(x.left<0?x.left:x.right>S?x.right-S:0);n.y=pageYOffset+(x.top<0?x.top:x.bottom>H?x.bottom-H:0);M&&R&&G&&E?scrollTo(n.x,n.y):M&&R?scrollTo(n.x,document.documentElement.scrollLeft):G&&E&&scrollTo(document.documentElement.scrollTop,n.y)}}return!1};FlexGrid.prototype.isRangeValid=function(e){return e&&e.isValid&&e.bottomRow<this.rows.length&&e.rightCol<this.columns.length};FlexGrid.prototype.startEditing=function(e,t,i,o,n){void 0===e&&(e=!0);return this._edtHdl.startEditing(e,t,i,o,n)};FlexGrid.prototype.finishEditing=function(e){return this._edtHdl.finishEditing(e)};Object.defineProperty(FlexGrid.prototype,"activeCell",{get:function(){return this._activeCell},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"activeEditor",{get:function(){var e=this._edtHdl;return e?e.activeEditor:null},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"editRange",{get:function(){var e=this._edtHdl.editRange;return e?e.clone():null},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"mergeManager",{get:function(){return this._mrgMgr},set:function(i){if(i!=this._mrgMgr){this._mrgMgr=e.asType(i,t.MergeManager,!0);this.invalidate()}},enumerable:!0,configurable:!0});FlexGrid.prototype.getMergedRange=function(e,t,i,o){void 0===o&&(o=!0);return this._mrgMgr?this._mrgMgr.getMergedRange(e,t,i,o):null};Object.defineProperty(FlexGrid.prototype,"keyActionTab",{get:function(){return this._keyHdl._kaTab},set:function(i){this._keyHdl._kaTab=e.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"keyActionEnter",{get:function(){return this._keyHdl._kaEnter},set:function(i){this._keyHdl._kaEnter=e.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"preserveWhiteSpace",{get:function(){return e.hasClass(this.hostElement,FlexGrid._WJS_WSPRE)},set:function(t){e.toggleClass(this.hostElement,FlexGrid._WJS_WSPRE,e.asBoolean(t))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showDropDown",{get:function(){return this._shDropDown},set:function(t){if(t!=this._shDropDown){this._shDropDown=e.asBoolean(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});FlexGrid.prototype.toggleDropDownList=function(){if(!this._tglDropDown){this._tglDropDown=!0;this._edtHdl._toggleListBox(null);this._tglDropDown=!1}return null!=this._edtHdl._lbx};Object.defineProperty(FlexGrid,"defaultTypeWidth",{get:function(){return FlexGrid._defTypeWidth},enumerable:!0,configurable:!0});FlexGrid.prototype.onItemsSourceChanging=function(e){this.itemsSourceChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)};FlexGrid.prototype.onScrollPositionChanged=function(e){this.scrollPositionChanged.raise(this,e)};FlexGrid.prototype.onSelectionChanging=function(e){this.selectionChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onSelectionChanged=function(e){this.selectionChanged.raise(this,e)};FlexGrid.prototype.onLoadingRows=function(e){this.loadingRows.raise(this,e);return!e.cancel};FlexGrid.prototype.onLoadedRows=function(e){this.loadedRows.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onUpdatingLayout=function(e){this.updatingLayout.raise(this,e);return!e.cancel};FlexGrid.prototype.onUpdatedLayout=function(e){this.updatedLayout.raise(this,e)};FlexGrid.prototype.onResizingColumn=function(e){this.resizingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onResizedColumn=function(e){this.resizedColumn.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onAutoSizingColumn=function(e){this.autoSizingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onAutoSizedColumn=function(e){this.autoSizedColumn.raise(this,e)};FlexGrid.prototype.onStarSizedColumns=function(e){this.starSizedColumns.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onDraggingColumn=function(e){this.draggingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggingColumnOver=function(e){this.draggingColumnOver.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggedColumn=function(e){this.draggedColumn.raise(this,e)};FlexGrid.prototype.onPinningColumn=function(e){this.pinningColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onPinnedColumn=function(e){this.pinnedColumn.raise(this,e)};FlexGrid.prototype.onResizingRow=function(e){this.resizingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onResizedRow=function(e){this.resizedRow.raise(this,e)};FlexGrid.prototype.onAutoSizingRow=function(e){this.autoSizingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onAutoSizedRow=function(e){this.autoSizedRow.raise(this,e)};FlexGrid.prototype.onDraggingRow=function(e){this.draggingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggingRowOver=function(e){this.draggingRowOver.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggedRow=function(e){this.draggedRow.raise(this,e)};FlexGrid.prototype.onGroupCollapsedChanging=function(e){this.groupCollapsedChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onGroupCollapsedChanged=function(e){this.groupCollapsedChanged.raise(this,e)};FlexGrid.prototype.onColumnGroupCollapsedChanging=function(e){this.columnGroupCollapsedChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onColumnGroupCollapsedChanged=function(e){this.columnGroupCollapsedChanged.raise(this,e)};FlexGrid.prototype.onSortingColumn=function(e){this.sortingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onSortedColumn=function(e){this.sortedColumn.raise(this,e)};FlexGrid.prototype.onBeginningEdit=function(e){this._addHdl._beginningEdit(this,e);e.cancel||this.beginningEdit.raise(this,e);return!e.cancel};FlexGrid.prototype.onPrepareCellForEdit=function(e){this.prepareCellForEdit.raise(this,e)};FlexGrid.prototype.onCellEditEnding=function(e){this.cellEditEnding.raise(this,e);return!e.cancel&&!e.stayInEditMode};FlexGrid.prototype.onCellEditEnded=function(e){this.cellEditEnded.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onRowEditStarting=function(e){this._addHdl._rowEditStarting(this,e);e.cancel||this.rowEditStarting.raise(this,e);return!e.cancel};FlexGrid.prototype.onRowEditStarted=function(e){this.rowEditStarted.raise(this,e)};FlexGrid.prototype.onRowEditEnding=function(e){this._addHdl._rowEditEnding(this,e);this.rowEditEnding.raise(this,e)};FlexGrid.prototype.onRowEditEnded=function(e){this.rowEditEnded.raise(this,e);this._addHdl._rowEditEnded(this,e);this._autoRowHeights()};FlexGrid.prototype.onRowAdded=function(e){this.rowAdded.raise(this,e);return!e.cancel};FlexGrid.prototype.onDeletingRow=function(e){this.deletingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onDeletedRow=function(e){this.deletedRow.raise(this,e)};FlexGrid.prototype.onCopying=function(e){this.copying.raise(this,e);return!e.cancel};FlexGrid.prototype.onCopied=function(e){this.copied.raise(this,e)};FlexGrid.prototype.onPasting=function(e){this.pasting.raise(this,e);return!e.cancel};FlexGrid.prototype.onPasted=function(e){this.pasted.raise(this,e)};FlexGrid.prototype.onPastingCell=function(e){this.pastingCell.raise(this,e);return!e.cancel};FlexGrid.prototype.onPastedCell=function(e){this.pastedCell.raise(this,e)};FlexGrid.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)};FlexGrid.prototype.onUpdatingView=function(e){this.updatingView.raise(this,e);return!e.cancel};FlexGrid.prototype.onUpdatedView=function(e){this.updatedView.raise(this,e)};FlexGrid.prototype._createSelHdl=function(){return new t._SelectionHandler(this)};FlexGrid.prototype._getTabIndex=function(){return this._orgTabIndex};FlexGrid.prototype._setTabOrder=function(e){this._orgTabIndex=e;this._updateTabIndex()};FlexGrid.prototype._updateTabIndex=function(){var e=this.isDisabled?-1:this._orgTabIndex,i=this._imeHdl;i&&i._updateImeFocus();var o=this._activeCell,n=this._root,r=this._eFocus;if(o){o.tabIndex=e;r.tabIndex=-1;n.tabIndex=-1}else if(this.selectionMode!=t.SelectionMode.None){r.tabIndex=e;n.tabIndex=-1}else{n.tabIndex=e;r.tabIndex=-1}};FlexGrid.prototype._autoRowHeights=function(){var t=this;if(this._autoHeights){this.rows.length>100&&[this.columnHeaders,this.rowHeaders].forEach((function(e){e._updateContent(!0,!1,e._getOffsetY())}));clearTimeout(this._toAutoHeights);this._toAutoHeights=setTimeout((function(){t._toAutoHeights=null;t.editRange||t._autoSizeRows()}),e.Control._REFRESH_INTERVAL)}};FlexGrid.prototype._autoSizeRows=function(){var e=this.autoSizeMode,i=t.AutoSizeMode;if(e&i.Headers){this._autoSizeMode=i.Both;this.autoSizeRows(0,this.columnHeaders.rows.length-1,!0);this._autoSizeMode=e}e&i.Cells&&this.autoSizeRows()};FlexGrid.prototype._getShowErrors=function(){return this.showErrors&&this._hasValidation};FlexGrid.prototype._getHasValidation=function(){return this._hasValidation};FlexGrid.prototype._getError=function(t,i,o,n){if(e.isFunction(this.itemValidator)){if(t==this.cells)return this.itemValidator(i,o,n);if(t==this.rowHeaders){var r=t.rows,l=this.columns,s=r[i].dataItem,a=null,c=[],u=i;if(_=this.getMergedRange(t,i,o,!1)){for(i=u=_.row;i<r.length&&(r[i].dataItem==s||_&&_.rowSpan>1&&_.row2>=i);i++)for(var d=0;d<l.length;d++)if(a=this.itemValidator(i,d,!1)){(w=this.getMergedRange(this.cells,i,d))&&(w.columnSpan>1&&w.col<d||w.rowSpan>1&&w.row<i)||c.push(a)}}else for(d=0;d<this.columns.length;d++){var h=this.itemValidator(i,d,!1);h&&c.push(h)}if(c.length){var f=!!(C=this.errorTip)&&C.isContentHtml;a=c.join(f?"<br/>":"\n")}return a}}var p=this._cv,g=p?p.getError:null;if(e.isFunction(g)){r=t.rows,l=this.columns;if((s=r[i].dataItem)&&!(s instanceof e.collections.CollectionViewGroup))if(t==this.cells)for(;i<r.length&&r[i].dataItem==s;i++){return g(s,(m=this._getBindingColumn(this.cells,i,l[o])).binding,n)}else if(t==this.rowHeaders){if(!(a=g(s,null,!1))){var _;c=[],u=i;(_=this.getMergedRange(t,i,o,!1))&&(u=_.row);for(i=u;i<r.length&&(r[i].dataItem==s||_&&_.rowSpan>1&&_.row2>=i);i++)for(d=0;d<l.length;d++){var m=this._getBindingColumn(this.cells,i,l[d]);if(a=g(r[i].dataItem,m.binding,!1)){var w;(w=this.getMergedRange(this.cells,i,d))&&(w.columnSpan>1&&w.col<d||w.rowSpan>1&&w.row<i)||c.push(a)}}if(c.length){var C;f=!!(C=this.errorTip)&&C.isContentHtml;a=c.join(f?"<br/>":"\n")}}return a}}return null};FlexGrid.prototype._setAria=function(t,i){e.setAttribute(this.cells.hostElement,"aria-"+t,i)};FlexGrid.prototype._setFocus=function(i){if(this.hostElement){var o=e.getActiveElement(),n=this.activeEditor,r=this._activeCell,l=this._eFocus,s=this._root,a=this._getTabIndex(),c=this.containsFocus();if(!i&&c&&this.selectionMode!=t.SelectionMode.None){if(this.rows.length>0&&this.selection.row>=0&&this.selection.col>=0){var u=this._getBindingColumn(this.cells,this.selection.row,this.columns[this.selection.col]),d=u&&u._edt;!r||e.contains(r,o)||this.imeEnabled||d||this._correctFocusOfActiveCell(r)}}else if(i||!c){if(n){if(!e.contains(n,o)){n.focus();l.tabIndex=-1;s.tabIndex=-1}}else if(r)e.contains(r,o)||this._correctFocusOfActiveCell(r);else if(!e.contains(l,o)&&o!=s)if(this.selectionMode!=t.SelectionMode.None){l.tabIndex=a;this._setFocusNoScroll(l)}else{s.tabIndex=a;this._setFocusNoScroll(s)}if(!this.containsFocus())if(this.selectionMode!=t.SelectionMode.None){l.tabIndex=a;this._setFocusNoScroll(l)}else{s.tabIndex=a;this._setFocusNoScroll(s)}}}};FlexGrid.prototype._correctFocusOfActiveCell=function(i){var o=this._getTabIndex();if(e.getActiveElement()!=this._root){e.isIE()&&e.hasClass(i,"wj-group")&&(i=i.querySelector("."+t.CellFactory._WJC_COLLAPSE)||i);i.tabIndex=o;this._setFocusNoScroll(i)}else i.tabIndex=o;this._eFocus.tabIndex=-1};FlexGrid.prototype._setFocusNoScroll=function(t){if(e.getActiveElement()!=t){if(e.supportsFocusOptions())t.focus({preventScroll:!0});else{var i=this.scrollPosition,o=t.style,n=o.position;o.position="fixed";t.focus();o.position=n;this.scrollPosition=i}this._fixScroll()}};FlexGrid.prototype._clearAnchorCell=function(){this._anchorCell=null};FlexGrid.prototype._setAnchorCell=function(t,i){var o=this.getMergedRange(this.cells,t,i);this._anchorCell=o?new e.Point(o.col,o.row):new e.Point(i,t)};FlexGrid.prototype._getAnchorCell=function(){return this._anchorCell};FlexGrid.prototype._updateDefaultSizes=function(){var e=this._getDefaultRowHeight();this._rows._setDefaultSize(e);this._cols._setDefaultSize(4*e);this._hdrRows._setDefaultSize(e);this._hdrCols._setDefaultSize(Math.round(1.25*e));this._ftrRows._setDefaultSize(e);return e};FlexGrid.prototype._getDefaultRowHeight=function(){var t=this.hostElement,i=this._eFocus,o=null;if(!i.offsetHeight){o=e.createElement('<div><div class="wj-cell">0</div></div>',document.body);t&&o.setAttribute("class",t.getAttribute("class"));i=o.children[0]}var n=i.offsetHeight;(isNaN(n)||n<=6)&&(n=28);e.removeChild(o);return n};FlexGrid.prototype._getCollectionView=function(t){return e.asCollectionView(t)};FlexGrid.prototype._getCanvasContext=function(){var e=document.createElement("canvas").getContext("2d"),t=getComputedStyle(this.hostElement);e.font=t.fontSize+" "+t.fontFamily.split(",")[0];return e};FlexGrid.prototype._getWidestRow=function(t,i,o,n){for(var r=0,l=0,s=1===this._getRowsPerItem()&&t.columns[o].dataType==e.DataType.Boolean,a=i.row;a<=i.row2;a++)if(t.rows[a].isVisible){var c=t.getCellData(a,o,!0),u=n.measureText(c).width,d=this.getMergedRange(t,a,o,!1);d&&d.columnSpan>1&&(u/=d.columnSpan);if(u>l){l=u;r=a}if(s)break;a+=d?d.rowSpan-1:0}return r};FlexGrid.prototype._getDesiredWidth=function(e,t,i,o){var n=this.getMergedRange(e,t,i,!1),r=o.style;this.cellFactory.updateCell(e,t,i,o,n);r.width=r.top=r.left="";return o.offsetWidth/(n&&n.columnSpan>1?n.columnSpan:1)};FlexGrid.prototype._getDesiredHeight=function(e,t,i,o){var n=o.style,r=this.getMergedRange(e,t,i,!1),l=r?r.rowSpan:1;this.cellFactory.updateCell(e,t,i,o,r);o.innerHTML.trim()||(o.innerHTML="&nbsp;");n.height=n.top=n.left="";return o.offsetHeight/l};FlexGrid.prototype._getDesiredRowHeight=function(e,t,i,o){for(var n=0,r=(e.rows[t],this._getQuickAutoSize()),l=0;l<e.columns.length;l++){if(e.columns[l].isVisible){var s=this.getMergedRange(e,t,l,!1),a=void 0;if(r){var c={ct:e.cellType,col:l,spr:s&&s.rowSpan>1?s.rowSpan:1,spc:s&&s.columnSpan>1?s.columnSpan:1,data:e.getCellData(t,l,!0)||"1"},u=JSON.stringify(c);if(null==(a=o[u])){a=this._getDesiredHeight(e,t,l,i);o[u]=a}}else a=this._getDesiredHeight(e,t,l,i);n=Math.max(a,n);l+=s?s.columnSpan-1:0}}return n};FlexGrid.prototype._getSortRowIndex=function(){return null!=this._sortRowIndex?this._sortRowIndex:this.columnHeaders.rows.length-1};FlexGrid.prototype._getDeleteColumnIndex=function(){return 0};FlexGrid.prototype._getEditColumnIndex=function(){return null!=this._editColIndex?this._editColIndex:this.rowHeaders.columns.length-1};FlexGrid.prototype._sortConverter=function(e,t,i,o){var n,r=this;if(o){this._mappedColumns=null;this._cv&&this._cv.sortDescriptions.forEach((function(e){if((n=r.getColumn(e.property))&&n.dataMap){r._mappedColumns||(r._mappedColumns={});r._mappedColumns[n.binding]=n.dataMap}}));if(this._mouseHdl._htDown&&this._mouseHdl._htDown.col>-1){n=this.columns[this._mouseHdl._htDown.col];this._mappedColumns&&n.dataMap&&(this._mappedColumns[n.binding]=n.dataMap)}}if(this._mappedColumns){var l=this._mappedColumns[e.property];l&&l.sortByDisplayValues&&(i=l.getDisplayValue(i))}return i};FlexGrid.prototype._bindGrid=function(i){var o=this;this.finishEditing();this.deferUpdate((function(){o.autoGenerateColumns&&0==o._lastCount&&e.hasItems(o._cv)&&(i=!0);var n;o.preserveSelectedState&&(n=o._getMap())&&o.rows.forEach((function(e){e.isSelected&&e.dataItem&&n.set(e.dataItem,!0)}));var r,l=o._getMap();l&&o.rows.forEach((function(e){e.isReadOnly&&e.dataItem&&l.set(e.dataItem,!0)}));if(o.preserveOutlineState&&o.rows.maxGroupLevel>-1&&(r=o._getMap()))for(var s=0;s<o.rows.length;s++){var a=o.rows[s];if(a instanceof t.GroupRow&&a.isCollapsed&&a.dataItem){var c=a.dataItem;c instanceof e.collections.CollectionViewGroup&&(c=c._path);r.set(c,!0)}}i&&o.columns.deferUpdate((function(){o._bindColumns()}));var u=new e.CancelEventArgs;if(o.onLoadingRows(u)){o.rows.deferUpdate((function(){o._bindRows()}));o.onLoadedRows(u)}o._selHdl.extendedSelection.clear();var d=0;n&&n.size&&o.rows.forEach((function(e){var t=e.dataItem;if(t&&n.has(t)){e.isSelected=!0;d++}}));l&&l.size&&o.rows.forEach((function(e){var t=e.dataItem;t&&l.has(t)&&(e.isReadOnly=!0)}));if(0==d&&o.selectionMode==t.SelectionMode.ListBox){var h=o.selection;for(s=h.topRow;s<=h.bottomRow&&s>-1&&s<o.rows.length;s++)o.rows[s]._setFlag(t.RowColFlags.Selected,!0,!0)}r&&r.size&&o.rows.deferUpdate((function(){o.rows.forEach((function(i){if(i instanceof t.GroupRow){var o=i.dataItem;o instanceof e.collections.CollectionViewGroup&&(o=o._path);r.has(o)&&(i.isCollapsed=!0)}}))}));if(!o._lastCount){var f=o._cv;f&&f.items&&(o._lastCount=f.items.length)}}));if(this._cv){var n=i&&!this._toInv;this._syncSelection(n)}else{var r=this.selection,l=new t.CellRange(-1,r.col,-1,r.col2);this._selHdl._adjustSelection(l,this.selectionMode)}};FlexGrid.prototype._getMap=function(){return window.Map?new Map:null};FlexGrid.prototype._cvCollectionChanged=function(i,o){if(this.autoGenerateColumns&&0==this.columns.length)this._bindGrid(!0);else{var n=e.collections.NotifyCollectionChangedAction;if(this.childItemsPath&&o.action!=n.Change)this._bindGrid(!1);else{switch(o.action){case n.Change:this.invalidate();return;case n.Add:if(o.index==this._cv.items.length-1){var r=this.rows.length;this.rows[r-1]instanceof t._NewRowTemplate&&r--;this.rows.insert(r,new t.Row(o.item));return}e.assert(!1,"added item should be the last one.");break;case n.Remove:var l=this._findRow(o.item);if(l>-1){this.rows.removeAt(l);this._syncSelection(!1);return}e.assert(!1,"removed item not found on grid.")}this._bindGrid(!1)}}};FlexGrid.prototype._cvCurrentChanged=function(e,t){this._syncSelection(!1)};FlexGrid.prototype._syncSelection=function(i){if(this._cv&&this.selectionMode!=t.SelectionMode.None){var o=this._selHdl,n=o.selection,r=n.row>-1&&n.row<this.rows.length?this.rows[n.row]:null,l=r?r.dataItem:null,s=this._cv;if(s instanceof e.collections.CollectionView&&s.isUpdating)return;if(this.newRowAtTop&&r instanceof t._NewRowTemplate)return;l instanceof e.collections.CollectionViewGroup&&(l=null);var a=this._isISChanging;if(i||l!=s.currentItem||n.row>=this.rows.length||n.row2>=this.rows.length||a&&n.row!==n.row2){var c=this.editableCollectionView;if(!this.childItemsPath||!c||!c.currentAddItem){var u=this._getRowIndex(s.currentPosition);if(u!=n.row||!this.childItemsPath){var d=a?n.col:n.col2;n=new t.CellRange(u,n.col,u,d);o._adjustSelection(n,this.selectionMode);this.selectionMode&&!this._updating&&this.scrollIntoView(n.row,-1)}}}}};FlexGrid.prototype._getRowIndex=function(e){if(this._cv){var i=this.rows;if(e>-1){for(var o=this._cv.items[e];e<i.length;e++)if(i[e].dataItem===o)return e;return-1}if(1==i.length&&i[0]instanceof t._NewRowTemplate)return 0;var n=this.selection.row,r=n>-1?i[n]:null;return r&&(r instanceof t.GroupRow||null==r.dataItem)?n:-1}return this.selection.row};FlexGrid.prototype._getCvIndex=function(e){return e>-1&&e<this.rows.length?this.rows[e].dataIndex:-1};FlexGrid.prototype._findRow=function(e){for(var t=0;t<this.rows.length;t++)if(this.rows[t].dataItem==e)return t;return-1};FlexGrid.prototype._preWidth=function(){var e=this._root,t=this._hdrVis&r.Row?this._hdrCols.getTotalSize():0;return e.clientWidth-t};FlexGrid.prototype._updateLayout=function(){var t=this,i=new e.CancelEventArgs;if(this.onUpdatingLayout(i)){var o=this._hdrVis&r.Row?this._hdrCols.getTotalSize():0,n=this._hdrVis&r.Column?this._hdrRows.getTotalSize():0,l=this._ftrRows.getTotalSize(),s=this._rows.getTotalSize()+l;s<1&&(s=1);this._heightReal=s;this._heightBrowser=Math.min(s,FlexGrid._getMaxSupportedCssHeight());this._maxOffsetY=Math.max(0,s-this._heightBrowser);var a=getComputedStyle(this._eFocus);this._cellPadVert=parseInt(a.paddingTop)+parseInt(a.paddingBottom);this._cellPadHorz=parseInt(a.paddingLeft)+parseInt(a.paddingRight);this._cellPadLeft=parseInt(this.rightToLeft?a.paddingRight:a.paddingLeft);var c=this._heightBrowser+n-l,u=this._gpCells.width,d=this._heightBrowser;!u&&this.rows.length&&(u=.1);!d&&this.columns.length&&(d=.1);if(this.rightToLeft){e.setCss(this._eTL,{right:0,top:0,width:o,height:n});e.setCss(this._eCHdr,{right:o,top:0,height:n});e.setCss(this._eRHdr,{right:0,top:n,width:o});e.setCss(this._eCt,{right:o,top:n,width:u,height:d});e.setCss(this._fCt,{right:o,top:n});e.setCss(this._eBL,{right:0,top:c,width:o,height:l});e.setCss(this._eCFtr,{right:o,top:c,height:l})}else{e.setCss(this._eTL,{left:0,top:0,width:o,height:n});e.setCss(this._eCHdr,{left:o,top:0,height:n});e.setCss(this._eRHdr,{left:0,top:n,width:o});e.setCss(this._eCt,{left:o,top:n,width:u,height:d});e.setCss(this._fCt,{left:o,top:n});e.setCss(this._eBL,{left:0,top:c,width:o,height:l});e.setCss(this._eCFtr,{left:o,top:c,height:l})}this._stickyHdr&&this._updateStickyHeaders();var h=this.rows.frozen||this.columns.frozen;e.setCss([this._eTL,this._eBL,this._eCFtr,this._eRHdr],{zIndex:h?"4":"3"});e.setCss(this._eCHdr,{zIndex:h?"5":"3"});e.setCss(this._eMarquee,{zIndex:h?"3":"1"});this._eCHdr.closest(".wj-cell")&&e.setCss(this._eCHdr,{zIndex:h?"4":"2"});e.isIE()&&(this._fCt.style.zIndex=h?"3":"");var f=this._root,p=f.offsetWidth-f.clientWidth,g=f.offsetHeight-f.clientHeight;e.setCss(this._eSz,{width:o+p+this._gpCells.width,height:n+g+this._heightBrowser});var _=null;if(this.columns._updateStarSizes(f.clientWidth-o)){_=f.clientWidth;e.setCss(this._eCt,{width:this._gpCells.width});this.onStarSizedColumns()}this._szClient=new e.Size(f.clientWidth-o,f.clientHeight-n);this._szClientSB=new e.Size(f.offsetWidth-o,f.offsetHeight-n);this._rcBounds=null;this._updateScrollHandler();this._updateContent(!1);p=f.offsetWidth-f.clientWidth;g=f.offsetHeight-f.clientHeight;e.setCss(this._eSz,{width:o+p+this._gpCells.width,height:n+g+this._heightBrowser});this._szClient=new e.Size(f.clientWidth-o,f.clientHeight-n);if(_&&_!=f.clientWidth&&this.columns._updateStarSizes(f.clientWidth-o)){e.setCss(this._eCt,{width:this._gpCells.width});this._updateContent(!1)}e.setCss([this._eCHdr,this._eCFtr,this._fCt],{width:this._szClient.width});e.setCss([this._eRHdr,this._fCt],{height:this._szClient.height});if(l){c=Math.min(c,this._szClient.height+n-l);e.setCss([this._eBL,this._eCFtr],{top:c})}window.addEventListener("load",(function(){e.setCss(t._root,{"overflow-y":t._root.scrollHeight===t._root.parentElement.clientHeight?"hidden":"auto","overflow-x":t._root.scrollWidth===t._root.parentElement.clientWidth?"hidden":"auto"})}));this.onUpdatedLayout(i)}};FlexGrid.prototype._updateStickyHeaders=function(){var t=!1,i=0;if(this._stickyHdr){for(var o=0,n=null,r=this.hostElement;r;r=r.parentElement)if("inline"!=getComputedStyle(r).display){var l=r.getBoundingClientRect();null==n&&(n=l.top);o=Math.max(o,l.top)}i=-(n=Math.max(0,o-n-1));t=n>0;this._rcBounds=null}this._eTL.style.top=this._eCHdr.style.top=t?-i+"px":"";e.toggleClass(this._eTL,FlexGrid._WJS_STICKY,t);e.toggleClass(this._eCHdr,FlexGrid._WJS_STICKY,t)};FlexGrid.prototype._updateScrollHandler=function(){this._clipToScreen=this._getClipToScreen();var e=this._stickyHdr||this._clipToScreen;if(e!=this._scrollHandlerAttached){this._scrollHandlerAttached=e;e?this.addEventListener(window,"scroll",this._scroll.bind(this),!0):this.removeEventListener(window,"scroll")}};FlexGrid.prototype._getClipToScreen=function(){if(this.rows.length<=FlexGrid._MIN_VIRT_ROWS)return!1;if(this._root.scrollHeight>this._root.clientHeight)return!1;for(var e=this.hostElement;e&&e!=document.documentElement;e=e.parentElement){if("auto"==getComputedStyle(e).overflow)return!1}return!0};FlexGrid.prototype._scroll=function(t){var i=this;if(e.contains(t.target,this.hostElement)){if(this._clipToScreen){this._afClip&&cancelAnimationFrame(this._afClip);this._afClip=requestAnimationFrame((function(){i._afClip=null;i.finishEditing();i._updateContent(!0)}))}if(this._stickyHdr){this._afSticky&&cancelAnimationFrame(this._afSticky);this._afSticky=requestAnimationFrame((function(){i._afSticky=null;var t=new e.CancelEventArgs;if(i.onUpdatingLayout(t)){i._updateStickyHeaders();i.onUpdatedLayout(t)}}))}}};FlexGrid.prototype._getCssPage=function(t){if(this._heightReal>this._heightBrowser){var i=this._szClient.height-this._gpCFtr.rows.getTotalSize();if(this._heightBrowser>i)return e.clamp(Math.round(t/(this._heightBrowser-i)*10)/10,0,1)}return 0};FlexGrid.prototype._updateScrollPosition=function(){var t=this._root,i=t.scrollTop,o=t.scrollLeft;this.rightToLeft&&"rev"==FlexGrid._getRtlMode()&&(o=t.scrollWidth-t.clientWidth-o);var n=new e.Point(-Math.abs(o),-i);if(!this._ptScrl.equals(n)){this._ptScrl=n;this._updateMarquee();this.onScrollPositionChanged();return!0}return!1};FlexGrid.prototype._updateContent=function(i,o){var n=this,l=this._root,a=this.hostElement,c=this.cells.hostElement,u=this._activeCell,d=e.getActiveElement(),h=e.contains(a,d),f=e.closest(d,".wj-flexgrid")==a?d:null,p=new e.CancelEventArgs;if(this.onUpdatingView(p)){if([s.All,s.Column].includes(this.headersFocusability)){e.setAttribute(this.hostElement,"role",this.rows.maxGroupLevel<0?"grid":"treegrid");e.setAttribute(this.hostElement,"aria-label",this.ariaLabel)}else{e.setAttribute(c,"role",this.rows.maxGroupLevel<0?"grid":"treegrid");e.setAttribute(c,"aria-label",this.ariaLabel)}this._hasValidation=e.isFunction(this._itemValidator)||this._cv&&e.isFunction(this._cv.getError);var g=!o&&this._errorTip&&this._errorTip._tips.length,_=this._getCssPage(-this._ptScrl.y);if(_!=this._cssPage){this._cssPage=_;this._offsetY=Math.round(this._maxOffsetY*_)}this._updateScrollPosition();this._updateMarquee();var m=this._gpCells._updateContent(i,o,this._offsetY),w=this._hdrVis;if(w&r.Column&&(!o||this._ssHdr&w)){this._gpCHdr._updateContent(i,o,0);this.rightToLeft||(this._eCHdr.scrollLeft=0)}if(w&r.Row&&(!o||this._ssHdr&w)){this._gpRHdr._updateContent(i,o,this._offsetY);this._eRHdr.scrollTop=0}w&&!o&&this._gpTL._updateContent(i,o,0);if(this._gpCFtr.rows.length){this._gpBL._updateContent(i,o,0);this._gpCFtr._updateContent(i,o,0)}if(g&&this._errorTip&&this._errorTip._tips.length){clearTimeout(this._toErrorTips);this._toErrorTips=setTimeout((function(){var t=n._errorTip;if(t){t.hide();for(var i=t._tips,o=0;o<i.length;o++){var r=i[o].element;if(!r.offsetHeight||!e.hasClass(r,"wj-state-invalid")){t.setTooltip(r,null);o--}}}}),250)}if(this._useFrozenDiv()){this._updateFrozenCells(o);m&&e.hasClass(m,"wj-frozen")&&(m=null)}this._fCt.style.display=this._fCt.childElementCount?"":"none";this._activeCell=m;if(f)if(f!=l&&f!=this._eFocus&&e.contains(a,f)&&!e.contains(c,f)){e.getActiveElement()!==f&&f.focus();if(e.isIE()&&f instanceof HTMLInputElement&&!f.type.match(/checkbox|radio|range/i)){var C=f.selectionStart,v=f.selectionEnd;f.setSelectionRange(C,v)}}else{var y=m!==u;this._setFocus(y)}!f&&m&&(m.tabIndex=this.isDisabled?-1:this._orgTabIndex);u&&u!=m&&(u.tabIndex=-1);if(this.selectionMode!=t.SelectionMode.None)this._eFocus.tabIndex=null!=m||this.isDisabled?-1:this._orgTabIndex;else{this._eFocus.tabIndex=-1;this._root.tabIndex=null!=m||this.isDisabled?-1:this._orgTabIndex}h&&this.focus();this._fixScroll();this._rcBounds=null;this._updateMarquee();this.onUpdatedView(p)}};FlexGrid.prototype._fixScroll=function(){var e=this._root;if(!this._updating){var i=this.hostElement,o=e?e.parentElement:null,n=this.rightToLeft;if(i){i.scrollTop&&(i.scrollTop=0);i.scrollLeft&&!n&&(i.scrollLeft=0)}if(o){o.scrollTop&&(o.scrollTop=0);o.scrollLeft&&!n&&(o.scrollLeft=0)}}var r=t._getSafariVer();if(e&&r&&14==r.major&&r.minor>=1){e.style.transform="";e.style.transform="translateZ(0)"}};FlexGrid.prototype._clearCells=function(){for(var e in this)if("_"==e[0]){var i=this[e];i instanceof t.GridPanel&&i._clearCells()}this.invalidate()};FlexGrid.prototype._useFrozenDiv=function(){return e.isBoolean(this._fzClone)?this._fzClone:e.isIE()||e.isFirefox()||e.isSafari()||e.isMobile()};FlexGrid.prototype._updateFrozenCells=function(i){var o=this._fCt;if(this.rows.frozen||this.columns.frozen){var n=this._eCt.querySelectorAll(".wj-frozen");if(i&&o.children.length==n.length){for(var r=0;r<n.length;r++)o.children[r].className=n[r].className;return}e.setText(o,null);if(!this.activeEditor){var l=this._errorTip,s=navigator.userAgent.indexOf("MSIE")>=0;for(r=0;r<n.length;r++){var a=n[r];if(e.closest(a,".wj-flexgrid")==this.hostElement){var c=a[t.GridPanel._INDEX_KEY],u=a.firstElementChild,d=null;if(c&&u){var h=c.panel,f=this._getBindingColumn(h,c.row,h.columns[c.col]);d=e.isFunction(f.cellTemplate)?u.onclick:null}if(s){var p="input[type=checkbox]",g=a.querySelector(p);a=a.cloneNode(!0);if(g){a.querySelector(p).checked=g.checked}}else a=a.cloneNode(!0);u=a.firstElementChild;d&&u&&(u.onclick=d);a[t.GridPanel._INDEX_KEY]=c;if(l){var _=l.getTooltip(n[r]);_&&l.setTooltip(a,_)}o.appendChild(a)}}}}else e.setText(o,null)};FlexGrid.prototype._updateMarquee=function(){var t=this._eMarquee,i=this._getMarqueeRect();if(i&&i.width&&i.height){var o=this.cells.hostElement,n=t.firstChild,r=t.offsetWidth-n.offsetWidth,l=t.offsetHeight-n.offsetHeight;e.setCss(t,{width:i.width+r,height:i.height+l,top:i.top+o.offsetTop-l/2,left:i.left+o.offsetLeft-r/2,display:""})}else t.style.display="none"};FlexGrid.prototype._hideMarquee=function(){var t=this._eMarquee;e.setCss(t,{display:"none"})};FlexGrid.prototype._getMarqueeRect=function(){if(!this._shMarquee||!this.selectionMode)return null;var t=this._selHdl.selection;if(!this.isRangeValid(t))return null;t=(t=(t=this.cells._getAdjustedSelection(t)).combine(this.getMergedRange(this.cells,t.topRow,t.leftCol,!1))).combine(this.getMergedRange(this.cells,t.bottomRow,t.rightCol,!1));var i=this.cells.getCellBoundingRect(t.topRow,t.leftCol,!0),o=this.cells.getCellBoundingRect(t.bottomRow,t.rightCol,!0);if(this.rows.frozen){var n=Math.min(this.rows.length,this.rows.frozen),r=this.cells.getCellBoundingRect(n-1,0,!0);t.topRow>=n&&i.top<r.bottom&&(i.top=r.bottom);t.bottomRow>=n&&o.bottom<r.bottom&&(o.height=r.bottom-o.top)}if(this.columns.frozen){var l=Math.min(this.columns.length,this.columns.frozen);r=this.cells.getCellBoundingRect(0,l-1,!0);if(this.rightToLeft){t.leftCol>=l&&i.right>r.left&&(i.left=r.left-i.width);t.rightCol>=l&&o.left>r.left&&(o.left=r.left)}else{t.leftCol>=l&&i.left<r.right&&(i.left=r.right);t.rightCol>=l&&o.right<r.right&&(o.width=r.right-o.left)}}return this.rightToLeft?new e.Rect(o.left,i.top,i.right-o.left,o.bottom-i.top):new e.Rect(i.left,i.top,o.right-i.left,o.bottom-i.top)};FlexGrid.prototype._bindColumns=function(){for(var i=this.columns,o=0;o<i.length;o++){if(i[o]._getFlag(t.RowColFlags.AutoGenerated)){i.removeAt(o);o--}}var n=this._cv,r=n?n.items:null;r&&r.length&&this.autoGenerateColumns&&this._getColumnTypes(r).forEach((function(o){var n=new t.Column(o);n._setFlag(t.RowColFlags.AutoGenerated,!0);n.name=n.binding;n.header=e.toHeaderCase(n.binding);var r=FlexGrid._defTypeWidth[n.dataType];if(null!=r){if(e.isString(r)){var l=Math.round(parseFloat(r));r=r.indexOf("*")>-1?l*i.defaultSize:l}e.isNumber(r)&&r>0&&(n.width=r)}i.push(n)}));this._updateColumnTypes()};FlexGrid.prototype._getColumnTypes=function(t){return e.getTypes(t)};FlexGrid.prototype._updateColumnTypes=function(){var t=this._cv;if(e.hasItems(t)){var i=t.items[0];this.columns.forEach((function(t){null==t.dataType&&t._binding&&(t.dataType=e.getType(t._binding.getValue(i)))}))}};FlexGrid.prototype._getMapEditor=function(e,i){return i.editor?null!=i.editor.isDroppedDown?i.dataMapEditor:null:!e.dataMap||e instanceof t.GroupRow?i.dataMap?i.dataMapEditor:null:e.dataMapEditor};FlexGrid.prototype._getBindingColumn=function(e,t,i){return i};FlexGrid.prototype._getBindingColumns=function(){return this.columns};FlexGrid.prototype._getRowsPerItem=function(){return 1};FlexGrid.prototype._isTransposed=function(){return!1};FlexGrid.prototype._getRowHeaderPath=function(){return this._rowHdrPath};FlexGrid.prototype._bindRows=function(){this.rows.clear();var e=this._cv;if(e&&e.items){var t=e.items,i=e.groups;if(this.childItemsPath)for(var o=0;o<t.length;o++)this._addNode(t,o,0);else if(null!=i&&i.length>0&&this.showGroups)for(o=0;o<i.length;o++)this._addGroup(i[o]);else for(o=0;o<t.length;o++)this._addBoundRow(t,o)}};FlexGrid.prototype._addBoundRow=function(e,i){var o=new t.Row(e[i]),n=this.rows;o._list=n;n[n.length++]=o};FlexGrid.prototype._addGroupRow=function(e){this.rows.push(new t.GroupRow(e))};FlexGrid.prototype._addNode=function(i,o,n){var r=i[o],l=this.childItemsPath,s=r[e.isArray(l)?l[n]:l],a=new t.GroupRow(r);a.level=n;this.rows.push(a);if(e.isArray(s))for(var c=0;c<s.length;c++)this._addNode(s,c,n+1)};FlexGrid.prototype._addGroup=function(e){this._addGroupRow(e);if(e.isBottomLevel)for(var t=e.items,i=0;i<t.length;i++)this._addBoundRow(t,i);else for(i=0;i<e.groups.length;i++)this._addGroup(e.groups[i])};FlexGrid._getSerializableProperties=function(e){var t=[];for(e=e.prototype;e!=Object.prototype;e=Object.getPrototypeOf(e))for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++){var n=i[o],r=Object.getOwnPropertyDescriptor(e,n);r&&r.set&&r.get&&"_"!=n[0]&&!n.match(/^(disabled|required|showDropDown)$/)&&t.push(n)}return t};FlexGrid.prototype._hasColumnGroups=function(){return this._grpHdl.hasColumnGroups()};FlexGrid.prototype._getColumnGroup=function(e,t){return this._grpHdl.getColumnGroup(e,t)};FlexGrid.prototype._canMoveColumnGroup=function(e,t,i,o){return this._grpHdl.canMoveColumnGroup(e,t,i,o)};FlexGrid.prototype._moveColumnGroup=function(e,t,i,o,n){return this._grpHdl.moveColumnGroup(e,t,i,o,n)};FlexGrid.prototype._copy=function(i,o){var n=this;if("columns"==i){var r=e.asArray(o);if(r.some((function(e){return null!=e.columns})))this.columnGroups=r;else{this.columns.clear();r.forEach((function(e){var i=new t.Column(e);n.columns.push(i)}))}return!0}return!1};FlexGrid.prototype._isInputElement=function(t){return t instanceof HTMLElement&&!e.hasClass(t,"wj-btn-glyph")&&("true"==t.contentEditable||null!=t.tagName.match(/^(INPUT|TEXTAREA|BUTTON|A|SELECT|OPTION)$/i))};FlexGrid.prototype._isNativeCheckbox=function(i){return i instanceof HTMLInputElement&&"checkbox"==i.type&&!i.disabled&&!i.readOnly&&e.hasClass(i,t.CellFactory._WJC_CHECKBOX)&&e.closest(i,".wj-flexgrid")==this.hostElement};FlexGrid.prototype._wantsInput=function(t){return this._isInputElement(t)&&!this.activeEditor&&!this._isNativeCheckbox(t)&&!e.hasClass(t,"wj-grid-ime")&&e.contains(document.body,t)};FlexGrid._getMaxSupportedCssHeight=function(){if(!FlexGrid._maxCssHeight){var t=265e5;e.isIE()?t=15e5:e.isFirefox()&&(t=175e5);FlexGrid._maxCssHeight=t}return FlexGrid._maxCssHeight};FlexGrid._getRtlMode=function(){if(!FlexGrid._rtlMode){var t=e.createElement('<div dir="rtl"><div></div></div>');e.setCss(t,{visibility:"hidden",width:100,height:100,overflow:"auto"});e.setCss(t.firstChild,{width:2e3,height:2e3});document.body.appendChild(t);var i=t.scrollLeft;t.scrollLeft=-1e3;var o=t.scrollLeft;e.removeChild(t);FlexGrid._rtlMode=o<0?"neg":i>0?"rev":"std"}return FlexGrid._rtlMode};FlexGrid.prototype.getEmptyRequiredCell=function(e){return this._getEmptyRequiredCell(e)};FlexGrid.prototype._getEmptyRequiredCell=function(e){if(e>=0)for(var t=0;t<this.columns.length;t++){var i=this.getCellData(e,t,!1);if(this.columns[t].getIsRequired(this.rows[e])&&(""===i||null==i)){if(!this.columns[t].isReadOnly)return t;console.warn("Incorrect data. Column "+t+" is  at the same time  required, empty and read-only")}}return null};FlexGrid.prototype.adjustFrozenRowColSize=function(e,t,i){var o=t===a.Column,n=o?this.columns:this.rows,r=o?this.columns.frozen:this.rows.frozen,l=o?this._szClient.width:this._szClient.height;if(!(e<0||e>=n.length||e>=r)){for(var s=0,c=0;c<r;c++)c!==e&&(s+=n[c].size||n[c].renderSize);var u=l-s-5,d=(n[e].size||n[e].renderSize)+i;d>u&&(d=u);n[e].size=d}};FlexGrid._WJS_STICKY="wj-state-sticky";FlexGrid._WJS_MEASURE="wj-state-measuring";FlexGrid._WJS_UPDATING="wj-state-updating";FlexGrid._WJS_WSPRE="wj-whitespace-pre";FlexGrid._MIN_VIRT_ROWS=200;FlexGrid._defTypeWidth=((i={})[e.DataType.Number]="0.714285714*",i);FlexGrid.controlTemplate='<div>  <div wj-part="ch"><div wj-part="chcells" class="wj-colheaders"></div></div><div wj-part="root"><div wj-part="cells" class="wj-cells"></div><div wj-part="marquee" class="wj-marquee"><div></div></div></div><div wj-part="fcells" aria-hidden="true" class="wj-cells wj-frozen-clone"></div><div wj-part="rh"><div wj-part="rhcells" class="wj-rowheaders"></div></div><div wj-part="cf"><div wj-part="cfcells" class="wj-colfooters"></div></div><div wj-part="bl"><div wj-part="blcells" class="wj-bottomleft"></div></div><div wj-part="tl"><div wj-part="tlcells" class="wj-topleft"></div></div><div wj-part="focus" class="wj-cell">0</div><div wj-part="sz"></div></div>';return FlexGrid}(e.Control);t.FlexGrid=c}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function _ImeHandler(t){var i=this;this._updateImeFocusAsyncBnd=this._updateImeFocusAsync.bind(this);this._cmpstartBnd=this._compositionstart.bind(this);this._keypressBnd=this._keypress.bind(this);this._g=t;var o=e.createElement('<textarea class="wj-grid-editor wj-form-control wj-grid-ime" aria-hidden="true"/>');e.setCss(o,_ImeHandler._cssHidden);e.disableAutoComplete(o);o.tabIndex=-1;this._tbx=o;this._maskProvider=new e._MaskProvider(o);t._root.appendChild(o);this._updateImeFocus();var n=t.hostElement,r=t.addEventListener.bind(t),l=this._updateImeFocusAsyncBnd;r(n,"blur",l,!0);r(n,"focus",l,!0);r(o,"compositionstart",this._cmpstartBnd);e.isiOS()&&r(n,"keypress",this._keypressBnd);t.selectionChanged.addHandler(l,this);t.cellEditEnded.addHandler(this._cellEditEnded,this);t.cellEditEnding.addHandler(this._cellEditEnding,this);r(n,"mousedown",(function(i){e.closest(e.getActiveElement(),".wj-flexgrid")==t.hostElement&&t.hitTest(i).panel==t.cells&&e.hasClass(t.hitTest(i).target,"wj-cell")&&(t.isReadOnly||i.preventDefault())}));t.gotFocus.addHandler((function(){return i._updateImeFocus()}))}_ImeHandler.prototype.dispose=function(){var t=this._g,i=t.hostElement,o=this._tbx,n=t.removeEventListener.bind(t),r=this._updateImeFocusAsyncBnd;n(i,"blur",r);n(i,"focus",r);n(i,"keypress",this._keypressBnd);n(o,"compositionstart",this._cmpstartBnd);t.selectionChanged.removeHandler(r);t.cellEditEnded.removeHandler(this._cellEditEnded);t.cellEditEnding.removeHandler(this._cellEditEnding);e.removeChild(o)};_ImeHandler.prototype._compositionstart=function(t){var i=this,o=this._g;if(!o.activeEditor){var n=o._selHdl.selection;if(o.startEditing(!1,n.row,n.col,!1,t)){if(o.activeEditor&&"checkbox"!=o.activeEditor.type){n=o.editRange;var r=o._getBindingColumn(o.cells,n.row,o.columns[n.col]),l=r&&r._edt,s=o.activeEditor,a=this._tbx,c=o.cells.hostElement,u=o.columns[n.col].pos+c.offsetLeft,d=o.rows[n.row].pos+c.offsetTop,h=o.getCellBoundingRect(n.row,n.col),f=o.cells.getCellElement(n.row,n.col);h.width=f.offsetWidth;h.height=f.offsetHeight;n.row<o.rows.frozen&&(d+=o._root.scrollTop);n.col<o.columns.frozen&&(u+=o._root.scrollLeft);var p=f.querySelector(".wj-btn.wj-right");p&&(h.width-=p.offsetWidth);"minLength,maxLength,pattern".split(",").forEach((function(t){e.setAttribute(a,t,s.getAttribute(t))}));var g=s instanceof HTMLTextAreaElement;e.setAttribute(a,"wrap",g?"soft":"off");var _=getComputedStyle(f),m=_.paddingTop;if(n.rowSpan>1&&!g){var w=parseFloat(_.lineHeight);isNaN(w)&&(w=1.2*parseFloat(_.fontSize));m=Math.max(0,(h.height-w)/2)+"px"}var C={position:"absolute",left:u,top:d,width:h.width-1,height:h.height-1,paddingTop:m,paddingLeft:_.paddingLeft,paddingRight:_.paddingRight,textAlign:_.textAlign,zIndex:f.style.zIndex};if(o.rightToLeft){C.right=parseInt(f.style.right)+parseInt(o.cells.hostElement.style.right);C.left=""}e.setCss(a,C);if(l){var v=l._tbx.getBoundingClientRect(),y=a.getBoundingClientRect(),b=window.getComputedStyle(a),R=parseFloat(b.left),E=parseFloat(b.right),x=parseFloat(b.top);o.rightToLeft?e.setCss(a,{right:E+y.right-v.right+"px",top:x+v.top-y.top+"px",width:v.width+"px",height:v.height+"px"}):e.setCss(a,{left:R+v.left-y.left+"px",top:x+v.top-y.top+"px",width:v.width+"px",height:v.height+"px"})}o._edtHdl._edt=a;a.select();var S=s.value;if(e.isSafari()){"　"!=a.value&&" "!=a.value||(a.value=S);e.setSelectionRange(a,a.value.length)}else setTimeout((function(){"　"!=a.value&&" "!=a.value||(a.value=S);e.setSelectionRange(a,a.value.length)}),20);e.Control.sharedState.InvalidScroll=e.isEdge();a.placeholder=s.placeholder;s.placeholder="";s.value=""}}else{this._tbx.blur();setTimeout((function(){i._tbx.focus();o._setFocusNoScroll(o.hostElement)}),20)}}};_ImeHandler.prototype._cellEditEnding=function(){var e=this._maskProvider;e&&e.mask&&e._valueChanged()};_ImeHandler.prototype._cellEditEnded=function(){var t=this._tbx,i=this._g;if(this._enableIme()){var o=e.getActiveElement();o.blur();if(i._isScrollingByWheel)setTimeout((function(){o.focus();i._setFocusNoScroll(i.hostElement);t.value="";o.focus()}),20);else{o.focus();i._setFocusNoScroll(i.hostElement);o.focus()}}t.value="";e.setCss(t,_ImeHandler._cssHidden);this._updateImeFocus()};_ImeHandler.prototype._keypress=function(e){if(!e.defaultPrevented&&e.target==this._tbx&&!(e.ctrlKey||e.altKey||e.metaKey||27==e.keyCode||this._g.activeEditor)){this._tbx.value="";this._compositionstart(e);e.stopPropagation()}};_ImeHandler.prototype._updateImeFocus=function(){var t=this._g,i=this._tbx,o=e.getActiveElement(),n=t._getTabIndex();if(t.activeEditor||e.closest(o,".wj-flexgrid")!=t.hostElement)(t.isDisabled||n<0)&&i.tabIndex>=0&&(i.tabIndex=-1);else if(this._enableIme()&&!t._wantsInput(o)){if(o!=i){t.activeCell&&(t.activeCell.tabIndex=-1);i.tabIndex=n;i.disabled=!1;i.value="";if(!t.isTouching)if(window&&window.top!=window.self){e.setSelectionRange(i,0,0,!1);t._setFocusNoScroll(i)}else{e.setSelectionRange(i,0);i.focus()}}var r=t._selHdl.selection,l=r.isValid?t._getBindingColumn(t.cells,r.row,t.columns[r.col]):null;this._maskProvider.mask=l?l.mask:null}else{i.tabIndex=-1;i.disabled=!0;i.value="";if(o==i){i.blur();var s=t.activeCell;if(s){s.tabIndex=n;s.focus()}else t.focus()}}};_ImeHandler.prototype._updateImeFocusAsync=function(){var e=this;this._toFocus&&clearTimeout(this._toFocus);this._toFocus=setTimeout((function(){e._toFocus=null;e._updateImeFocus()}),100)};_ImeHandler.prototype._resetTabIndex=function(){this._tbx.tabIndex=-1};_ImeHandler.prototype._enableIme=function(){var i=this._g,o=i._selHdl.selection;if(!i.canEditCell(o.row,o.col))return!1;var n=o.isValid?i._getBindingColumn(i.cells,o.row,i.columns[o.col]):null;return!(!n||n.dataType==e.DataType.Boolean)&&(!n||!n.dataMap||n.dataMapEditor!=t.DataMapEditor.RadioButtons)};_ImeHandler._cssHidden={position:"fixed",width:"1px",left:-32e3,top:-32e3,overflow:"hidden"};return _ImeHandler}();t._ImeHandler=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function _AddNewHandler(e){this._nrt=new o;this._top=!1;this._keydownBnd=this._keydown.bind(this);this._committing=!1;this._pasting=!1;this._g=e;this._attach()}Object.defineProperty(_AddNewHandler.prototype,"newRowAtTop",{get:function(){return this._top},set:function(i){if(i!=this.newRowAtTop){this._top=e.asBoolean(i);this.updateNewRowTemplate();var o=this._g;if(this._top&&o.selectionMode==t.SelectionMode.ListBox){o.rows.forEach((function(e,i){e._setFlag(t.RowColFlags.Selected,0==i,!0)}));o.select(0,o.selection.col)}}},enumerable:!0,configurable:!0});_AddNewHandler.prototype.updateNewRowTemplate=function(){var e=this._g,i=e.editableCollectionView,o=e.rows,n=this._nrt,r=i&&i.canAddNew&&e.allowAddNew&&!e.isReadOnly,l=o.indexOf(n),s=this._top?0:o.length-1,a=!1;if(!r&&l>-1){var c=e.selection;c.row==l&&e.select(c.row-1,c.col);o.removeAt(l)}else if(r){if(l<0)a=!0;else if(l!=s){o.removeAt(l);a=!0}a&&(this._top?o.insert(0,n):o.push(n));if(n){n._ubv=null;n._setFlag(t.RowColFlags.ParentCollapsed,!1);this._top&&e.selectionMode==t.SelectionMode.ListBox||n._setFlag(t.RowColFlags.Selected,!1)}}};_AddNewHandler.prototype._attach=function(){var e=this._g;if(e){e.pasting.addHandler(this._pastingData,this);e.pasted.addHandler(this._pastedData,this);e.loadedRows.addHandler(this.updateNewRowTemplate,this);e.hostElement.addEventListener("keydown",this._keydownBnd,!0)}};_AddNewHandler.prototype._detach=function(){var e=this._g;if(e){e.pasting.removeHandler(this._pastingData,this);e.pasted.removeHandler(this._pastedData,this);e.loadedRows.removeHandler(this.updateNewRowTemplate);e.hostElement.removeEventListener("keydown",this._keydownBnd,!0)}};_AddNewHandler.prototype._keydown=function(t){if(!t.defaultPrevented&&t.keyCode==e.Key.Escape&&null==this._g.activeEditor&&this._top&&this._nrt.dataItem){this._nrt.dataItem=null;this._g.invalidate()}};_AddNewHandler.prototype._beginningEdit=function(e,t){if(!t.cancel){var i=e.rows[t.row];i instanceof o&&this._handleEditStarting(e,t,i)}};_AddNewHandler.prototype._pastingData=function(e,t){t.cancel||(this._pasting=!0)};_AddNewHandler.prototype._pastedData=function(e,t){this._pasting=!1};_AddNewHandler.prototype._rowEditStarting=function(e,t){if(this._pasting){var i=e.rows[t.row];i instanceof o&&this._handleEditStarting(e,t,i)}};_AddNewHandler.prototype._rowEditEnding=function(e,t){var i=e.editableCollectionView,o=this._nrt.dataItem;if(i&&this._top&&o&&!t.cancel){var n=i.currentAddItem;if(!(n&&n==o)){n=i.addNew();for(var r in o)n[r]=o[r]}}};_AddNewHandler.prototype._rowEditEnded=function(e,t){var i=this,n=e.editableCollectionView;if(n&&!this._committing)if(this._top){if(t.cancel)return;var r=this._nrt.dataItem;if(r){this._committing=!0;this._nrt.dataItem=null;var l=this._g.rows,s=n.items.indexOf(r)+1;s<l.length&&t._rng.setRange(s,-1);e.onRowAdded(t)?n.commitNew():n.cancelNew();this._committing=!1}var a=e.rows[t.row];setTimeout((function(){a instanceof o&&e.select(0,e.columns.firstVisibleIndex);i.updateNewRowTemplate()}),20)}else n.isAddingNew&&n.commitNew()};_AddNewHandler.prototype._handleEditStarting=function(t,i,o){var n=t.editableCollectionView;if(n&&n.canAddNew)if(this._top)if(null==this._nrt.dataItem){var r=null,l=n.sourceCollection,s=n.newItemCreator;r=e.isFunction(s)?s():l&&l.length?new l[0].constructor:{};this._nrt.dataItem=r}else n.currentAddItem&&(t.onRowAdded(i)||n.cancelNew());else{r=n.currentAddItem&&n.currentAddItem==o.dataItem?n.currentAddItem:n.addNew();n.moveCurrentTo(r);var a=this._nrt.isSelected;this.updateNewRowTemplate();a&&i.row>-1&&(t.rows[i.row].isSelected=!0);t.isUpdating||t.refresh(!0);t.onRowAdded(i)||n.cancelNew()}};return _AddNewHandler}();t._AddNewHandler=i;var o=function(e){__extends(_NewRowTemplate,e);function _NewRowTemplate(){return null!==e&&e.apply(this,arguments)||this}return _NewRowTemplate}(t.Row);t._NewRowTemplate=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None";e[e.Cells=1]="Cells";e[e.ColumnHeaders=2]="ColumnHeaders";e[e.RowHeaders=4]="RowHeaders";e[e.AllHeaders=6]="AllHeaders";e[e.All=7]="All"}(i=t.AllowMerging||(t.AllowMerging={}));var o=function(){function MergeManager(e){null!=e&&console.error('** WARNING: the "grid" parameter has been deprecated. Please remove it.')}MergeManager.prototype.getMergedRange=function(o,n,r,l){void 0===l&&(l=!0);var s=o.grid,a=o.cellType,c=o.columns,u=o.rows,d=u[n],h=c[r];if(d instanceof t._NewRowTemplate)return null;if(!(d instanceof t.Row&&h instanceof t.Column))return null;if(o==s.columnHeaders){var f=s._getColumnGroup(n,r);if(f){var p=f._rng,g=o.columns;if(g.isFrozen(p.col)!=g.isFrozen(p.col2)){p=p.clone();g.isFrozen(r)?p.col2=g.frozen-1:p.col=g.frozen}return p}}if(s.showGroups&&!s.childItemsPath&&d instanceof t.GroupRow&&d.dataItem instanceof e.collections.CollectionViewGroup&&a==t.CellType.Cell){p=new t.CellRange(n,r);if(h.aggregate==e.Aggregate.None){for(;p.col>0&&c[p.col-1].aggregate==e.Aggregate.None&&p.col!=c.frozen;)p.col--;for(;p.col2<c.length-1&&c[p.col2+1].aggregate==e.Aggregate.None&&p.col2+1!=c.frozen;)p.col2++}for(;p.col<r&&!c[p.col].visible;)p.col++;return p.isSingleCell?null:p}var _=!1,m=i,w=t.CellType;switch(s.allowMerging){case m.None:_=!0;break;case m.Cells:_=a!=w.Cell;break;case m.ColumnHeaders:_=a!=w.ColumnHeader&&a!=w.TopLeft;break;case m.RowHeaders:_=a!=w.RowHeader&&a!=w.TopLeft;break;case m.AllHeaders:_=a==w.Cell}if(_)return null;if(a==w.Cell){var C=s.editableCollectionView,v=C?C.currentAddItem:null;if(v&&d.dataItem==v)return null}if(c[r].allowMerging){p=new t.CellRange(n,r);var y=o._vrb,b=0,R=u.length-1;if(n>=u.frozen){if(l&&(a==t.CellType.Cell||a==t.CellType.RowHeader)&&s._vtRows<u.length&&y){b=y.topRow;R=y.bottomRow}}else u.length>u.frozen&&(R=u.frozen-1);for(var E=n-1;E>=b&&this._mergeCell(o,E,r,n,r);E--)p.row=E;for(var x=n+1;x<=R&&this._mergeCell(o,n,r,x,r);x++)p.row2=x;for(;p.row<n&&!u[p.row].visible;)p.row++;if(!p.isSingleCell)return p}if(u[n].allowMerging){p=new t.CellRange(n,r),y=o._vrb;var S=0,H=c.length-1;if(r>=c.frozen){if(l&&(a==t.CellType.Cell||a==t.CellType.ColumnHeader)&&s._vtCols<c.length&&y){S=y.leftCol;H=y.rightCol}}else H=c.frozen-1;for(var M=r-1;M>=S&&this._mergeCell(o,n,M,n,r);M--)p.col=M;for(var G=r+1;G<=H&&this._mergeCell(o,n,r,n,G);G++)p.col2=G;for(;p.col<r&&!c[p.col].visible;)p.col++;if(!p.isSingleCell)return p}return null};MergeManager.prototype._mergeCell=function(e,i,o,n,r){var l=e.rows[i],s=e.rows[n];if(!l||!s)return!1;if(l instanceof t.GroupRow||l instanceof t._NewRowTemplate||s instanceof t.GroupRow||s instanceof t._NewRowTemplate)return!1;var a=e.grid.editableCollectionView,c=a?a.currentAddItem:null;if(c&&(l.dataItem==c||s.dataItem==c))return!1;if(i!=n&&e.rows.isFrozen(i)!=e.rows.isFrozen(n))return!1;if(o!=r&&e.columns.isFrozen(o)!=e.columns.isFrozen(r))return!1;if(i!=n){if(o>0&&(l.allowMerging&&this._mergeCell(e,i,o-1,i,o)||s.allowMerging&&this._mergeCell(e,n,o-1,n,o)))return!1;if(r<e.columns.length-1&&(l.allowMerging&&this._mergeCell(e,i,r,i,r+1)||s.allowMerging&&this._mergeCell(e,n,r,n,r+1)))return!1}return e.getCellData(i,o,!0)==e.getCellData(n,r,!0)};return MergeManager}();t.MergeManager=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function HitTestInfo(i,o){this._row=-1;this._col=-1;this._edge=0;this._clickChildGrid=!1;var n;if(o instanceof Element){if(e.closest(o,".wj-flexgrid")!=i.hostElement)return;i=o;this._target=o}if(!(i instanceof Element)||i instanceof t.FlexGrid){if(i instanceof t.FlexGrid){this._target=i.hostElement;n=this._g=i}else{if(!(i instanceof t.GridPanel))throw"First parameter should be a FlexGrid or GridPanel.";this._target=i.hostElement;this._p=i;n=this._g=this._p.grid}if(o instanceof MouseEvent){this._target=o.target;var r=e.closest(this._target,".wj-flexgrid");"mousedown"==o.type&&null!=r&&i instanceof t.FlexGrid&&r!=i.hostElement&&(this._clickChildGrid=!0);"mousedown"==o.type&&(n._rcBounds=null)}o=e.mouseToPage(o);this._pt=o.clone();var l=n.controlRect,s=n._szClient,a=n.topLeftCells,c=n._eTL,u=n.headersVisibility,d=t.HeadersVisibility,h=u&d.Row?a.columns.getTotalSize():0,f=u&d.Column?a.rows.getTotalSize():0,p=u&d.Column?f+c.offsetTop:0,g=n._eBL,_=g.offsetHeight,m=getComputedStyle(n.hostElement),w=m&&m.borderLeftWidth?parseFloat(m.borderLeftWidth):0,C=m&&m.borderTopWidth?parseFloat(m.borderTopWidth):0;o.x-=l.left-w;o.y-=l.top-C;n.rightToLeft&&(o.x=l.width-o.x);this._p||o.x>=0&&o.y>=c.offsetTop&&s&&o.x<=s.width+h&&o.y<=s.height+f&&(o.y<p?this._p=o.x<h?n.topLeftCells:n.columnHeaders:o.y<g.offsetTop?this._p=o.x<h?n.rowHeaders:n.cells:this._p=o.x<h?n.bottomLeftCells:n.columnFooters);if(null!=this._p){var v=this._p.rows,y=this._p.columns,b=this._p.cellType,R=t.CellType,E=this._p._getFrozenPos(),x=b==R.TopLeft||b==R.ColumnHeader?f:b==R.BottomLeft||b==R.ColumnFooter?_:v.getTotalSize(),S=b==R.TopLeft||b==R.BottomLeft||b==R.RowHeader?h:y.getTotalSize();if(b==R.RowHeader||b==R.Cell){o.y-=f;if(o.y>E.y||E.y<=0){o.y-=n._ptScrl.y;o.y+=this._p._getOffsetY()}}else b!=R.BottomLeft&&b!=R.ColumnFooter||(o.y-=g.offsetTop);if(b==R.ColumnHeader||b==R.Cell||b==R.ColumnFooter){o.x-=h;(o.x>E.x||E.x<=0)&&(o.x-=n._ptScrl.x)}b!=R.ColumnHeader&&b!=R.TopLeft||(o.y-=p-f);this._edge=0;var H=HitTestInfo._SZEDGE[this._g.isTouching?1:0];if(this._g.isTouching){H=HitTestInfo._SZEDGE[1];o.x-=H/2}this._row=o.y>x?-1:v.getItemAt(o.y);this._col=o.x>S?-1:y.getItemAt(o.x);if(this._row<0||this._col<0){this._p=null;return}if(this._col>-1){var M=y[this._col];o.x-M.pos<=H&&(this._edge|=1);var G=M.pos+M.renderSize-o.x;if(G<=H){this._edge|=4;G<=H/2&&(this._edge|=16)}}if(this._row>-1){var T=v[this._row];o.y-T.pos<=H&&(this._edge|=2);var P=T.pos+T.renderSize-o.y;if(P<=H){this._edge|=8;P<=H/2&&(this._edge|=32)}}}}else{var F=e.closest(i,".wj-cell"),z=F?F[t.GridPanel._INDEX_KEY]:null;if(z){this._target=i;this._row=z.row;this._col=z.col;this._rng=z.rng;this._p=z.panel;this._g=z.panel.grid}}}Object.defineProperty(HitTestInfo.prototype,"point",{get:function(){return this._pt},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"cellType",{get:function(){return this._p?this._p.cellType:t.CellType.None},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"grid",{get:function(){return this._p?this._p.grid:null},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});HitTestInfo.prototype.getRow=function(){return this._p&&this._row>-1?this._p.rows[this._row]:null};Object.defineProperty(HitTestInfo.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0});HitTestInfo.prototype.getColumn=function(e){var i=this._p,o=i&&this._col>-1?i.columns[this._col]:null;if(o&&e){var n=i.grid;o=i.cellType===t.CellType.ColumnHeader&&n._hasColumnGroups()?n._getColumnGroup(this._row,this._col):n._getBindingColumn(i,this._row,o)}return o};Object.defineProperty(HitTestInfo.prototype,"range",{get:function(){this._rng||(this._rng=new t.CellRange(this._row,this._col));return this._rng},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeLeft",{get:function(){return 0!=(1&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeTop",{get:function(){return 0!=(2&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeRight",{get:function(){return 0!=(4&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeFarRight",{get:function(){return 0!=(16&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeBottom",{get:function(){return 0!=(8&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeFarBottom",{get:function(){return 0!=(32&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0});HitTestInfo._SZEDGE=[6,30];return HitTestInfo}();t.HitTestInfo=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.softInput=function softInput(){return e._getModule("wijmo.input")}}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function CellFactory(){}CellFactory.prototype.updateCell=function(i,o,n,r,l,s){var a=i.grid,c=a.rightToLeft,u=i.rows,d=i.columns,h=u[o],f=d[n],p=o,g=n,_=h instanceof t.GroupRow?h:null,m=h instanceof t._NewRowTemplate?h:null,w=f.renderWidth,C=h.renderHeight,v=i.cellType,y="wj-cell",b="",R={display:""},E=t.CellType;0!=s&&r.firstElementChild&&(1==r.childNodes.length&&"checkbox"==r.firstElementChild.type||(r.textContent=""));if(l&&!l.isSingleCell){o=l.row;n=l.col;p=l.row2;g=l.col2;h=u[o];f=d[n];_=h instanceof t.GroupRow?h:null;C=(D=l.getRenderSize(i)).height;w=D.width}var x,S,H,M,G,T,P=a._getBindingColumn(i,o,f),F=P?P.dataType:h?h.dataType:void 0;H=v==E.RowHeader||v==E.Cell&&(!_||a.childItemsPath);T=P&&P.isContentHtml||h&&h.isContentHtml;x=P.dataMap||h.dataMap,S=v==E.Cell?a._getMapEditor(h,P):null;M=H&&S==t.DataMapEditor.RadioButtons;G=F==e.DataType.Boolean&&!x;var z=f.pos,I=h.pos,A=a._ptScrl;if(a._useFrozenDiv()&&v==E.Cell&&!a.editRange)n<d.frozen&&p>=u.frozen?I+=A.y:o<u.frozen&&g>=d.frozen&&(z+=A.x);else{var D=a._szClient;if(p<u.frozen){I=Math.min(I,D.height);C=Math.min(C,Math.max(0,D.height-I));I-=A.y}if(g<d.frozen){var j=0!=D.width?D.width:a._preWidth();z=Math.min(z,j);w=Math.min(w,Math.max(0,j-z));z-=A.x}}c?R.right=z+"px":R.left=z+"px";p>=u.frozen&&(I-=i._getOffsetY());R.top=I+"px";R.width=w+"px";R.height=C+"px";R.zIndex=0;n<d.frozen&&(R.zIndex+=1);o<u.frozen&&(R.zIndex+=2);var O=!1,L=a.alternatingRowStep;if(L&&(!l||l.row==l.row2)){O=h.visibleIndex%(L+1)==0;1==L&&(O=!O)}if(v==E.Cell){_&&(y+=" wj-group");O&&(y+=" wj-alt");(o<u.frozen||n<d.frozen)&&(y+=" wj-frozen");m&&(y+=" wj-new");h&&h.cssClass&&(y+=" "+h.cssClass);P&&P.cssClass&&(y+=" "+P.cssClass)}else{y+=" wj-header";O&&(y+=" wj-header-alt");h&&h.cssClass&&v==E.ColumnHeader&&(y+=" "+h.cssClass);P&&P.cssClass&&v==E.RowHeader&&(y+=" "+P.cssClass);var N=!1;v!=E.ColumnHeader&&v!=E.TopLeft||a.allowResizing&t.AllowResizing.Columns&&(N=null!=a._mouseHdl._getResizeCol(i,g));N||v!=E.RowHeader||a.allowResizing&t.AllowResizing.Rows&&(N=null!=a._mouseHdl._getResizeRow(i,p));N&&(y+=" wj-big-header")}h&&h.cssClassAll&&(y+=" "+h.cssClassAll);P&&P.cssClassAll&&(y+=" "+P.cssClassAll);var k=t.SelectedState,B=i.getSelectedState(o,n,l);B!=k.None&&v==E.Cell&&!G&&a.editRange&&a.editRange.contains(o,n)&&(B=k.None);switch(B){case k.Active:y+=" wj-state-active";break;case k.Cursor:y+=" wj-state-selected wj-state-active";break;case k.Selected:y+=" wj-state-multi-selected"}if(p<=u._lastFrozen){y+=" wj-frozen-row";p===u._lastFrozen&&(y+=" wj-last-frozen-row")}g==d._lastFrozen&&(y+=" wj-frozen-col");(P&&P.wordWrap||h&&h.wordWrap)&&(y+=" wj-wrap");(P&&P.multiLine||h&&h.multiLine)&&(y+=" wj-multiline");var V=P?P.getAlignment(h):void 0;V&&(b=" wj-align-"+V);var K=v,W=a._isTransposed(),q=(K==E.ColumnHeader&&!W||K==E.RowHeader&&W)&&a._hasColumnGroups()?a._getColumnGroup(o,n):null;q&&q.align&&(b=" wj-align-"+q.align);R.paddingLeft=R.paddingRight=R.paddingTop=R.paddingBottom="";if(v==E.Cell&&a.rows.maxGroupLevel>-1&&n==d.firstVisibleIndex&&a.treeIndent){var U=_?Math.max(0,_.level):u.maxGroupLevel+1,Y=Math.min(a.treeIndent*U+a._cellPadLeft,w-a._cellPadHorz)+"px";c?R.paddingRight=Y:R.paddingLeft=Y}w<=a._cellPadHorz&&null==r.getAttribute(t.FlexGrid._WJS_MEASURE)&&(R.paddingLeft=R.paddingRight=0);var J=v==E.Cell&&n==d.firstVisibleIndex&&_&&_.hasChildren&&!_isEditingCell(a,o,n);J&&(b="");if(0!=s&&P){var X=i.getCellData(o,n,!1),$=i.getCellData(o,n,!0);if(J){var Z=_getTreeBtn(_,r);$=_.getGroupHeader()||e.escapeHtml($);r.innerHTML=Z.outerHTML+" "+$}else if(v!=E.ColumnHeader||p!=a._getSortRowIndex()&&P==f)if(v==E.RowHeader&&!$&&function(){var e=!1;if(n==a._getEditColumnIndex()){var i=a.editableCollectionView,o=i?i.currentEditItem:null;$=r.innerHTML=o&&h.dataItem==o?_getGlyph("pencil"):h instanceof t._NewRowTemplate?_getGlyph("asterisk"):"";e=!0}var l=P._tpl;if(l){_renderTemplate(l,r,X,$,h,P);e=!0}return e}());else if(v!=E.Cell||F!=e.DataType.Boolean||x||_&&!e.isBoolean(X))if(v==E.Cell&&!M&&_isEditingCell(a,o,n)){var Q=P.inputType||h.inputType;Q||(Q=F!=e.DataType.Number||x?"text":"tel");if(!x&&!P.mask&&!h.mask){var ee=i.getCellData(o,n,!1);e.isNumber(ee)&&($=function _getEditString(t,i){i=i||"n";var o=e.Globalize._parseNumericFormat(i);switch(o.spec){case"d":case"x":break;case"e":i=i.replace(/[0-9]/g,"");break;default:i="p"==o.spec?"P15":"r";o.scale&&(i+=Array(o.scale/3+1).join(","))}return e.Globalize.formatNumber(t,i,!0)}(ee,P.format||h.format))}r.innerHTML=(P.multiLine||h.multiLine)&&"checkbox"!=Q?'<textarea wrap="soft"></textarea>':'<input type="'+Q+'"/>';var te=r.children[0];e.addClass(te,"wj-grid-editor wj-form-control");e.disableAutoComplete(te);T&&x&&!x.isEditable&&($=e.toPlainText($));te.value=$;te.tabIndex=-1;te.required=P.getIsRequired(h);e.setAttribute(te,"aria-required",te.required);var ie=P.maxLength||h.maxLength;ie&&(te.maxLength=ie);te.style.textAlign=P.getAlignment(h);var oe=P.mask||h.mask;oe&&(te["$WJ-MSKP"]=new e._MaskProvider(te,oe));a.showPlaceholders&&(te.placeholder=P.header);(e.isSafari()||e.Control.sharedState.InvalidScroll)&&a._edtHdl&&a._edtHdl._edt&&(te.value=a._edtHdl._edt.value);a._edtHdl._edt=te}else{if(M){var ne=[],re=i.getCellData(o,n,!1);x.getDisplayValues(h.dataItem).forEach((function(t){var i=x.getKeyValue(t)==re?" checked":"",o=a.isReadOnly||h.isReadOnly||f.isReadOnly?" disabled":"",n=e.escapeHtml(t);ne.push('<label><input type="radio" tabindex="-1"'+i+o+' value="'+n+'"><span>'+n+"</span></label>")}));r.innerHTML=ne.join(" ");y+=" "+CellFactory._WJC_RADIOMAP}var le=H?P._tpl:null;le?_renderTemplate(le,r,X,$,h,P):M||(v==E.Cell&&T?r.innerHTML=$:r.textContent=$||"");if(q&&q.collapseTo){var se=q._rng;if(se&&(v==E.ColumnHeader&&se.columnSpan>1||v==E.RowHeader&&se.rowSpan>1)){var ae=q.isCollapsed;r.innerHTML='<div role="button" class="'+CellFactory._WJC_COLLAPSE+'">'+_getGlyph(ae?"plus":"minus")+"</div>&nbsp;"+r.innerHTML;ae&&e.addClass(r,"wj-state-collapsed")}}}else{var ce=r.firstChild;if(!a._isNativeCheckbox(ce)){r.innerHTML='<label><input type="checkbox" class="'+CellFactory._WJC_CHECKBOX+'" tabindex="-1"/><span></span></label>';ce=r.querySelector("input")}e.setChecked(ce,X);ce.disabled=!a.canEditCell(o,n);ce.disabled&&(ce.style.cursor="default");a.editRange&&a.editRange.contains(o,n)&&(a._edtHdl._edt=ce)}else{r.innerHTML=e.escapeHtml($);var ue=P.currentSort;if(ue&&a.showSort){y+=" wj-sort-"+("+"==ue?"asc":"desc");r.innerHTML+="&nbsp;"+function _getSortGlyph(e){var t=_getGlyph("+"==e.currentSort?"up":"down"),i=e.grid.collectionView;if(i&&i.sortDescriptions.length>1){var o=e.currentSortIndex;o>-1&&(t+='<span class="wj-sort-index">'+(o+1)+"</span>")}return t}(P)}a.allowPinning&&e.contains(a.hostElement,r)&&_addPinButton(r,n<a.columns.frozen)}if(S==t.DataMapEditor.DropDownList&&a.showDropDown&&a.canEditCell(o,n)&&t.softInput()){var de=_getDropDownBtn();r.insertBefore(de,r.firstChild);_isEditingCell(a,o,n)&&(y+=" wj-hasdropdown")}}if(v==E.RowHeader||v==E.ColumnHeader){var he=v==E.RowHeader?!_&&!m&&h.allowDragging&&0!=(a.allowDragging&t.AllowDragging.Rows):(q||f).allowDragging&&0!=(a.allowDragging&t.AllowDragging.Columns);e.setAttribute(r,"draggable",he?"true":null)}if([E.ColumnHeader,E.RowHeader].includes(v)&&[t.HeadersFocusability.All,t.HeadersFocusability.Column].includes(a.headersFocusability)){t.colHdrAriaAttributes(r,f,i,a,E.RowHeader===v);e.setAttribute(i.hostElement.parentElement,"aria-hidden",!1)}y+=b;r.className!=y&&(r.className=y);var fe=r.style;for(var pe in R)fe[pe]!==R[pe]&&(fe[pe]=R[pe]);if(a._edtHdl._edt&&a._edtHdl._edt.parentElement==r){var ge=a._root,_e=ge.getBoundingClientRect(),me=r.getBoundingClientRect(),we=_e.top+ge.clientHeight-me.top,Ce=_e.left+ge.clientWidth-me.left;me.height>we&&(r.style.height=we+"px");me.width>Ce&&(r.style.width=Ce+"px")}if((v==E.Cell||v==E.RowHeader)&&a._getShowErrors()){var ve=a._getError(i,o,n,!1);a._edtHdl._setCellError(r,ve)}a.itemFormatter&&a.itemFormatter(i,o,n,r);if(a.formatItem.hasHandlers){var ye=CellFactory._fmtItemArgs;if(ye){ye._p=i;ye._rng.setRange(o,n,p,g);ye._cell=r}else ye=CellFactory._fmtItemArgs=new t.FormatItemEventArgs(i,new t.CellRange(o,n,p,g),r);ye._updateContent=!1!==s;a.onFormatItem(ye)}};CellFactory.prototype.disposeCell=function(e){};CellFactory.prototype.getEditorValue=function(t){var i=t._edtHdl._edt;if(i instanceof HTMLInputElement)switch(i.type){case"checkbox":return i.checked;case"radio":return i.value}if(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement){var o=i["$WJ-MSKP"],n=o?o._applyMask():i.value,r=i.maxLength;if(e.isNumber(r)&&r>-1&&n.length>r){var l=e.culture.Globalize.numberFormat["%"]||"%",s=n.length&&n[n.length-1]==l;n=n.substr(0,r);s&&n.indexOf(l)<0&&(n+=l)}return n}return null};CellFactory._WJC_RADIOMAP="wj-radio-map";CellFactory._WJC_CHECKBOX="wj-cell-check";CellFactory._WJC_COLLAPSE="wj-elem-collapse";CellFactory._WJC_DROPDOWN="wj-elem-dropdown";CellFactory._WJC_PIN="wj-elem-pin";CellFactory._tplDdBtn=_getButton(CellFactory._WJC_DROPDOWN,"down");CellFactory._tplCtx={row:null,col:null,value:null,text:null,item:null};return CellFactory}();t.CellFactory=i;function _renderTemplate(t,o,n,r,l,s){var a=i._tplCtx;a.value=n;a.text=r;a.item=l.dataItem;a.row=l;a.col=s;var c=e.isString(t)?e.evalTemplate(t,a):t(a,o);null!=c&&(o.innerHTML=c)}function _isEditingCell(e,t,i){return e.editRange&&e.editRange.contains(t,i)}function _getDropDownBtn(){var t=i._ddBtn;if(!t){t=i._ddBtn=e.createElement(i._tplDdBtn);e.setAriaLabel(t,e.culture.FlexGrid.ariaLabels.toggleDropDown);e.setAttribute(t,"aria-expanded",!1)}return t.cloneNode(!0)}function _addPinButton(t,o){var n=_getButton(i._WJC_PIN,"pin"),r=e.createElement(n);e.toggleClass(r,"wj-state-pinned",o);e.setAttribute(r,"aria-pressed",o);t.insertBefore(r,t.firstChild)}function _getTreeBtn(t,o){var n=i._WJC_COLLAPSE,r=(t.isCollapsed?"":"down-")+(t.grid.rightToLeft?"left":"right"),l=e.createElement('<button class="wj-btn wj-btn-glyph '+n+'" type="button" tabindex="-1">'+_getGlyph(r)+"</button>");e.setAriaLabel(l,e.culture.FlexGrid.ariaLabels.toggleGroup);e.setAttribute(l,"aria-expanded",!t.isCollapsed);e.setAttribute(o,"aria-expanded",!t.isCollapsed);return l}function _getGlyph(e){return'<span class="wj-glyph-'+e+'"></span>'}function _getButton(e,t){return'<button class="wj-btn wj-btn-glyph wj-right {cls}" type="button" tabindex="-1">{glyph}</button>'.replace("{cls}",e).replace("{glyph}",_getGlyph(t))}}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function _EditHandler(i){var o=this;this._rng=null;this._edt=null;this._edItem=null;this._edtCanceled=!1;this._list=null;this._mapSearch=null;this._fullEdit=!1;this._evtInput=null;this._evtChange=null;this._cstEdtValue=null;this._validating=!1;this._composing=!1;this._g=i;this._evtInput=document.createEvent("HTMLEvents");this._evtInput.initEvent("input",!0,!1);this._evtChange=document.createEvent("HTMLEvents");this._evtChange.initEvent("change",!0,!1);i.selectionChanging.addHandler((function(e,t){return o._selectionChanging(t)}));i.lostFocus.addHandler((function(){var t=e.getActiveElement();t&&"fixed"==getComputedStyle(t).position?o.finishEditing():o._commitRowEdits()}));var n=i.hostElement;i.addEventListener(n,"mousedown",(function(e){if(!e.defaultPrevented&&0==e.button&&!i._mouseHdl._szRowCol){var n=i.hitTest(e);n.cellType!=t.CellType.Cell&&n.cellType!=t.CellType.None&&(o.finishEditing()||o.finishEditing(!0))}}),!0);i.addEventListener(n,"compositionend",(function(){o._composing=!1;o._keypress.bind(o)}));i.addEventListener(n,"compositionstart",(function(t){var n=o._getCustomEditor(i),r=null!=t?e.closest(t.target,".wj-flexgrid"):null,l=e.Control.getControl(r),s=l&&l._edtHdl?null!=l._edtHdl.activeEditor:null!=o.activeEditor;if(!n||s||i.imeEnabled)o._composing=!0;else{var a=window.getSelection(),c=a.rangeCount>0?a.getRangeAt(0):null,u=document.activeElement;if(null!=u){u.blur();window.getSelection().removeAllRanges();setTimeout((function(){null!=c&&window.getSelection().addRange(c);u.focus()}),20)}}}))}_EditHandler.prototype.startEditing=function(i,o,n,r,l){void 0===i&&(i=!0);var s=this._g,a=s._selHdl.selection;o=e.asNumber(o,!0,!0);n=e.isString(n)?s.columns.indexOf(n):e.asNumber(n,!0,!0);null==o&&(o=a.row);null==n&&(n=a.col);null==r&&(r=!0);if(!this._allowEdit(o,n))return!1;var c=s.getMergedRange(s.cells,o,n,!1);c||(c=new t.CellRange(o,n));var u=s.rows[o].dataItem;s.scrollIntoView(c.row,c.col,!0);if(!s.select(c,!0))return!1;if(!s.rows[o]||u!=s.rows[o].dataItem)return!1;if(this.activeEditor){if(c.equals(this._rng))return!0;if(!this.finishEditing())return!1}var d=new t.CellRangeEventArgs(s.cells,c,l);if(!s.onBeginningEdit(d))return!1;var h=s.editableCollectionView,f=!1;if(h){(f=(u=s.rows[o].dataItem)!=h.currentEditItem)&&s.onRowEditStarting(d);h.editItem(u);if(f){s.onRowEditStarted(d);this._edItem=u}}var p=s.rows[o],g=s._getBindingColumn(s.cells,o,s.columns[n]),_=g.dataMap||p.dataMap,m=t.DataMapEditor.RadioButtons,w=p.dataMap&&p.dataMapEditor==m||g.dataMap&&g.dataMapEditor==m;this._fullEdit=e.asBoolean(i);this._rng=c;this._list=null;if(_&&!w&&!g.editor){var C=_.getDisplayValues(u);(g.isContentHtml||p.isContentHtml)&&(C=C.map((function(t){return e.toPlainText(t)})));this._list=C;this._mapSearch=_.search}if(w){var v=s._activeCell||s.hostElement.querySelector(".wj-cell.wj-state-active");if(v){var y=l?l.target:null;y instanceof HTMLSpanElement&&(y=e.closest(y,"label"));y instanceof HTMLLabelElement&&(y=y.querySelector("input"));if(y instanceof HTMLInputElement)this._edt=y;else{var b=v.querySelectorAll("input[checked]");b.length>0?this._edt=b[0]:this._edt=v.querySelector("input")}this._updateRowHeaderCell(o)}}else c.isSingleCell?this._updateEditorCell(o,n,f):s.refresh(!1);var R=this._edt;if(R){if("checkbox"==R.type||"radio"==R.type)this._fullEdit=!1;else if(r){var E=0,x=R.value.length,S=!1,H=e.culture.Globalize.numberFormat["%"]||"%",M=s.getCellData(o,n,!1);e.isNumber(M)?S=R.value.indexOf(H)>-1:null==M&&(S=/^p/i.test(g.format))&&R.value.indexOf(H)<0&&(R.value+=H);if(S){var G=R.value;E=0;x=G.length;for(;x>0&&(G[x-1]==H||" "==G[x-1]);)x--;for(;E<x&&G[E]==H;)E++}l&&"keydown"==l.type&&l.keyCode==e.Key.Space&&(E=x);this._setSelectionRange(R,E,x,!0,e.isEdge());e.isIE()&&"right"==R.style.textAlign&&(R.style.paddingRight="1px")}s.onPrepareCellForEdit(d)}r&&!s.containsFocus()&&s.focus();return null!=R&&!R.disabled&&!R.readOnly};_EditHandler.prototype.finishEditing=function(i){var o=this._edt;if(!o){this._removeListBox();return!0}var n=this._g,r=this._rng,l=new t.CellEditEndingEventArgs(n.cells,r),s=n.containsFocus();if(!i){var a=n.hostElement.querySelector(".wj-control.wj-state-focused");if(a){var c=e.Control.getControl(a);c&&(c.containsFocus()||c._focus)&&c.onLostFocus(l)}}l.cancel=i;if(!i&&n.validateEdits){if(v=this._getValidationError()){l.cancel=!0;var u=n.cells.getCellElement(r.row,r.col);if(u){this._setCellError(u,v);l.stayInEditMode=!0}}}this._cstEdtValue=null;l.data=n.cells.getCellData(r.topRow,r.leftCol,!1);if(!n.onCellEditEnding(l)&&l.stayInEditMode){s?setTimeout((function(){o.select()})):o.select();this._fullEdit=!0;return!1}if(!l.cancel){var d=null,h=!1;if(null!=this._lbx_SelectedValue){d=this._lbx_SelectedValue;h=!0}else{var f=this._cstEdtValue;d=f&&!e.isUndefined(f.value)?f.value:this._lbx_SelectedValue?this._lbx_SelectedValue:n.cellFactory.getEditorValue(n);h=null!=this._lbx_SelectedValue}for(var p=r.topRow;p<=r.bottomRow&&p<n.rows.length;p++)for(var g=r.leftCol;g<=r.rightCol&&g<n.columns.length;g++){var _=n._getBindingColumn(n.cells,p,n.columns[g]),m=n.rows[p],w=_&&_.dataMap||m&&m.dataMap,C=!w||w.serializeKeys;if(h||!w||!this.isEqualValue(w.getDisplayValue(l.data),d)){if(!n.cells.setCellData(p,g,d,C,!1,h)&&n.validateEdits){var v;if(v=this._getValidationError(!0)){l.cancel=!0;var y=n.cells.getCellElement(r.row,r.col);if(y){this._setCellError(y,v);l.stayInEditMode=!0}return!1}}}}o.value==this._edtValue&&o.dispatchEvent(this._evtChange)}this._edt=null;this._rng=null;this._list=null;this._edtValue=null;this._edtCanceled=l.cancel;this._removeListBox();this._lbx_SelectedValue=null;var b=e.closest(o,".wj-cell");if(e.contains(b,e.getActiveElement())){n._setFocusNoScroll(b);n._isScrollingByWheel=!1}!l.cancel&&l.refresh&&n._refreshOnEdit?n.refresh(!1):this._updateEditorCell(r.row,r.col,!1);s&&n.focus();n.onCellEditEnded(l);return!0};_EditHandler.prototype._setSelectionRange=function(t,i,o,n,r){void 0===n&&(n=!0);void 0===r&&(r=!1);if(!r)return e.setSelectionRange(t,i,o,n);if(e.contains(document.body,t)&&!t.disabled&&t.offsetHeight){try{t.setSelectionRange(i,o,"backward")}catch(e){}if(n)try{this._g._setFocusNoScroll(t);return!0}catch(e){}}return!1};_EditHandler.prototype._setCustomEditorValue=function(e){this._cstEdtValue={value:e}};_EditHandler.prototype._getCustomEditor=function(e){var t=null,i=e.selection;if(null!=i){var o=e._getBindingColumn(e.cells,i.row,e.columns[i.col]);t=o&&o._edt}return t};_EditHandler.prototype._setCellError=function(t,i){var o=this._g;""==i&&(i=null);e.toggleClass(t,"wj-state-invalid",null!=i);var n=o.errorTip,r=o.activeEditor;if(n){n.setTooltip(t,i);r&&e.contains(t,r)&&e.setAttribute(r,"title","")}else e.setAttribute(t,"title",i);r&&t==o.activeCell&&!e.contains(t,r)&&n&&n.setTooltip(r,i)};Object.defineProperty(_EditHandler.prototype,"activeEditor",{get:function(){return this._edt},enumerable:!0,configurable:!0});Object.defineProperty(_EditHandler.prototype,"editRange",{get:function(){return this._rng},enumerable:!0,configurable:!0});_EditHandler.prototype.getClipString=function(i,o,n,r){var l,s=this,a=this._g,c=a.selectionMode,u=[],d=0!=(o&t.ClipStringOptions.CSV),h=d?"\r\n":"\n",f=d?",":"\t",p=0!=(o&t.ClipStringOptions.InvisibleRows),g=t.SelectionMode,_=null!=i;if(!i&&c!=g.ListBox)for(var m=a.rows,w=0;w<m.length;w++)if(m[w].isSelected){c=g.ListBox;break}if(!i){a._selHdl._expandSelection();i=a.selection;switch(c){case g.Row:case g.RowRange:case g.ListBox:i.col=0;i.col2=a.columns.length-1;break;case g.MultiRange:var C=a.selectedRanges;if(C.length>1){var v=this._sameCols(C),y=this._sameRows(C);if(v||y){(C=C.slice()).sort((function(e,t){var i=e.topRow-t.topRow;return i||e.leftCol-t.leftCol}));for(var b=0;b<C.length;b++)for(var R=C[b],E=b+1;E<C.length;E++)if(R.contains(C[E])){C.splice(E,1);E--}if(v){var x=[];C.forEach((function(e){x.push(s.getClipString(e,o,n,r));n=!1}));return x.join(h)}if(y){var S;C.forEach((function(e){var t=s.getClipString(e,o,n,r).split(h);if(null==S){S=t;r=!1}else t.forEach((function(e,t){S[t]+=f+e}))}));return S.join(h)}}}}}var H=i.col>-1&&i.col2>-1;n&&H&&(l=a.columnHeaders).rows.forEach((function(e,t){if(p||e.isVisible){var n=s._getRowClipString(l,t,i,o,r);u.push(n)}}));if(i.row>-1&&i.row2>-1){l=a.cells;if(c!=g.ListBox||_){e.assert(i.bottomRow<l.rows.length,"Row index must be less than the number of rows.");for(b=i.topRow;b<=i.bottomRow;b++)if(p||l.rows[b].isVisible){var M=this._getRowClipString(l,b,i,o,r);u.push(M)}}else l.rows.forEach((function(e,t){if(e.isSelected&&(p||e.isVisible)){var n=s._getRowClipString(l,t,i,o,r);u.push(n)}}))}return u.join(h)};_EditHandler.prototype._getRowClipString=function(i,o,n,r,l){var s=[],a=i.rows[o],c=t.ClipStringOptions,u=0!=(r&c.CSV),d=0!=(r&c.InvisibleColumns),h=0==(r&c.Unformatted),f=0!=(r&c.SkipMerged);if(a.isVisible){if(l)for(var p=i.cellType==t.CellType.ColumnHeader?i.grid.topLeftCells:i.grid.rowHeaders,g=0;g<p.columns.length;g++)if(d||p.columns[g].isVisible){var _=p.getCellData(o,g,!0);f&&this._skipMergedCell(i,null,o,g)&&(_="");s.push(this._getCellClipString(_,r))}if(n.col>-1&&n.col2>-1){e.assert(n.rightCol<i.columns.length,"Column index must be less than the number of columns.");for(g=n.leftCol;g<=n.rightCol;g++)if(d||i.columns[g].isVisible){!(_=i.getCellData(o,g,h))&&a instanceof t.GroupRow&&g==i.columns.firstVisibleIndex&&(_=e.toPlainText(a.getGroupHeader()));f&&this._skipMergedCell(i,null,o,g)&&(_="");s.push(this._getCellClipString(_,r))}}}return s.join(u?",":"\t")};_EditHandler.prototype._skipMergedCell=function(e,t,i,o){var n=e.grid.getMergedRange(e,i,o,!1);if(n){if(t){n.row=Math.max(t.topRow,n.row);n.col=Math.max(t.leftCol,n.col)}if(n.row!=i||n.col!=o)return!0}return!1};_EditHandler.prototype._getCellClipString=function(i,o){e.isString(i)||(i=e.isDate(i)?i.toJSON():null!=i?i.toString():"");i=i.replace(/\t/g," ");var n=0!=(o&t.ClipStringOptions.QuoteAll);(n=n||/\n|^"|"$/.test(i))||0==(o&t.ClipStringOptions.CSV)||(n=i.indexOf(",")>-1);n&&(i='"'+(i=i.replace(/"/g,'""'))+'"');return i};_EditHandler.prototype._sameRows=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].topRow!=t.topRow||e[i].bottomRow!=t.bottomRow)return!1;return!0};_EditHandler.prototype._sameCols=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].leftCol!=t.leftCol||e[i].rightCol!=t.rightCol)return!1;return!0};_EditHandler.prototype.setClipString=function(i,o){var n=this,r=this._g,l=r.editableCollectionView,s=null==o,a=t.SelectionMode;if(s){r._selHdl._expandSelection();o=r.selection;switch(r.selectionMode){case a.Row:case a.RowRange:case a.ListBox:o.col=0;o.col2=r.columns.length-1;break;case a.MultiRange:var c=r.selectedRanges;if(c.length>1){l&&l.beginUpdate();c.forEach((function(e){r.setClipString(i,e)}));l&&l.endUpdate();r.selectedRanges=c;return}}}o=e.asType(o,t.CellRange);var u=this._parseClipString(e.asString(i));!s&&u.length>o.rowSpan&&(u=u.slice(0,o.rowSpan));this._expandClipRows(u,o);var d=0;if(u.length)for(var h=o.leftCol,f=r.columns.length,p=0;p<u[0].length;p++)for(var g=h+p+d;g<f&&!r.columns[g].visible;){d++;g++}var _=s?new t.CellRange(o.topRow,o.leftCol,Math.min(o.topRow+u.length-1,r.rows.length-1),Math.min(o.leftCol+u[0].length-1+d,r.columns.length-1)):o,m=new t.CellRangeEventArgs(r.cells,_,i);if(!r.onPasting(m))return!1;_=new t.CellRange(o.topRow,o.leftCol);var w=new t.CellRangeEventArgs(r.cells,new t.CellRange(o.topRow,-1)),C=!1,v=0,y=o.topRow,b=r.rows,R=r.columns,E=r._getRowsPerItem(),x=u.length>E,S=this._deferPaste(o,u.length);e.assert(E>=1,"Invalid RPI value = "+E);r.deferUpdate((function(){var i=-1;if(l&&S){i=l.currentPosition;l.beginUpdate()}for(var s=0;s<u.length&&y<b.length;s++,y++){var a=b[y];if(a.isVisible){if(!x||!a.isReadOnly){var c=a.dataItem,d=l?l.currentEditItem:null;if(d&&c!=d){r.onRowEditEnding(w);r.onRowEditEnded(w)}if(a instanceof t._NewRowTemplate&&l){if(S){a.dataItem=l.addNew();w._rng.setRange(r.newRowAtTop?0:y,-1);if(!r.onRowEditStarting(w)){y--;l.cancelNew();continue}r.onRowEditStarted(w)}else if(1==E||(y+1)%E==1){w._rng.setRange(r.newRowAtTop?y%E:y,-1);if(!r.onRowEditStarting(w)){y--;continue}r.onRowEditStarted(w)}}else if(c!=d){w._rng.setRange(y,-1);r.onRowEditStarting(w);r.onRowEditStarted(w)}for(var h=u[s],f=o.leftCol,p=0;p<h.length&&f<R.length;p++,f++){var g=R[f];if(g.isVisible){if(!x||!g.isReadOnly){var m=r.getMergedRange(r.cells,y,f,!1);if(!(m&&(m.leftCol!=f||m.topRow!=y))&&n._allowEdit(y,f)){var H=h[p],M=H.length;M>1&&'"'==H[0]&&'"'==H[M-1]&&H.indexOf("\n")>-1&&(H=H.substr(1,M-2));var G=g.maxLength||a.maxLength;G&&(H=H.substr(0,G));var T=new t.CellRangeEventArgs(r.cells,new t.CellRange(y+v,f),H);if(r.onPastingCell(T)){if(l){l.editItem(c);n._edItem=l.currentEditItem}var P=r.getCellData(y,f,!1),F=T.data,z=t.softInput();if(z){var I=r._getBindingColumn(r.cells,y,r.columns[f]),A=I.editor,D=null,j=null;if(A instanceof z.InputNumber){D=A.clamp.bind(A);j=e.DataType.Number}else if(A instanceof z.InputDate||A instanceof z.InputTime){D=A._clamp.bind(A);j=e.DataType.Date}if(D){F=e.changeType(F,j,I.format,P);e.getType(F)==j&&(F=D(F))}}if(r.setCellData(y,f,F)){T.data=P;r.onPastedCell(T);C=!0}}_.row2=Math.max(_.row2,y+v);_.col2=Math.max(_.col2,f)}}}else p--}if(n._edItem&&l instanceof e.collections.CollectionView){var O=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,n._edItem,y);l.onCollectionChanged(O,l._edtClone)}if(a instanceof t._NewRowTemplate&&l)if(S){a.dataItem=null;if(C){w._rng.setRange(r.newRowAtTop?0:y,-1);r.onRowEditEnding(w);r.onRowEditEnded(w);y--;v++;l.commitNew()}else l.cancelNew()}else if(x&&E>1&&(y+1)%E==0&&C){w._rng.setRange(r.newRowAtTop?y%E:y,-1);r.onRowEditEnding(w);r.onRowEditEnded(w);y-=E;v++}}}else s--}if(l)if(S){if(l.currentEditItem){l.commitEdit();r.onRowEditEnding(w);r.onRowEditEnded(w)}l.moveCurrentToPosition(i);l.endUpdate(!0)}else{var L=l.currentAddItem;!L&&0==o.row&&r.newRowAtTop&&b[0]instanceof t._NewRowTemplate&&(L=b[0].dataItem);if(L){l.editItem(L);n._edItem=L}}_.rowSpan>1&&0==_.topRow&&b[0]instanceof t._NewRowTemplate&&(_.row=_.row2=0);r.select(_)}));r.onPasted(m);if(C&&e.closest(r.hostElement,"form")){var H=document.createEvent("HTMLEvents"),M=e.createElement("<input>",r.hostElement);H.initEvent("change",!0,!1);M.dispatchEvent(H);e.removeChild(M)}};_EditHandler.prototype._deferPaste=function(e,i){var o=this._g.rows,n=o.length;if(i>1){if(n>1&&o[0].dataItem!=o[1].dataItem)return!0;if(1==n&&o[0]instanceof t._NewRowTemplate)return!0}return!1};_EditHandler.prototype._parseClipString=function(e){var t=[],i=(e=(e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).replace(/\n$/,"")).length,isTabOrNewLineChar=function(e){return"\n"===e||"\t"===e},o=0,n=0;for(o=0;o<i;o++){var r=!1,l=!1,s=!1;if('"'===e[o]){for(var a=!1,c=!1,u=o+1;u<i;u++){var d=e[u];if('"'===d){var h=u+1;if(h<i){isTabOrNewLineChar(e[h])&&(c=!0)}else c=!0}else!a&&isTabOrNewLineChar(d)&&(a=!0);if(c)break}c&&a&&(r=!0)}for(n=o;n<i&&!s;n++){var f=e[n];if('"'===f)r&&(l=!l);else if(isTabOrNewLineChar(f)&&!l){this._parseClipCell(t,e,o,n,"\n"==f);o=n;n==i-1&&(o=n+1);s=!0}}if(n==i){this._parseClipCell(t,e,o,n,!1);break}}0==t.length&&t.push([""]);return t};_EditHandler.prototype._parseClipCell=function(e,t,i,o,n){e.length||e.push([]);var r=t.substr(i,o-i),l=r.length;if(l>2&&'"'==r[0]&&'"'==r[l-1]){var s=r.substr(1,l-2),unquotedStringHasChar=function(e){return s.indexOf(e)>-1};(unquotedStringHasChar('""')||unquotedStringHasChar("\t")||unquotedStringHasChar("\n"))&&(r=s.replace(/""/g,'"'))}else"\t"==r&&(r="");e[e.length-1].push(r);n&&e.push([])};_EditHandler.prototype._expandClipRows=function(e,t){for(var i=e.length,o=0,n=0;n<i;n++)o=Math.max(o,e[n].length);for(var r=this._g,l=0,s=0,a=t.topRow;a<=t.bottomRow;a++)r.rows[a].isVisible&&l++;for(var c=t.leftCol;c<=t.rightCol;c++)r.columns[c].isVisible&&s++;if(l>1||s>1){1==l&&(l=i);1==s&&(s=o);if(s%o==0&&l%i==0){for(c=o;c<s;c++)for(a=0;a<i;a++)e[a].push(e[a%i][c%o]);for(a=i;a<l;a++)e.push(e[a%i])}}};_EditHandler.prototype._updateEditorCell=function(t,i,o){var n=this._g,r=n.cells.getCellElement(t,i),l=n._useFrozenDiv()&&(t<n.rows.frozen||i<n.columns.frozen);if(!r||l||n._hasPendingUpdates())n.refresh(!1);else if(n.onUpdatingView(new e.CancelEventArgs)){this._updateCell(r);(o||n._getHasValidation())&&this._updateRowHeaderCell(t);n.onUpdatedView()}};_EditHandler.prototype._updateRowHeaderCell=function(e){var i=this._g;if(i.headersVisibility&t.HeadersVisibility.Row){var o=i.rowHeaders,n=i._getEditColumnIndex(),r=o.getCellElement(e,n);r&&this._updateCell(r)}};_EditHandler.prototype._updateCell=function(i){var o=new t.HitTestInfo(i,null),n=t.FlexGrid._WJS_UPDATING;if(o.panel){e.addClass(i,n);o.grid.cellFactory.updateCell(o.panel,o.row,o.col,i,o.range);e.removeClass(i,n)}};_EditHandler.prototype._getValidationError=function(t){var i=this,o=this._g,n="";if(o&&this._rng&&!this._validating){var r=this._rng.row,l=this._rng.col,s=o.activeEditor,a=o.cellFactory.getEditorValue(o),c=o.getCellData(r,l,!1);t&&(n=o._getError(o.cells,r,l,!0));if(!n&&o._getHasValidation()){s&&(n=s.validationMessage);if(!n){var u=o.columns[l],d=o.rows[r];!o._getBindingColumn(o.cells,r,u).getIsRequired(d)||null!=a&&""!==a||(n=this._getRequiredMsg())}if(!n&&o.setCellData(r,l,a,!0,!1)){n=o._getError(o.cells,r,l,!1);o.setCellData(r,l,c,!1,!1)}}if(!n){var h=e.Control.getControl(e.closest(s,".wj-control"));if(h&&h!=o&&h.invalidInput.hasHandlers){var invInputHandler=function(e,t){if(t.cancel){n=o._getError(o.cells,r,l,!0)||i._getBadInputMsg();t.cancel=!1}};this._validating=!0;var f=s.value;h.invalidInput.addHandler(invInputHandler);if(h._containsFocus()){var p=e.closest(h.hostElement,".wj-cell");p&&p.focus()}h.onLostFocus();h.invalidInput.removeHandler(invInputHandler);s.value=f;n&&s.select();this._validating=!1}}}return n};_EditHandler.prototype._getRequiredMsg=function(){if(!_EditHandler._msgRequired){var e=document.createElement("input");e.required=!0;_EditHandler._msgRequired=e.validationMessage}return _EditHandler._msgRequired};_EditHandler.prototype._getBadInputMsg=function(){if(!_EditHandler._msgBadInput){var e=document.createElement("input");e.pattern="x";e.value="a";_EditHandler._msgBadInput=e.validationMessage||"Bad Input"}return _EditHandler._msgBadInput};_EditHandler.prototype._allowEdit=function(e,i){var o=this._g;if(o.isReadOnly||o.selectionMode==t.SelectionMode.None)return!1;if(o.collectionView&&!o.editableCollectionView)return!1;if(null!=e){if(e<0||e>=o.rows.length)return!1;var n=o.rows[e];if(!n||n.isReadOnly||!n.isVisible)return!1}if(null!=i){if(i<0||i>=o.columns.length)return!1;var r=o._getBindingColumn(o.cells,e,o.columns[i]);if(!r||r.isReadOnly||!r.isVisible)return!1}return!0};_EditHandler.prototype._commitRowEdits=function(){var e=this._g;if(this.finishEditing()&&this._edItem){var i=e.editableCollectionView;if(i&&(i.currentEditItem||i.currentAddItem)){var o=new t.CellRangeEventArgs(e.cells,e.selection);e.onRowEditEnding(o);i.commitEdit();e.onRowEditEnded(o)}this._edItem=null}};_EditHandler.prototype._keydown=function(t){var i=this._edt;switch(t.keyCode){case e.Key.F2:this._fullEdit=!this._fullEdit;t.preventDefault();return!0;case e.Key.F4:this._toggleListBox(t);t.preventDefault();return!0;case e.Key.Space:if(i&&"checkbox"==i.type&&!i.disabled&&!i.readOnly){e.setChecked(i,i.indeterminate||!i.checked);this.finishEditing();t.preventDefault()}return!0;case e.Key.Enter:t.preventDefault();if(i&&t.altKey){var o=t.target;if(o instanceof HTMLTextAreaElement&&"soft"==o.wrap){if(this._composing){o.blur();o.focus()}o.style.setProperty("ime-mode","auto","important");var n=o.value,r=o.selectionStart,l=o.selectionEnd;o.value=n.substr(0,r)+"\n"+n.substr(l);e.setSelectionRange(o,r+1);o.blur();o.focus();o.style.imeMode=""}return!0}if(i&&this._lbx){var s=this._g,a=s._selHdl.selection,c=s.rows[a.row],u=s._getBindingColumn(s.cells,a.row,s.columns[a.col]);this._lbx_SelectedValue=this._findKeyValue(c.dataMap||u.dataMap,u.isContentHtml||c.isContentHtml);this._toggleListBox(t);this.finishEditing();return!0}return!this.finishEditing();case e.Key.Tab:t.preventDefault();return!this.finishEditing();case e.Key.Escape:t.preventDefault();this.finishEditing(!0);return!0;case e.Key.Up:case e.Key.Down:case e.Key.Left:case e.Key.Right:case e.Key.PageUp:case e.Key.PageDown:case e.Key.Home:case e.Key.End:if(this._lbx)return this._keydownListBox(t);if(t.altKey)switch(t.keyCode){case e.Key.Up:case e.Key.Down:this._toggleListBox(t);t.preventDefault();return!0}if(this._fullEdit)switch(t.keyCode){case e.Key.PageUp:case e.Key.PageDown:t.preventDefault()}else if(this.finishEditing())return!1}return!0};_EditHandler.prototype._keydownListBox=function(t){var i=!0;if(this._lbx)switch(t.keyCode){case e.Key.Up:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex>0&&this._lbx.selectedIndex--;break;case e.Key.Down:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex++;break;case e.Key.Home:case e.Key.PageUp:this._lbx.selectedIndex=0;break;case e.Key.End:case e.Key.PageDown:this._lbx.selectedIndex=this._lbx.collectionView.items.length-1;break;default:i=!1}if(i){t.preventDefault();return!0}return!1};_EditHandler.prototype._keypress=function(t){if("AltLeft"!=t.code&&"AltRight"!=t.code){var i=this._edt,o=t.charCode||32,n=this._list;if(e.isEdge()){var r=i;r&&(1==r.value.length||0==r.selectionStart&&r.selectionEnd==r.value.length)&&(e.Control.sharedState.InvalidScroll=!0)}if(i&&"checkbox"!=i.type&&e.getActiveElement()==i&&n&&n.length>0&&o>=32){var l=i.selectionStart,s=i.value.substr(0,l);if(t.target==i&&t.charCode){s+=String.fromCharCode(t.charCode);l++}var a=this._mapSearch,c=-1;if(a)for(var u=0;u<n.length;u++){var d=n[u];if(a(null==d?d:d.toString(),s)){c=u;break}}else(c=this._findString(n,s,!0))<0&&!this._g.caseSensitiveSearch&&(c=this._findString(n,s,!1));if(c>-1){var h=this._lbx;h&&(h.selectedIndex=c);i.value=n[c];e.setSelectionRange(i,l,i.value.length);i.dispatchEvent(this._evtInput);t.preventDefault&&t.preventDefault()}else this._lbx&&(this._lbx_SelectedValue=null)}}else t.preventDefault()};_EditHandler.prototype._findString=function(e,t,i){i||(t=t.toLowerCase());for(var o=0;o<e.length;o++){var n=e[o];if(null!=n){n=n.toString();i||(n=n.toLowerCase());if(0==n.indexOf(t))return o}}return-1};_EditHandler.prototype._toggleListBox=function(e,i){var o=this._g,n=o._selHdl.selection,r=o.isTouching;i||(i=n);if(this._lbx){this._removeListBox();if(n.intersects(i)){o.activeEditor?o.activeEditor.focus():o.containsFocus()||o.focus();return!0}}if(!i.isValid)return!1;var l=o.rows[i.row],s=o._getBindingColumn(o.cells,i.row,o.columns[i.col]),a=l.dataMap||s.dataMap,c=o._getMapEditor(l,s);if(!a||c!=t.DataMapEditor.DropDownList||!t.softInput())return!1;if(null!=s.editor)return!1;if(!i.intersects(o.editRange)&&!this.startEditing(!0,i.row,i.col,!r,e))return!1;var u=this._lbx=this._createListBox();requestAnimationFrame((function(){return u.showSelection()}));r&&u.focus();return!0};_EditHandler.prototype._createListBox=function(){var i=this,o=this._g,n=o.activeEditor,r=this._rng,l=o.rows[r.row],s=o._getBindingColumn(o.cells,r.row,o.columns[r.col]),a=s.isContentHtml||l.isContentHtml,c=s.dataMap||l.dataMap,u=s.dropDownCssClass||l.dropDownCssClass,d=document.createElement("div");this._removeListBox();e.addClass(d,"wj-dropdown-panel wj-grid-listbox");e.addClass(d,u);var h=n?n.value:o.getCellData(r.row,r.col,!0),f=new e.input.ListBox(d,{maxHeight:4*l.renderHeight,isContentHtml:a,itemsSource:c.getDisplayValues(l.dataItem)});if(c._displayPath==c._keyPath)f.selectedValue=h;else{var p=o.getCellData(r.row,r.col,!1),g=-1,_=this._findDuplicateValues(c,h,a),m=c._cv.items.findIndex((function(e){return i.isEqualValue(e[c._keyPath],p,a)}));if(m>-1){var w=c._cv.items[m][c._displayPath];if(this.isEqualValue(h,w,a))if(1==_.length)g=m>f.itemsSource.length||!this.isEqualValue(f.itemsSource[m],h,a)?f.itemsSource.findIndex((function(e){return i.isEqualValue(w,e,a)})):m;else for(var C=-1,v=0;v<f.itemsSource.length;v++)if(this.isEqualValue(f.itemsSource[v],w,a)){C++;if(this.isEqualValue(_[C],p,a)){g=v;break}}}g<0&&(g=f.itemsSource.findIndex((function(e){return i.isEqualValue(h,e,a)})));g>=0?f.selectedIndex=g:f.selectedValue=null}f.addEventListener(d,"keydown",(function(t){switch(t.keyCode){case e.Key.Enter:case e.Key.Escape:i._removeListBox();o.focus()}}));f.addEventListener(d,"click",(function(){i._lbx&&(i._lbx_SelectedValue=i._findKeyValue(c,a));i._removeListBox();o.focus();i.finishEditing()}));f.gotFocus.addHandler((function(){f.containsFocus()&&n&&!e.isEdge()&&n.focus()}));f.selectedIndexChanged.addHandler((function(){var t=o.activeEditor;if(t){t.value=i._list[f.selectedIndex];t.dispatchEvent(i._evtInput);e.setSelectionRange(t,0,t.value.length)}}));var y=o.cells.getCellElement(r.row,r.col);if(y){e.showPopup(d,y,!1,!1,!1);var b=y.querySelector("."+t.CellFactory._WJC_DROPDOWN);e.setAttribute(b,"aria-expanded",!0)}else{e.showPopup(d,o.getCellBoundingRect(r.row,r.col));d[e.Control._OWNR_KEY]=o.hostElement}return f};_EditHandler.prototype._findKeyValue=function(e,t){void 0===t&&(t=!1);var i=this._lbx.selectedValue,o=this._findDuplicateValues(e,i,t),n=e.getKeyValue(i);if(this._lbx.selectedIndex>0&&o.length>1){for(var r=-1,l=0;l<=this._lbx.selectedIndex;l++)this.isEqualValue(this._lbx.itemsSource[l],i,t)&&r++;r>=0&&(n=o[r])}return n};_EditHandler.prototype._findDuplicateValues=function(e,t,i){void 0===i&&(i=!1);for(var o=[],n=e.getKeyValues(),r=0;r<n.length;r++)this.isEqualValue(e.getDisplayValue(n[r]),t,i)&&o.push(n[r]);return o};_EditHandler.prototype._removeListBox=function(){var t=this._lbx;if(t){this._lbx=null;e.hidePopup(t.hostElement,(function(){t.dispose()}))}};_EditHandler.prototype.isEqualValue=function(t,i,o){void 0===o&&(o=!1);if(t instanceof Date&&i instanceof Date)return t.getTime()==i.getTime();null!=t&&null!=t||(t="");null!=i&&null!=i||(i="");Number.isNaN(t)&&(t="NaN");Number.isNaN(i)&&(i="NaN");if(o){e.isString(t)&&t.indexOf("<")>-1&&(t=e.toPlainText(t));e.isString(i)&&i.indexOf("<")>-1&&(i=e.toPlainText(i))}return t.toString()==i.toString()};_EditHandler.prototype._selectionChanging=function(e){var i=this;if(this.finishEditing()){var o=this._g._selHdl.selection.row;if(o!=e.row){var n=this._g.rows.length;if((o>-1&&o<n?this._g.rows[o].dataItem:null)!=(e.row>-1&&e.row<n?this._g.rows[e.row].dataItem:null)){this._commitRowEdits();if(this._g._getHasValidation()&&this._g.validateEdits){var r=!this._g.rows[o]||this._g.rows[o]&&Object.getPrototypeOf(this._g.rows[o])!==t.Row.prototype?null:this._g.getEmptyRequiredCell(o);null!==r&&setTimeout((function(){i._g.select(new t.CellRange(o,r));i.startEditing(!0,o,r,!0,e)}))}}}}else e.cancel=!0};_EditHandler._msgRequired="";_EditHandler._msgBadInput="";return _EditHandler}();t._EditHandler=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){var i=function(){function _CustomEditor(i,o){this._col=e.asType(i,t.Column);this._ctl=o;this._tbx=o.hostElement.querySelector("input");e.assert(this._col instanceof t.Column,"Invalid Column");e.assert(this._ctl instanceof e.Control,"Invalid edit control");e.assert(this._tbx instanceof HTMLInputElement,"Input element not found in editor");var n=this._ctl;this._prop=e.isUndefined(n.value)?e.isUndefined(n.checkedItems)?e.isUndefined(n.text)?null:"text":"checkedItems":"value";e.assert(null!=this._prop,"value, text properties not found in editor");var r=t.softInput();if(r){this._isDropDown=n instanceof r.DropDown;this._isComboBox=n instanceof r.ComboBox;this._isAutoComplete=n instanceof r.AutoComplete;this._isInputDateTime=n instanceof r.InputDateTime;this._isInputNumber=n instanceof r.InputNumber;this._isInputMask=n instanceof r.InputMask}this._updateFocusBnd=this._updateFocus.bind(this);this._keydownBnd=this._keydown.bind(this);this._cmpstartBnd=this._cmpstart.bind(this);this._mousedownBnd=this._mousedown.bind(this);this._connect();this._col.gridChanged.addHandler(this._connect,this);this._hideEditor();this._updateFocus()}Object.defineProperty(_CustomEditor.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0});Object.defineProperty(_CustomEditor.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0});Object.defineProperty(_CustomEditor.prototype,"control",{get:function(){return this._ctl},enumerable:!0,configurable:!0});_CustomEditor.prototype.dispose=function(){this._disconnect();this._isDropDown&&(this._isDropDown=!1);this._g=this._col=this._ctl=this._tbx=null};_CustomEditor.prototype._connect=function(){var e=this._col?this._col.grid:null;if(e!=this._g){this._disconnect();if(e){var t=e.hostElement,i=e.addEventListener.bind(e),o=this._updateFocusBnd;this._g=e;this._hideEditor();this._updateFocus();i(t,"keydown",this._keydownBnd,!0);i(t,"mousedown",this._mousedownBnd,!0);i(t,"mouseup",o,!0);i(t,"blur",o,!0);i(t,"focus",o);i(this._tbx,"compositionstart",this._cmpstartBnd);e.gotFocus.addHandler(o,this);e.selectionChanged.addHandler(o,this);e.prepareCellForEdit.addHandler(this._prepareCellForEdit,this);e.cellEditEnding.addHandler(this._cellEditEnding,this);e.cellEditEnded.addHandler(this._cellEditEnded,this)}}};_CustomEditor.prototype._disconnect=function(){var e=this._g;if(e){var t=e.hostElement,i=e.removeEventListener.bind(e),o=this._updateFocusBnd;i(t,"keydown",this._keydownBnd);i(t,"mousedown",this._mousedownBnd);i(t,"mouseup",o);i(t,"blur",o);i(t,"focus",o);i(this._tbx,"compositionstart",this._cmpstartBnd);e.gotFocus.removeHandler(o,this);e.selectionChanged.removeHandler(o,this);e.prepareCellForEdit.removeHandler(this._prepareCellForEdit,this);e.cellEditEnding.removeHandler(this._cellEditEnding,this);e.cellEditEnded.removeHandler(this._cellEditEnded,this);this._g=null}};_CustomEditor.prototype._prepareCellForEdit=function(t,i){if(!i.cancel&&i.getColumn(!0)==this._col){var o=this.grid,n=this._ctl,r=this._tbx,l=this._prop,s=i.range,a=i.data,c=a&&void 0!==a.type?a.type:"",u=o.getCellData(s.row,s.col,"text"==l||this._isInputMask),d=!1;if(this._isComboBox){""!=u&&(n._emptyValueAction=!1);this._isInputDateTime&&n._setDropdown(n._ddDate)}this._isInputMask&&(n._fullEdit=!0);if("checkedItems"==l){if(n.showFilterInput){n.showFilterInput=!1;n.showFilterInput=!0}if(null==u||0==u.length){n[l]=[];n.selectedIndex=0}}if(null!=u||!n.isRequired){if("checkedItems"==l){var h=[];if(n.selectedValuePath)for(var _loop_1=function(e){var t=n.collectionView.items.findIndex((function(t){return null!=u[e][n.selectedValuePath]&&t[n.selectedValuePath]===u[e][n.selectedValuePath]}));if(t>=0){n._lbx.toggleItemChecked(t);h.push(n.collectionView.items[t])}},f=0;f<u.length;f++)_loop_1(f);else e.isArray(u)?h=u:u.length>0&&(h=u.split(","));n[l]=h}else n[l]=u;if(this._isAutoComplete){clearTimeout(n._toSearch);if((g=n.collectionView)&&(g.filter||n._rxHighlight)){n._rxHighlight=null;g.filter=null}if(u){var p=n._findNext(u,1,-1);n.selectedIndex!=p&&(n.selectedIndex=p)}}}switch(c){case"keydown":case"mousedown":if(e.isUndefined(a.keyCode)||a.keyCode==e.Key.F4||a.altKey){d=this._isDropDown;if(this._isAutoComplete&&(null==u||e.isString(u))){var g;if(g=n.collectionView){if(g.filter||n._rxHighlight){n._rxHighlight=null;g.filter=null}p=u?n._findNext(u,1,-1):-1;n.selectedIndex!=p&&(n.selectedIndex=p)}}}}o.showPlaceholders&&!n.placeholder&&(r.placeholder=this._col.header);this._showEditor();o._edtHdl._fullEdit=!0;if(0==c.indexOf("key")&&32==a.keyCode){e.setSelectionRange(r,r.value.length);a.preventDefault()}if(e.isIE()&&!o.imeEnabled)if("keypress"==c&&a.key){setTimeout((function(){r.value=a.key;e.setSelectionRange(r,1);var t=document.createEvent("HTMLEvents");t.initEvent("input",!0,!1);r.dispatchEvent(t)}));a.preventDefault()}else if("compositionstart"==c){var _=r.value.length;e.setSelectionRange(r,_)}this._isDropDown&&(n.isDroppedDown=d)}};_CustomEditor.prototype._cellEditEnding=function(t,i){if(!i.cancel&&i.getColumn(!0)==this._col){var o=this.grid,n=this._ctl,r=this._prop;if(this._isAutoComplete){var l=n.selectedIndex;if(e.isNumber(l)&&l<0){var s=n.collectionView;s&&1==s.items.length?n.selectedIndex=0:this._col.isRequired&&(i.cancel=!0)}}if(!i.cancel&&r){var a=!1;if(this._isInputMask){var c=n;if(null!=c){o._edtHdl._setCustomEditorValue(c._msk._applyMask());a=!0}}a||o._edtHdl._setCustomEditorValue(n[r])}}};_CustomEditor.prototype._cellEditEnded=function(e,t){this._hideEditor();this._updateFocus()};_CustomEditor.prototype._cmpstart=function(t){var i=this;this.grid.imeEnabled&&(e.isIE()?setTimeout((function(){i._activateEditor(t)})):this._activateEditor(t))};_CustomEditor.prototype._keydown=function(t){if(!t.defaultPrevented&&this._checkColumn(t.target))if(this.grid.activeEditor){if(t.keyCode==e.Key.Enter&&this._isDropDown){var i=this._ctl;if(i.isDroppedDown){i.isDroppedDown=!1;t.preventDefault();t.stopImmediatePropagation()}}}else if(this._isDropDown){var o=t.keyCode;switch(o){case e.Key.F4:case e.Key.Up:case e.Key.Down:if(o==e.Key.F4||t.altKey){this._activateEditor(t);t.preventDefault()}}}};_CustomEditor.prototype._checkColumn=function(t){var i=this._g;if(e.contains(t,this._tbx)||null!=t&&this._imeEditor()===t){var o=i._selHdl.selection;return i._getBindingColumn(i.cells,o.row,i.columns[o.col])==this._col}return!1};_CustomEditor.prototype._mousedown=function(i){if(!i.defaultPrevented&&0==i.button&&!i.shiftKey&&!i.ctrlKey&&!i.metaKey&&this._isDropDown&&e.closestClass(i.target,t.CellFactory._WJC_DROPDOWN)){var o=this.grid,n=o.hitTest(i);if(!n._clickChildGrid&&n.getColumn(!0)==this._col){o.select(n.range);o.refresh();this._activateEditor(i);i.preventDefault()}}};_CustomEditor.prototype._activateEditor=function(e){var t=this.grid;if(!t.activeEditor){var i=t._selHdl.selection;if(i.isValid)return t.startEditing(!0,i.row,i.col,!0,e)}return!1};_CustomEditor.prototype._showEditor=function(){var t=this.grid,i=t.activeEditor,o=e.closest(i,".wj-cell");if(o){var n=this._tbx,r=this._ctl.hostElement;e.setCss(r,_CustomEditor._cssVisible);e.toggleClass(n,"wj-grid-ime",!1);o.innerHTML="";o.appendChild(r);t._edtHdl._edt=n;if(this._imeEditor())this._initImeEditInput();else{n.select();n.focus();i.value=""}}};_CustomEditor.prototype._hideEditor=function(){var t=this.grid,i=this._ctl.hostElement,o=this._tbx;this._isDropDown&&(this._ctl.isDroppedDown=!1);o.setCustomValidity("");var n=o.value;o.value=n+" ";o.value=n;e.setCss(i,_CustomEditor._cssHidden);e.toggleClass(o,"wj-grid-ime",!0);t&&i.parentElement!=t._root&&t._root.appendChild(i)};_CustomEditor.prototype._resetTabIndex=function(){this._tbx.tabIndex=-1};_CustomEditor.prototype._updateFocus=function(){var t=this.grid;if(t&&!t.activeEditor){var i=t.hostElement,o=".wj-flexgrid",n=this._tbx,r=e.getActiveElement(),l=t._getTabIndex();if(e.closest(r,o)==i)if(e.closest(n,o)!=i)this._hideEditor();else if(t.imeEnabled)n.tabIndex>-1&&(n.tabIndex=-1);else{var s=t._selHdl.selection,a=t._getBindingColumn(t.cells,s.row,t.columns[s.col]);if(a&&a==this._col&&t.canEditCell(s.row,s.col)){if(r!==n){t.activeCell&&(t.activeCell.tabIndex=-1);n.tabIndex=l;if(!t.isTouching){n.select();n.focus()}}}else if(n.tabIndex>-1){n.tabIndex=-1;r==n&&t.focus(!0)}}}};_CustomEditor.prototype._initImeEditInput=function(){var i=this,o=this._imeEditor();if(o){var n=this._tbx,r=n&&n.style.color,l=this._ctl,compEndEh_1=function(){o.removeEventListener("compositionend",compEndEh_1);e.setCss(o,t._ImeHandler._cssHidden);if(n){n.style.color=r;var gotF=function(){l.gotFocus.removeHandler(gotF);i._g._edtHdl._edt=n;var e=o.value;if(e){n.value=e;i._isInputMask?setTimeout((function(){_CustomEditor._setSelectionRange(n,e.length,e.length)}),0):_CustomEditor._setSelectionRange(n,e.length,e.length);var t=document.createEvent("HTMLEvents");t.initEvent("input",!0,!1);n.dispatchEvent(t)}};l.gotFocus.addHandler(gotF);n.focus()}};o.addEventListener("compositionend",compEndEh_1);n&&(n.style.color="transparent")}};_CustomEditor._setSelectionRange=function(t,i,o){void 0===o&&(o=i);if(e.contains(document.body,t)&&!t.disabled&&"none"!=t.style.display)try{t.setSelectionRange(e.asNumber(i),e.asNumber(o),e.isIE()?null:"backward");t.focus()}catch(e){}};_CustomEditor.prototype._imeEditor=function(){var t=this.grid;if(t&&t.imeEnabled){var i=e.getActiveElement();if(i&&(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement)&&e.hasClass(i,"wj-grid-ime"))return i}return null};_CustomEditor._cssHidden={position:"fixed",left:-32e3,top:-32e3,width:"1px",height:"1px",overflow:"hidden",border:"none"};_CustomEditor._cssVisible={position:"absolute",left:0,top:0,width:"100%",height:"100%"};return _CustomEditor}();t._CustomEditor=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None";e[e.MoveDown=1]="MoveDown";e[e.MoveAcross=2]="MoveAcross";e[e.Cycle=3]="Cycle";e[e.CycleOut=4]="CycleOut";e[e.CycleEditable=5]="CycleEditable"}(i=t.KeyAction||(t.KeyAction={}));var o=function(){function _KeyboardHandler(e){this._kaTab=i.None;this._kaEnter=i.MoveDown;this._g=e;var t=e.hostElement;e.addEventListener(t,"keypress",this._keypress.bind(this));e.addEventListener(t,"keydown",this._keydown.bind(this))}_KeyboardHandler.prototype._keydown=function(i){var o=this._g,n=o._edtHdl,r=o.selection,l=i.ctrlKey||i.metaKey,s=i.shiftKey,a=i.altKey,c=i.target,u=i.char||i.key,d=!0;if(!l&&!a&&u&&1==u.length&&e.closest(c,".wj-cell")&&c.firstElementChild&&(" "!=u||!s)){var h=c.querySelectorAll("."+t.CellFactory._WJC_RADIOMAP+" label input");if(h&&h.length){for(var f=-1,p=0;p<h.length;p++)if(h[p].checked){f=p;break}u=u.toLowerCase();for(p=0;p<h.length;p++){var g=h[(f+p+1)%h.length];if(" "==u||g.value.toLowerCase()[0]==u){g.click();break}}i.preventDefault();return}}if(!o._wantsInput(c)){var _=e.tryCast(o.rows[r.row],t.GroupRow),m=o.editableCollectionView,w=o._getKeyCode(i),C=t.SelMove,v=t.SelectionMode,y=i.defaultPrevented&&!(c instanceof HTMLInputElement);if((o.isRangeValid(r)&&!y||l&&65==w)&&(!o.activeEditor||!n._keydown(i)||o._isNativeCheckbox(o.activeEditor))){if(o.autoClipboard){if(l&&(67==w||45==w)){var b=new t.CellRangeEventArgs(o.cells,r);if(o.onCopying(b)){var R=t.HeadersVisibility,E=0!=(o.copyHeaders&R.Column),x=0!=(o.copyHeaders&R.Row),S=o.getClipString(null,!1,E,x)+"\r\n";o._eFocus.focus();e.Clipboard.copy(S);o.onCopied(b)}i.stopPropagation();return}if(l&&86==w||s&&45==w){o.isReadOnly||e.Clipboard.paste((function(e){o.setClipString(e)}));i.stopPropagation();return}}(s||l)&&"Space"==i.code&&(w=e.Key.Space);var H=i.target,M=H.closest(".wj-cell"),G=H&&M&&M["wj-cell-index"]&&M["wj-cell-index"].panel,T=[t.HeadersFocusability.Column,t.HeadersFocusability.All].includes(o.headersFocusability),P=[t.HeadersFocusability.Row,t.HeadersFocusability.All].includes(o.headersFocusability);switch(w){case e.Key.Space:if(M&&G&&[t.CellType.RowHeader,t.CellType.TopLeft,t.CellType.ColumnHeader].includes(G._ct)&&P){var F=o.activePanelType;o.activePanelType=F;var z=M.querySelector(".wj-cell-check"),I=z&&!z.checked;setTimeout((function(){o.activePanelType=F;M.classList.add("wj-focus-header-cell");o._hideMarquee();M.focus();I&&o._activeCell&&o._activeCell.classList.add("wj-state-multi-selected")}),200);o._activeCell=null}else if(s&&r.isValid)switch(o.selectionMode){case v.CellRange:case v.MultiRange:case v.Row:case v.RowRange:case v.ListBox:o.select(new t.CellRange(r.row,0,r.row,o.columns.length-1),!1)}else if(l&&r.isValid)switch(o.selectionMode){case v.CellRange:case v.MultiRange:o.select(new t.CellRange(0,r.col,o.rows.length-1,r.col),!1)}else{(d=this._startEditing(!0,i))&&setTimeout((function(){var t=o.activeEditor;if(t)if(t.disabled||t.readOnly&&!e.closest(t,".wj-control"))o.finishEditing();else if("checkbox"==t.type){e.setChecked(t,t.indeterminate||!t.checked);o.finishEditing()}}));d=!0}break;case 65:if(l)switch(o.selectionMode){case v.None:case v.Cell:break;default:o.selectAll()}else d=!1;break;case e.Key.Left:if(M&&G&&G._ct===t.CellType.ColumnHeader&&T){i.preventDefault();o._selHdl.moveSelection(t.SelMove.None,t.SelMove.Prev,!1)}else if(l||a)d=!1;else if(r.isValid&&0==r.leftCol&&_&&!_.isCollapsed&&_.hasChildren)_.isCollapsed=!0;else if(P&&_&&!_.isCollapsed&&_.hasChildren)_.isCollapsed=!0;else{if(o.selectionMode==v.None)return;this._moveSel(C.None,l?C.Home:C.Prev,s)}break;case e.Key.Right:if(M&&G&&G._ct===t.CellType.ColumnHeader&&T){i.preventDefault();o._selHdl.moveSelection(t.SelMove.None,t.SelMove.Next,!1)}else if(l||i.altKey)d=!1;else if(r.isValid&&0==r.leftCol&&_&&_.isCollapsed)_.isCollapsed=!1;else if(P&&_&&_.isCollapsed&&(!G||G&&G._ct===t.CellType.Cell))_.isCollapsed=!1;else{if(o.selectionMode==v.None)return;this._moveSel(C.None,l?C.End:C.Next,s)}break;case e.Key.Up:if(l)d=!1;else if(i.altKey&&n._toggleListBox(i))d=!0;else{if(o.selectionMode==v.None)return;this._moveSel(C.Prev,C.None,s)}break;case e.Key.Down:if(l)d=!1;else if(i.altKey&&n._toggleListBox(i))d=!0;else{if(o.selectionMode==v.None)return;this._moveSel(C.Next,C.None,s)}break;case e.Key.PageUp:this._moveSel(i.altKey?C.Home:C.PrevPage,C.None,s);if(o.rows.frozen&&o.selection.row<o.rows.frozen){var A=o.scrollPosition;A.y&&(o.scrollPosition=new e.Point(A.x,0))}break;case e.Key.PageDown:this._moveSel(i.altKey?C.End:C.NextPage,C.None,s);break;case e.Key.Home:this._moveSel(l?C.Home:C.None,C.Home,s);break;case e.Key.End:this._moveSel(l?C.End:C.None,C.End,s);break;case e.Key.Tab:if(!(d=this._performKeyAction(o.keyActionTab,s))&&!o.activeCell){o.focus(!0);if(o.imeEnabled){var D=o._imeHdl;D&&D._resetTabIndex()}else{(j=this._getCustomEditor(o,r.row,r.col))&&j._resetTabIndex()}}break;case e.Key.Enter:if(M&&G&&G._ct===t.CellType.ColumnHeader&&T){i.preventDefault();M.click();setTimeout((function(){o.activePanelType=t.CellType.ColumnHeader;M.classList.add("wj-focus-header-cell");o._hideMarquee();M.focus()}),30)}else if(M&&G&&G._ct===t.CellType.RowHeader&&P){i.preventDefault();o._selHdl.moveSelection(t.SelMove.Next,t.SelMove.None,!1)}else{var j;o.rows[r.row]instanceof t._NewRowTemplate||(d=this._performKeyAction(o.keyActionEnter,s));(j=this._getCustomEditor(o,r.row,r.col))||o.focus(!0);!s&&m&&null!=m.currentEditItem&&n._commitRowEdits()}break;case e.Key.Escape:d=!1;if(m&&(m.currentAddItem||m.currentEditItem)){var O=new t.CellRangeEventArgs(o.cells,o.selection);O.cancel=!0;o.onRowEditEnding(O);m.currentAddItem&&m.cancelNew();m.currentEditItem&&m.cancelEdit();o.onRowEditEnded(O);d=!0}o._mouseHdl.resetMouseState();break;case e.Key.Delete:case e.Key.Back:d=this._deleteSel(i);break;case e.Key.F2:d=this._startEditing(!0,i);break;case e.Key.F4:d=n._toggleListBox(i);break;default:d=!1}if(d){o.containsFocus()||o.focus();i.preventDefault();i.stopPropagation()}}}};_KeyboardHandler.prototype._performKeyAction=function(e,o){var n=i,r=t.SelMove;switch(e){case n.MoveDown:this._moveSel(o?r.Prev:r.Next,r.None,!1);return!0;case n.MoveAcross:this._moveSel(r.None,o?r.Prev:r.Next,!1);return!0;case n.Cycle:this._moveSel(r.None,o?r.PrevCell:r.NextCell,!1);return!0;case n.CycleEditable:this._moveSel(r.None,o?r.PrevEditableCell:r.NextEditableCell,!1);return!0;case n.CycleOut:var l=this._g.selection;this._moveSel(r.None,o?r.PrevCell:r.NextCell,!1);return!l.equals(this._g.selection)}return!1};_KeyboardHandler.prototype._keypress=function(t){var i=this,o=this._g;if(!o._wantsInput(t.target)&&!t.defaultPrevented){var n=o._edtHdl;if(o.activeEditor)n._keypress(t);else if(t.charCode>e.Key.Space&&"AltLeft"!=t.code&&"AltRight"!=t.code)if(this._startEditing(!1,t)&&o.activeEditor){var r=e.getActiveElement();if(r instanceof HTMLInputElement&&"checkbox"!=r.type||r instanceof HTMLTextAreaElement){var l=o._selHdl.selection,s=o.getCellData(l.row,l.col,!0),a=o.getCellData(l.row,l.col,!1),c=e.culture.Globalize.numberFormat["%"]||"%",u=String.fromCharCode(t.charCode),d=e.isNumber(a)&&s.indexOf(c)>-1||""==s&&r.value==c,h=!0,initEditor_1=function(){r.value=d?u+c:u;e.setSelectionRange(r,1);r.dispatchEvent(n._evtInput);n._keypress(t);n._edtValue=r.value!=s?r.value:null};if(o.imeEnabled){var f=this._getCustomEditor(o,l.row,l.col),p=f&&f.control;if(p&&!p._focus){var gotF_1=function(){p.gotFocus.removeHandler(gotF_1);h=!1;initEditor_1()};p.gotFocus.addHandler(gotF_1)}}h&&initEditor_1();t.preventDefault()}}else if(o.autoSearch){var g=!1;l=o._selHdl.selection;if(t.charCode>32||32==t.charCode&&this._search){t.preventDefault();this._search+=String.fromCharCode(t.charCode);this._toSearch&&clearTimeout(this._toSearch);this._toSearch=setTimeout((function(){i._toSearch=null;i._search=""}),e.Control._SEARCH_DELAY);var _=this._findNext(l.row,l.col);if(_<0&&this._search.length>1){this._search=this._search[this._search.length-1];_=this._findNext(l.row,l.col)}if(_>-1){g=!0;o.select(_,l.col)}}g||(this._search="")}}};_KeyboardHandler.prototype._getCustomEditor=function(e,t,i){var o=e._getBindingColumn(e.cells,t,e.columns[i]);return o&&o._edt};_KeyboardHandler.prototype._findNext=function(t,i){var o=this._g,n=o.rows.length;(t<0||1==this._search.length)&&t++;var r=this._search,l=o.caseSensitiveSearch;l||(r=r.toLowerCase());for(var s=o.columns[i].isContentHtml,a=0;a<n;a++){var c=(t+a)%n,u=o.getCellData(c,i,!0).trim();s&&(u=e.toPlainText(u));l||(u=u.toLowerCase());if(0==u.indexOf(r))return c}return-1};_KeyboardHandler.prototype._moveSel=function(e,i,o){var n=this._g,r=n.selectionMode,l=n._selHdl;if(r!=t.SelectionMode.None){r==t.SelectionMode.MultiRange&&l.extendedSelection.clear();l.moveSelection(e,i,o)}};_KeyboardHandler.prototype._deleteSel=function(e){var i=this,o=this._g,n=o.rows,r=o.editableCollectionView,l=o.selection,s=[],a=new t.CellRange,c=new t.CellEditEndingEventArgs(o.cells,a,e),u=t.SelectionMode;if(!o._edtHdl._allowEdit())return!1;if(o.allowDelete&&(null==r||r.canRemove&&!r.isAddingNew&&!r.isEditingItem)){if(0==(s=n.filter((function(e){return e.isSelected}))).length)switch(o.selectionMode){case u.CellRange:case u.MultiRange:var d=o._getDeleteColumnIndex();o.selectedRanges.forEach((function(e){if(e.leftCol==d&&e.rightCol==o.columns.length-1)for(var t=e.topRow;t>-1&&t<=e.bottomRow;t++){var i=n[t];s.indexOf(i)<0&&s.push(i)}}));break;case u.Row:l.topRow>-1&&s.push(n[l.topRow]);break;case u.RowRange:for(var h=l.topRow;h>-1&&h<=l.bottomRow;h++)s.push(n[h])}s=s.reduce((function(e,t){e.find((function(e){return e.dataItem===t.dataItem}))||e.push(t);return e}),[])}if(s.length>0){var f=0;o.deferUpdate((function(){r&&r.beginUpdate();for(var e=s.length-1;e>=0;e--){var i=s[e];if(!(i instanceof t._NewRowTemplate)){a.setRange(i.index,-1);o.onDeletingRow(c);if(!c.cancel){r&&i.dataItem?r.remove(i.dataItem):o.rows.removeAt(i.index);f++;o.onDeletedRow(c)}}}r&&r.endUpdate(!1)}));if(f>0){var p=l.topRow;p=Math.min(p,o.rows.length-1);for(;p>0&&o.rows[p]instanceof t._NewRowTemplate;)p--;l.row=l.row2=p;o.select(l,!1);o.childItemsPath&&r&&r.refresh()}return!0}if(0==s.length){o.deferUpdate((function(){var a=o.scrollPosition,c=-1;s=n.filter((function(e){return e.isSelected}));var d=o.selectedRanges.length>1||s.length>1||l.isValid&&n[l.row].dataItem!=n[l.row2].dataItem;r&&r.beginUpdate();if(s.length){var h=new t.CellRange(0,0,0,o.columns.length-1);s.forEach((function(t){h.row=h.row2=t.index;i._deleteRange(e,h);c=h.bottomRow}))}else{i._deleteRange(e,l);c=l.bottomRow;o.selectionMode==u.MultiRange&&o._selHdl.extendedSelection.forEach((function(t){i._deleteRange(e,t);c=t.bottomRow}))}o.select(l,!1);o.scrollPosition=a;if(r){if(d&&r.currentEditItem){r.commitEdit();var f=new t.CellRangeEventArgs(o.cells,new t.CellRange(c,-1));o.onRowEditEnding(f);o.onRowEditEnded(f)}r.endUpdate(!1)}}));return!0}return!1};_KeyboardHandler.prototype._deleteRange=function(e,i){for(var o=this._g,n=o.editableCollectionView,r=new t.CellRange,l=new t.CellEditEndingEventArgs(o.cells,r,e),s=new t.CellRangeEventArgs(o.cells,new t.CellRange(i.topRow,-1)),a=i.topRow;a<=i.bottomRow;a++){var c=o.rows[a];if(!c.isReadOnly)for(var u=i.leftCol;u<=i.rightCol;u++){var d=o._getBindingColumn(o.cells,a,o.columns[u]);if(!d.getIsRequired(c)&&!d.isReadOnly){var h=o.getCellData(a,u,!1);if(o.getCellData(a,u,!0)){r.setRange(a,u);l.cancel=!1;if(o.onBeginningEdit(l)){var f=c.dataItem,p=n?n.currentEditItem:null;if(p&&f!=p&&u===i.rightCol){o.onRowEditEnding(s);o.onRowEditEnded(s)}if(f!=p&&u===i.leftCol){s._rng.setRange(a,-1);o.onRowEditStarting(s);o.onRowEditStarted(s)}if(n){n.editItem(f);o._edtHdl._edItem=f}o.setCellData(a,u,"",!0,!1);l.previousData=h;o.onCellEditEnding(l);o.onCellEditEnded(l)}}}}}};_KeyboardHandler.prototype._startEditing=function(e,t,i,o){return this._g._edtHdl.startEditing(e,i,o,!0,t)};return _KeyboardHandler}();t._KeyboardHandler=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i,o,n="wj-flexgrid";!function(e){e[e.None=0]="None";e[e.Columns=1]="Columns";e[e.Rows=2]="Rows";e[e.Both=3]="Both";e[e.ColumnsAllCells=4|e.Columns]="ColumnsAllCells";e[e.RowsAllCells=4|e.Rows]="RowsAllCells";e[e.BothAllCells=4|e.Both]="BothAllCells"}(i=t.AllowResizing||(t.AllowResizing={}));!function(e){e[e.None=0]="None";e[e.Headers=1]="Headers";e[e.Cells=2]="Cells";e[e.Both=3]="Both"}(t.AutoSizeMode||(t.AutoSizeMode={}));!function(e){e[e.None=0]="None";e[e.Columns=1]="Columns";e[e.Rows=2]="Rows";e[e.Both=3]="Both"}(o=t.AllowDragging||(t.AllowDragging={}));var r=function(){function _MouseHandler(i){var o=this,r=i.hostElement,l=i.addEventListener.bind(i),s=i.removeEventListener.bind(i);this._g=i;this._dvMarker=e.createElement('<div class="wj-marker">&nbsp;</div>');l(r,"mousedown",(function(r){i._rcBounds=null;if(!r.defaultPrevented&&0==r.button){var a=r.target;if(!i.containsFocus()){var c=a instanceof HTMLElement&&a.tabIndex>-1?a:i._eFocus;i._setFocusNoScroll(c)}setTimeout((function(){r.defaultPrevented||i.focus()}));var u=e.closestClass(a,n);if(u&&u!=i.hostElement||!i.activeEditor&&i._isInputElement(a)&&!o._hasRadioMap(r)&&!i._isNativeCheckbox(a)){var d=i.hitTest(r),h=t.CellType;switch(d.cellType){case h.Cell:i.select(d.range,!1);a instanceof HTMLElement&&"root"!=a.getAttribute("wj-part")&&a.focus();break;case h.ColumnHeader:case h.ColumnFooter:i.scrollIntoView(-1,d.col);break;case h.RowHeader:i.scrollIntoView(d.row,-1)}e.isIE()&&d.cellType!=h.Cell&&i._isInputElement(a)&&a.focus();return}if(i._isNativeCheckbox(a)&&e.hasClass(a,"wj-column-selector")&&i.hitTest(r).cellType==t.CellType.RowHeader)return;var f=document;s(f,"mousemove");s(f,"mouseup");l(f,"mousemove",mouseMove);l(f,"mouseup",mouseUp);o._isDown=!0;o._mousedown(r)}}));var mouseMove=function(e){o._mousemove(e)},mouseUp=function(e){o._isDown=!1;s(document,"mousemove");s(document,"mouseup");o._mouseup(e)};l(r,"mouseenter",(function(e){i._rcBounds=null}));l(r,"mousemove",this._hover.bind(this));l(r,"dblclick",this._dblclick.bind(this));l(r,"click",this._click.bind(this));l(r,"selectstart",(function(e){i._isInputElement(e.target)||e.preventDefault()}));e.isSafari()&&l(r,"mousewheel",(function(e){e.defaultPrevented||!e.wheelDeltaY||e.ctrlKey||e.metaKey||(i._isScrollingByWheel=!0)}));l(r,"wheel",(function(t){if(!t.defaultPrevented&&t.deltaY&&!t.ctrlKey&&!t.metaKey){var o=i._root,r=t.deltaY;if((t.shiftKey?o.scrollWidth>o.clientWidth:o.scrollHeight>o.clientHeight)&&e.closestClass(t.target,n)==i.hostElement){switch(t.deltaMode){case 1:r=i.rows.defaultSize*(r<0?-1:1);break;case 2:r=(t.shiftKey?o.clientWidth:o.clientHeight)*(r<0?-1:1);break;case 0:default:e.isSafari()&&(r=e.clamp(r,-150,150))}i._isScrollingByWheel=!0;e.isEdge()&&(e.Control.sharedState.InvalidScroll=!1);i.finishEditing(!1)&&(t.shiftKey?o.scrollLeft+=r:o.scrollTop+=r);t.preventDefault();t.stopImmediatePropagation()}}}));l(r,"dragstart",this._dragstart.bind(this));l(r,"dragover",this._dragover.bind(this));l(r,"dragleave",this._dragleave.bind(this));l(r,"drop",this._drop.bind(this));l(r,"dragend",this._dragend.bind(this))}_MouseHandler.prototype.resetMouseState=function(){var t=this._g,i=t.hostElement;if(this._updating){this._updating=!1;t.endUpdate()}this._dragSrc&&e.removeClass(this._dragSrc,"wj-state-dragsrc");this._showDragMarker(null);i&&(i.style.cursor="");e.isSafari()&&this._szRowCol&&t.invalidate();t.removeEventListener(document,"mousemove");t.removeEventListener(document,"mouseup");this._eMouse=null;this._isDown=null;this._htDown=null;this._lbSelState=null;this._lbSelStateRows={};this._lbSel=null;this._szRowCol=null;this._szArgs=null;t._rcBounds=null;this._anchorCol=-1};_MouseHandler.prototype._mousedown=function(n){var r=this._g,l=n.target,s=r.hitTest(n),a=s.cellType,c=t.CellType,u=n.ctrlKey||n.metaKey;this._selDown=r.selection;this._ignoreClick=!1;if(null==s.panel&&null==r.cells||s.panel&&r.cells&&s.panel._uid==r.cells._uid){if(e.closestClass(l,t.CellFactory._WJC_DROPDOWN)){var d=r.hitTest(l);r._edtHdl._toggleListBox(n,d.range);n.preventDefault();this._ignoreClick=!0;return}var h=r.editRange;if(h&&h.contains(s.range)){e.Control.sharedState.InvalidScroll=e.isEdge();return}}var f=e.getActiveElement();if(l!=f||!r._isInputElement(l))if(a!=c.None){this._htDown=s;this._eMouse=n;this._anchorCol=s.col;if(null==this._szRowCol){var p=r.allowResizing,g=i;if((a==c.RowHeader||a==c.TopLeft)&&s.edgeBottom&&p&g.Rows&&this._getResizeRowHt(s))this._ignoreClick=!0;else if((a==c.ColumnHeader||a==c.TopLeft)&&s.edgeRight&&p&g.Columns&&this._getResizeColHt(s))this._ignoreClick=!0;else{var _=r.allowDragging,m=o;switch(a){case c.Cell:case c.RowHeader:if(u&&r.selectionMode==t.SelectionMode.ListBox){this._lbSelState=r.rows[s.row].isSelected;e.closest(l,".wj-elem-collapse")&&(this._lbSelState=!1)}this._mouseSelect(n,n.shiftKey);if(a==c.RowHeader&&!(_&m.Rows)){n.preventDefault();r.focus()}break;case c.ColumnHeader:r.allowSorting||_&m.Columns||e.closest(l,"button")||this._mouseSelect(n,n.shiftKey)}}}else{var w=r._eFocus;if(f!=w){w.tabIndex=0;w.focus()}this._ignoreClick=!0;this._handleResizing(n)}}else{r.finishEditing();l!=r._root&&l!=r._fCt&&r._edtHdl._commitRowEdits()}};_MouseHandler.prototype._mousemove=function(e){if(this._htDown&&!e.defaultPrevented){if(0==e.buttons&&this._eMouse&&e.timeStamp-this._eMouse.timeStamp>600){this.resetMouseState();return}this._eMouse=e;if(this._szRowCol)this._handleResizing(e);else{var i=this._g,n=i.allowDragging,r=o,l=t.CellType;switch(this._htDown.cellType){case l.Cell:this._mouseSelect(e,!0);break;case l.RowHeader:n&r.Rows||this._mouseSelect(e,!0);break;case l.ColumnHeader:n&r.Columns||i.allowSorting||this._mouseSelect(e,!0)}}}};_MouseHandler.prototype._mouseup=function(e){var i=this._g;if(!i.isTouching||!(this._dragSrc||e.target instanceof HTMLHtmlElement)){var o=i.hitTest(e),n=this._htDown;if(n&&!e.defaultPrevented){this._szArgs&&this._finishResizing(e);if(!this._szArgs&&(null==o.panel&&null==n.panel||o.panel&&n.panel&&o.panel._uid==n.panel._uid)&&o.row==n.row&&o.col==n.col){var r=o.getColumn();if(r){if(!(r._getFlag(t.RowColFlags.HasTemplate)&&!r.cellTemplate)){var l=o.target;if(l!=n.target&&l instanceof HTMLElement){if(n.target instanceof HTMLInputElement){var s=o.point,a=n.point;Math.abs(s.x-a.x)+Math.abs(s.y-a.y)<10&&(l=l.querySelector("input")||l)}var c=document.createEvent("Event");c.initEvent("click",!0,!0);for(var u in e)/Key$|X$|Y$|^button|^(x|y|which)$/.test(u)&&(c[u]=e[u]);l.dispatchEvent(c)}}}}}this.resetMouseState()}};_MouseHandler.prototype._click=function(i){if(this._ignoreClick){this._ignoreClick=!1;i.preventDefault()}if(!i.defaultPrevented){var o=this._g,n=i.target,r=o.hitTest(n),l=e.tryCast(n,HTMLInputElement),s="input."+t.CellFactory._WJC_CHECKBOX;if(!l){var a=e.closest(n,"label");a&&(l=a.querySelector(s))}!l&&o.bigCheckboxes&&(l=n.querySelector(s));if(l!=o.activeEditor&&o._isNativeCheckbox(l)){if(null==r.panel&&null==o.cells||r.panel&&o.cells&&r.panel._uid==o.cells._uid){var c=o.getCellData(r.row,r.col,!1);if(o.startEditing(!1,r.row,r.col,!1,i)){o.activeEditor.checked=!c;o.finishEditing();o.focus()}else"boolean"!=typeof c&&null!=c||(l.checked=c)}return}if(this._hasRadioMap(i)){this._handleClick(i);return}var u=i.ctrlKey||i.metaKey;if(o.rows.maxGroupLevel>-1&&e.closestClass(n,t.CellFactory._WJC_COLLAPSE)){var d=o.rows[r.row];if(null==r.panel&&null==o.cells||r.panel&&o.cells&&r.panel._uid==o.cells._uid&&d instanceof t.GroupRow){u?o.collapseGroupsToLevel(d.isCollapsed?d.level+1:d.level):d.isCollapsed=!d.isCollapsed;return}}if(!u&&!i.shiftKey&&!o.activeEditor&&(null==r.panel&&null==o.cells||r.panel&&o.cells&&r.panel._uid==o.cells._uid)){var h=o._selHdl.selection;if(h.equals(this._selDown)&&r.range.contains(h)){o.startEditing(!0,null,null,!0,i);return}}this._handleClick(i)}};_MouseHandler.prototype._handleClick=function(i){var o=this._g,n=i.target,r=o.hitTest(n),l=i.ctrlKey||i.metaKey,s=r.panel;if(!i.defaultPrevented&&r.grid&&o&&r.grid._uid==o._uid){if(s&&o.cells&&s._uid==o.cells._uid&&this._hasRadioMap(i)){var a=e.closest(n,"label"),c=a&&a.querySelector("input");c&&!c.disabled&&o.startEditing(!1,r.row,r.col,!1,i)&&o.finishEditing()&&(o._edtHdl._edtCanceled?i.preventDefault():o.setCellData(r.row,r.col,a.textContent,!0,o.refreshOnEdit));return}if(!o._isInputElement(n)){if(s&&o.topLeftCells&&s._uid==o.topLeftCells._uid){var u=t.SelectionMode;switch(o.selectionMode){case u.None:case u.Cell:break;default:o.selectAll()}return}if(s&&o.columnHeaders&&s._uid==o.columnHeaders._uid){if(o.allowPinning&&e.closestClass(n,t.CellFactory._WJC_PIN))this._clickPin(i,r);else if(!o._isTransposed()&&e.closestClass(i.target,t.CellFactory._WJC_COLLAPSE)){if(g=o._getColumnGroup(r.row,r.col))if(l){for(var d=g.isCollapsed,h=g.level,f=[],p=0;p<o.columns.length;p++)if((g=o._getColumnGroup(r.row,p))&&g.collapseTo&&g.level==h&&f.indexOf(g)<0){f.push(g);g.isCollapsed=!d}}else g.isCollapsed=!g.isCollapsed}else{n instanceof HTMLSpanElement&&n.parentElement instanceof HTMLLabelElement&&(n=n.parentElement.querySelector("input"));n instanceof HTMLInputElement||this._clickSort(i,r);o.focus()}return}if(s&&o.rowHeaders&&s._uid==o.rowHeaders._uid){if(o._isTransposed()&&e.closestClass(i.target,t.CellFactory._WJC_COLLAPSE)){var g;if(g=o._getColumnGroup(r.row,r.col))if(l){d=g.isCollapsed,h=g.level,f=[];for(var _=0;_<o.rows.length;_++)if((g=o._getColumnGroup(_,r.col))&&g.collapseTo&&g.level==h&&f.indexOf(g)<0){f.push(g);g.isCollapsed=!d}}else g.isCollapsed=!g.isCollapsed}return}if(s&&o.cells&&s._uid==o.cells._uid){if(r.row<0){this._clickSort(i,r);return}if(e.closestClass(n,t.CellFactory._WJC_COLLAPSE)){var m=o.rows[r.row];m instanceof t.GroupRow&&(l?o.collapseGroupsToLevel(m.isCollapsed?m.level+1:m.level):m.isCollapsed=!m.isCollapsed);return}e.closestClass(n,t.CellFactory._WJC_DROPDOWN)&&o._edtHdl._toggleListBox(i,r.range)}}}};_MouseHandler.prototype._hasRadioMap=function(i){var o=i.target;if(e.closest(o,"label")){var r=e.closestClass(o,t.CellFactory._WJC_RADIOMAP);return e.closestClass(r,n)==this._g.hostElement}return!1};_MouseHandler.prototype._clickSort=function(i,o){var n=this._g,r=n.allowSorting,l=n.collectionView,s=l?l.sortDescriptions:null,a=i.ctrlKey||i.metaKey,c=i.shiftKey;if(l&&l.canSort&&r!=t.AllowSorting.None){var u=o.panel.columns[o.col],d=n._getBindingColumn(o.panel,o.row,u),h=d?d._getBindingSort():null;if(d.allowSorting&&h){if(u&&d&&u._uid==d._uid){var f=n.getMergedRange(o.panel,o.row,o.col,!1);if(f&&f.columnSpan>1)return}var p=new t.CellRangeEventArgs(o.panel,o.range,i);if(n.onSortingColumn(p)){n._edtHdl._commitRowEdits();for(var g=-1,_=null,m=0;m<s.length;m++)if(s[m].property==h){g=m;_=s[m];break}s.deferUpdate((function(){if(a&&c)s.clear();else if(_){var i=a;!i&&n.isTouching&&(i=0==_.ascending);i?s.removeAt(g):s[g]=new e.collections.SortDescription(h,!_.ascending)}else{r!=t.AllowSorting.MultiColumn&&s.clear();var o=new e.collections.SortDescription(h,!0);s.push(o)}}));n.onSortedColumn(p)}}}};_MouseHandler.prototype._clickPin=function(e,i){var o=this._g,n=o.columns,r=n.frozen,l=o.allowPinning;l==t.AllowPinning.Both&&(l=e.shiftKey?t.AllowPinning.ColumnRange:t.AllowPinning.SingleColumn);var s=new t.CellRangeEventArgs(o.cells,i.range);if(o.onPinningColumn(s)){if(l==t.AllowPinning.SingleColumn)if(i.col>=r){n.moveElement(i.col,r,!1);n.frozen++}else{n.moveElement(i.col,r-1,!1);n.frozen--}l==t.AllowPinning.ColumnRange&&(i.col+1!=r?n.frozen=i.col+1:n.frozen=0);o.onPinnedColumn(s)}};_MouseHandler.prototype._dblclick=function(e){if(!e.defaultPrevented){var o,n=this._g,r=n.hitTest(e),l=e.ctrlKey||e.metaKey,s=r.range,a=r.cellType,c=t.CellType,u=n.selection,d=n.allowResizing,h=i;if(r.edgeRight&&d&h.Columns){if(a==c.TopLeft){if(r.panel.columns[r.col].allowResizing){o=new t.CellRangeEventArgs(r.panel,new t.CellRange(-1,r.col));if(n.onAutoSizingColumn(o)&&n.onResizingColumn(o)){this._ignoreClick=!0;n.autoSizeColumn(r.col,!0);n.onAutoSizedColumn(o);n.onResizedColumn(o);e.preventDefault()}}}else if(a==c.ColumnHeader||4&d){a==c.ColumnHeader&&l&&u.containsColumn(r.col)&&(s=u);for(var f=a==c.RowHeader||a==c.BottomLeft,p=s.leftCol;p<=s.rightCol;p++)if(r.panel.columns[p].allowResizing){o=new t.CellRangeEventArgs(r.panel,new t.CellRange(-1,p));if(n.onAutoSizingColumn(o)&&n.onResizingColumn(o)){this._ignoreClick=!0;n.autoSizeColumn(p,f);n.onResizedColumn(o);n.onAutoSizedColumn(o);e.preventDefault()}}}this.resetMouseState()}else if(r.edgeBottom&&d&h.Rows){if(a==c.TopLeft||a==c.BottomLeft){if(r.getRow().allowResizing){f=a==c.TopLeft||null;o=new t.CellRangeEventArgs(r.panel,new t.CellRange(r.row,-1));if(n.onAutoSizingRow(o)&&n.onResizingRow(o)){this._ignoreClick=!0;n.autoSizeRow(r.row,f);n.onResizedRow(o);n.onAutoSizedRow(o);e.preventDefault()}}}else if(a==c.RowHeader||4&d){var g=r.panel;f=g==n.columnHeaders||g==n.columnFooters&&null;l&&u.containsRow(r.row)&&g&&n.cells&&g._uid==n.cells._uid&&(s=u);for(var _=s.topRow;_<=s.bottomRow;_++)if(g.rows[_].allowResizing){o=new t.CellRangeEventArgs(g,new t.CellRange(_,-1));if(n.onAutoSizingRow(o)&&n.onResizingRow(o)){this._ignoreClick=!0;n.autoSizeRow(_,f);n.onResizedRow(o);n.onAutoSizedRow(o);e.preventDefault()}}}this.resetMouseState()}else;}};_MouseHandler.prototype._hover=function(e){if(!this._isDown){var i=this._g,o=i.hitTest(e),n="";this._szRowCol=this._getResizeColHt(o)||this._getResizeRowHt(o);this._szRowCol instanceof t.Column?n="col-resize":this._szRowCol instanceof t.Row&&(n="row-resize");this._szStart=this._szRowCol?this._szRowCol.renderSize:0;i.hostElement.style.cursor=n;return o}return null};_MouseHandler.prototype._getResizeColHt=function(e){var o,n=this._g.allowResizing,r=e.cellType,l=t.CellType;if(n&i.Columns&&(r==l.ColumnHeader||r==l.TopLeft||4&n)){e.edgeRight&&(o=e.getColumn());e.edgeFarRight&&(o=this._getResizeCol(e.panel,e.col)||e.getColumn());e.edgeLeft&&(o=this._getResizeCol(e.panel,e.col,!0)||o)}return o&&o.allowResizing?o:null};_MouseHandler.prototype._getResizeRowHt=function(e){var o,n=this._g.allowResizing,r=i,l=e.cellType,s=t.CellType;if(n&r.Rows&&(l==s.RowHeader||l==s.TopLeft||4&n)){e.edgeBottom&&(o=e.getRow());e.edgeFarBottom&&(o=this._getResizeRow(e.panel,e.row)||e.getRow());e.edgeTop&&(o=this._getResizeRow(e.panel,e.row,!0)||o)}return o&&o.allowResizing?o:null};_MouseHandler.prototype._getResizeCol=function(e,i,o){void 0===o&&(o=!1);var n=this._g,r=e.columns;if(o){for(var l=i-1;l>=0;l--){if((s=r[l]).isVisible)return this._asResizable(s)}if(r==n.columns&&0!=(n.headersVisibility&t.HeadersVisibility.Row))for(l=(r=n.rowHeaders.columns).length-1;l>=0;l--){if((s=r[l]).isVisible)return this._asResizable(s)}return null}for(l=i+1;l<r.length;l++){if((s=r[l]).isVisible)return this._asResizable(s)}if(i==r.length-1&&r==n.rowHeaders.columns){r=n.columns;for(l=0;l<r.length;l++){var s;if((s=r[l]).isVisible)return this._asResizable(s)}}return null};_MouseHandler.prototype._getResizeRow=function(e,i,o){void 0===o&&(o=!1);var n=this._g,r=e.rows;if(o){for(var l=i-1;l>=0;l--){if((s=r[l]).isVisible)return this._asResizable(s)}if(r==n.rows&&0!=(n.headersVisibility&t.HeadersVisibility.Column))for(l=(r=n.columnHeaders.rows).length-1;l>=0;l--){if((s=r[l]).isVisible)return this._asResizable(s)}return null}for(l=i+1;l<r.length;l++){if((s=r[l]).isVisible)return this._asResizable(s)}if(i==r.length-1&&r==n.columnHeaders.rows){r=n.rows;for(l=0;l<r.length;l++){var s;if((s=r[l]).isVisible)return this._asResizable(s)}}return null};_MouseHandler.prototype._asResizable=function(e){return 0==e.renderSize&&e.allowResizing?e:null};_MouseHandler.prototype._mouseSelect=function(i,o){var n=this,r=this._g;if(i&&this._htDown&&this._htDown.panel&&r.selectionMode!=t.SelectionMode.None){var l=new t.HitTestInfo(this._htDown.panel,i);this._handleSelection(l,o);!e.isIE9()&&i.button>=0&&i.target!=r._root&&((l=new t.HitTestInfo(r,i)).panel||setTimeout((function(){n._isDown&&n._eMouse&&n._mouseSelect(n._eMouse,o)}),100))}};_MouseHandler.prototype._handleResizing=function(i){"mousedown"==i.type&&(e.isSafari()?e.setAttribute(i.target,"draggable",null):i.preventDefault());var o=this._szRowCol,n=t.CellType;if(o instanceof t.Column){var r=this._g,l=e.mouseToPage(i).x,s=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(l-this._htDown.point.x)*(r.rightToLeft?-1:1)));if(o.renderSize!=s){if(null==this._szArgs){var a=r.rowHeaders.columns.indexOf(o)>-1?r.rowHeaders:r.cells;this._szArgs=new t.CellRangeEventArgs(a,new t.CellRange(-1,o.index))}this._szArgs.cancel=!1;if(r.onResizingColumn(this._szArgs))if(r.deferResizing){var c=r.columns.indexOf(o);if(r.columns.isFrozen(c)&&(this._htDown.cellType==n.ColumnHeader||this._htDown.cellType===n.Cell)){for(var u=0,d=0;d<r.columns.frozen;d++)d!=c&&(u+=null==r.columns[d].width?r.columns[d].renderWidth:r.columns[d].width);var h=r._szClient.width-u-5;s>h&&(s=h)}this._showResizeMarker(s)}else o.width=s}}var f=this._szRowCol;if(f instanceof t.Row){r=this._g;var p=e.mouseToPage(i).y;s=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(p-this._htDown.point.y)));if(f.renderSize!=s){if(null==this._szArgs){a=r.columnHeaders.rows.indexOf(f)>-1?r.columnHeaders:r.columnFooters.rows.indexOf(f)>-1?r.columnFooters:r.cells;this._szArgs=new t.CellRangeEventArgs(a,new t.CellRange(f.index,-1))}this._szArgs.cancel=!1;if(r.onResizingRow(this._szArgs))if(r.deferResizing){var g=r.rows.indexOf(f);if(r.rows.isFrozen(g)&&(this._htDown.cellType==n.RowHeader||this._htDown.cellType===n.Cell)){var _=0;for(d=0;d<r.rows.frozen;d++)d!=g&&(_+=null==r.rows[d].height?r.rows[d].renderHeight:r.rows[d].height);var m=r._szClient.height-_-5;s>m&&(s=m)}this._showResizeMarker(s)}else f.height=s}}this._szArgs&&i.preventDefault()};_MouseHandler.prototype._dragstart=function(i){var n=this._g,r=this._htDown,l=o,s=t.CellType;if(r){this._dragSrc=null;this._htDrag=null;this._chldColGrpMarker=!1;if(!this._szRowCol){var a=new t.CellRangeEventArgs(r.panel,r.range),c=n.allowDragging,u=r.cellType,d=r.panel.rows,h=r.getColumn(!0);h&&h.allowDragging&&(u==s.ColumnHeader||u==s.TopLeft)&&c&l.Columns&&(n.onDraggingColumn(a)?this._dragSrc=i.target:i.preventDefault());if(!this._dragSrc&&r.row>-1&&d[r.row].allowDragging){var f=d[r.row];f instanceof t.GroupRow||f instanceof t._NewRowTemplate||u==s.RowHeader&&c&l.Rows&&(n.onDraggingRow(a)?this._dragSrc=i.target:i.preventDefault())}}if(this._dragSrc&&i.dataTransfer&&!i.defaultPrevented){this._htDrag=r;e._startDrag(i.dataTransfer,"move");i.stopPropagation();e.addClass(this._dragSrc,"wj-state-dragsrc");n.beginUpdate();this._updating=!0}}};_MouseHandler.prototype._dragend=function(e){this._dragSrc=null;this._htDrag=null;this.resetMouseState()};_MouseHandler.prototype._dragover=function(i){var o=this._g,n=this._hitTest(i),r=this._dragSrc?this._htDrag:null,l=t.CellType,s=!1;if(r&&n.cellType==r.cellType){var a=new t.CellRangeEventArgs(n.panel,n.range,r);if(n.cellType==l.ColumnHeader&&o._hasColumnGroups()){a.cancel=!o._canMoveColumnGroup(r.row,r.col,n.row,n.col);s=o.onDraggingColumnOver(a)}else if(n.cellType==l.ColumnHeader){a.cancel=!o.columns.canMoveElement(r.col,n.col);s=o.onDraggingColumnOver(a)}else if(n.cellType==l.RowHeader){a.cancel=!o.rows.canMoveElement(r.row,n.row);s=o.onDraggingRowOver(a)}else if(n.cellType==l.TopLeft){a.cancel=!o.topLeftCells.columns.canMoveElement(r.col,n.col);s=o.onDraggingColumnOver(a)}}if(s){i.dataTransfer.dropEffect="move";i.preventDefault();i.stopPropagation();this._showDragMarker(n)}else this._showDragMarker(null);if(r&&o.autoScroll){var c=o.controlRect,u=o.scrollPosition,d=e.Control._DRAG_SCROLL_EDGE,h=e.Control._DRAG_SCROLL_STEP;if(r.panel==o.columnHeaders){i.pageX-c.left<d&&(u.x+=h);c.right-i.pageX<d&&(u.x-=h)}else if(r.panel==o.rowHeaders){i.pageY-c.top<d&&(u.y+=h);c.bottom-i.pageY<d&&(u.y-=h)}if(!u.equals(o._ptScrl)){o.scrollPosition=u;o._rcBounds=null}}};_MouseHandler.prototype._dragleave=function(e){this._showDragMarker(null)};_MouseHandler.prototype._drop=function(e){var i=this._g,o=this._hitTest(e),n=this._dragSrc?this._htDrag:null,r=t.CellType;if(n&&o.cellType==n.cellType){var l=i.selection,s=new t.CellRangeEventArgs(o.panel,o.range,n);if(o.cellType==r.ColumnHeader&&i._hasColumnGroups()){var a=i._getColumnGroup(n.row,n.col).columns.length,c=a>0?a:1,u=i.columns.frozen;i._moveColumnGroup(n.row,n.col,o.row,o.col,this._chldColGrpMarker);n.col<u&&o.col>=u?i.columns.frozen-=c:n.col>=u&&o.col<u&&(i.columns.frozen+=c);i.select(l.row,o.col);i.onDraggedColumn(s)}else if(o.cellType==r.ColumnHeader){i.columns.moveElement(n.col,o.col);i.select(l.row,o.col);i.onDraggedColumn(s)}else if(o.cellType==r.RowHeader){i.rows.moveElement(n.row,o.row);i.select(o.row,l.col);i.onDraggedRow(s)}else if(o.cellType==r.TopLeft){i.topLeftCells.columns.moveElement(n.col,o.col);i.onDraggedColumn(s)}}this.resetMouseState()};_MouseHandler.prototype._hitTest=function(e){var t=this._g;t._rcBounds=null;return t.hitTest(e)};_MouseHandler.prototype._showResizeMarker=function(i){var o,n=this._g,r=n._ptScrl,l=this._szArgs.panel.cellType,s=t.CellType,a=this._dvMarker,c=n.cells.hostElement;a.parentElement!=c&&c.appendChild(a);if(this._szRowCol instanceof t.Column){o={left:this._szRowCol.pos+i-1,top:-1e3,right:"",bottom:0,width:3,height:""};l!=s.TopLeft&&l!=s.RowHeader||(o.left-=n._eTL.offsetWidth+r.x);l==s.Cell&&this._szRowCol.index<n.columns.frozen&&(o.left-=r.x);n.rightToLeft&&(o.left=c.clientWidth-o.left-o.width)}else{o={left:-1e3,top:this._szRowCol.pos+i-1,right:0,bottom:"",width:"",height:3};l!=s.TopLeft&&l!=s.ColumnHeader||(o.top-=n._eTL.offsetHeight+r.y);l==s.Cell&&this._szRowCol.index<n.rows.frozen&&(o.top-=r.y)}e.setCss(a,o)};_MouseHandler.prototype._showDragMarker=function(i){var o=this._dvMarker;if(i&&i.panel){if(!i.range.equals(this._rngTarget)){this._rngTarget=i.range;var n=i.panel.hostElement;o.parentElement!=n&&n.appendChild(o);var r=this._g,l=r._ptScrl,s=t.CellType,a={left:0,top:0,width:6,height:6,right:"",bottom:""};switch(i.cellType){case s.ColumnHeader:var c=r._getColumnGroup(i.row,i.col);if(c){var u=c._rng,d=i.panel.rows,h=i.panel.columns;if(c.isEmpty&&null===c.binding){var f=d[u.bottomRow],p=h[u.leftCol],g=r.rightToLeft,_=g?o.parentElement.clientWidth-i.point.x:i.point.x,m=Math.max(p.renderWidth/5,_MouseHandler._SZ_MAX_COLGRP_EDGE),w=p.pos+m,C=p.pos+p.renderWidth-m,v=this._htDown&&i.col>this._htDown.col;if(!v&&_>w||v&&_<C){a.top=f.pos-a.height/2+f.renderHeight;a.left=g?o.parentElement.clientWidth-p.pos-p.renderWidth:p.pos;a.width=p.renderWidth;this._chldColGrpMarker=!0;break}}this._chldColGrpMarker=!1;a.top=0;a.height=0;for(var y=0;y<u.topRow;y++)a.top+=d[y].renderHeight;for(y=u.topRow;y<=u.bottomRow;y++)a.height+=d[y].renderHeight;a.left=0;if(this._htDown&&i.col>this._htDown.col){var b=h[u.rightCol];a.left=b.pos-a.width/2+b.renderWidth}else{var R=h[u.leftCol];a.left=R.pos-a.width/2}r.rightToLeft&&(a.left=o.parentElement.clientWidth-a.left-a.width);break}case s.TopLeft:case s.ColumnHeader:var E=i.panel.columns[i.col];a.left=E.pos-a.width/2;a.height=i.panel.height;this._htDown&&i.col>this._htDown.col&&(a.left+=E.renderWidth);i.cellType==s.ColumnHeader&&i.col<r.columns.frozen&&(a.left-=l.x);r.rightToLeft&&(a.left=o.parentElement.clientWidth-a.left-a.width);break;case s.RowHeader:var x=i.getRow();a.top=x.pos-a.height/2;a.width=i.panel.width;i.row>this._htDown.row&&(a.top+=x.renderHeight);i.row<r.rows.frozen&&(a.top-=l.y)}e.setCss(o,a)}}else{e.removeChild(o);this._rngTarget=null}};_MouseHandler.prototype._finishResizing=function(i){var o=this._g,n=o.selection,r=this._szArgs,l=this._eMouse,s=l&&(l.ctrlKey||l.metaKey),a=t.CellType;if(r&&!r.cancel){if(r.col>-1){var c=r.col,u=e.mouseToPage(i).x,d=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(u-this._htDown.point.x)*(this._g.rightToLeft?-1:1)));if(o.columns.isFrozen(c)&&(this._htDown.cellType==a.ColumnHeader||this._htDown.cellType===a.Cell)){for(var h=0,f=0;f<o.columns.frozen;f++)f!=c&&(h+=null==o.columns[f].width?o.columns[f].renderWidth:o.columns[f].width);var p=o._szClient.width-h-5;d>p&&(d=p)}r.panel.columns[c].width=Math.round(d);o.onResizedColumn(r);if(s&&this._htDown.cellType==a.ColumnHeader&&n.containsColumn(c)){for(var g=o.columns[c].size,_=n.leftCol;_<=n.rightCol;_++)if(o.columns[_].allowResizing&&_!=c){r=new t.CellRangeEventArgs(o.cells,new t.CellRange(-1,_));if(o.onResizingColumn(r)){if(o.columns.isFrozen(_)){h=o.columns[c].size*o.columns.frozen;o._szClient.width<=h&&(g=o._szClient.width/o.columns.frozen-5)}o.columns[_].size=g;o.onResizedColumn(r)}}o.columns.isFrozen(c)&&(o.columns[c].size=g)}i.preventDefault()}if(r.row>-1){var m=r.row,w=e.mouseToPage(i).y;d=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(w-this._htDown.point.y)));if(o.rows.isFrozen(m)&&(this._htDown.cellType==a.RowHeader||this._htDown.cellType===a.Cell)){var C=0;for(f=0;f<o.rows.frozen;f++)f!=m&&(C+=null==o.rows[f].height?o.rows[f].renderHeight:o.rows[f].height);var v=o._szClient.height-C-5;d>v&&(d=v)}r.getRow().height=Math.round(d);if("setHeights"in o){var y=o;y.setHeights(Array.from(y.rows).map((function(e){return e.height})))}o.onResizedRow(r);if(s&&this._htDown.cellType==a.RowHeader&&n.containsRow(m)){for(var b=o.rows[m].size,R=n.topRow;R<=n.bottomRow;R++)if(o.rows[R].allowResizing&&R!=m){r=new t.CellRangeEventArgs(o.cells,new t.CellRange(R,-1));if(o.onResizingRow(r)){if(o.rows.isFrozen(R)){var E=o.rows[m].size*o.rows.frozen;o._szClient.height<=E&&(b=o._szClient.height/o.rows.frozen-5)}o.rows[R].size=b;o.onResizedRow(r)}}o.rows.isFrozen(m)&&(o.rows[m].size=b)}o.rows[m].resizedManually=!0;i.preventDefault()}}};_MouseHandler.prototype._handleSelection=function(i,o){var n=this._g,r=n._selHdl.selection,l=new t.CellRange(i.row,i.col),s=t.CellType,a=t.SelectionMode,c=null,u=i.col>=this._anchorCol;if(l.isValid)if(null==this._lbSelState){i.cellType!=s.ColumnHeader&&n._clearAnchorCell();switch(i.cellType){case s.RowHeader:l.col=0;l.col2=n.columns.length-1;break;case s.ColumnHeader:switch(n.selectionMode){case a.Row:case a.Cell:l.row=l.row2=r.row;o=!1;break;default:l.row=0;l.row2=n.rows.length-1;if(null!=(c=n._getColumnGroup(i.row,i.col))){if(n.anchorCursor){c._rng.col<=this._anchorCol&&this._anchorCol<=c._rng.col2&&(this._anchorCol=c._rng.col2);n._setAnchorCell(0,this._anchorCol)}else c._rng.col<this._anchorCol&&this._anchorCol<=c._rng.col2&&(this._anchorCol=c._rng.col);if(u){l.col=c._rng.col2;l.col2=c._rng.col}else{l.col=c._rng.col;l.col2=c._rng.col2;r.col2<l.col2&&(r.col2=l.col2)}}}}if(o){if(i.cellType==s.ColumnHeader){n.anchorCursor?null==n._getAnchorCell()&&n.selectionMode!=t.SelectionMode.Row&&n.selectionMode!=t.SelectionMode.Cell&&n._setAnchorCell(r.row,r.col):n._clearAnchorCell();l.row2=r.row2;!u&&r.col>r.col2?l.col2=r.col:l.col2=r.col2;null!=c&&u&&l.col2>c._rng.col&&(l.col2=c._rng.col)}else if(n.anchorCursor){l.row=r.row;l.col=r.col}else{l.row2=r.row2;l.col2=r.col2}if(!l.isValid){var d=this._htDown;d&&(l=new t.CellRange(d.row,d.col))}}if(n.selectionMode==t.SelectionMode.MultiRange){var h=n._mouseHdl._eMouse,f=h&&(h.ctrlKey||h.metaKey),p=n._selHdl,g=p.selection,_=p.extendedSelection,m=i.panel!=n.cells;e.closest(h.target,".wj-elem-collapse")&&(f=!1);if(f){if(!o&&p._deselectRange(l))p.selection.isValid&&(l=null);else if(g.isValid&&(m||!g.intersects(l))){var w=this._g,C=w._selHdl,v=C.extendedSelection;if(w._getProductInfo().indexOf("MultiRow")>-1){var y=!1;g=C.selection.clone();for(M=0;M<v.length&&!y;M++)v[M].equals(g)&&(y=!0);y||v.push(g)}else{var b=C.selection;(m?this._splitRange(b):[b.clone()]).forEach((function(e){for(var t=!1,i=0;i<v.length&&!t;i++)v[i].equals(e)&&(t=!0);t||v.push(e)}))}}}else _.clear()}if(l){n.select(l,!1);switch(i.cellType){case s.RowHeader:n.scrollIntoView(i.row,-1);break;case s.ColumnHeader:n.scrollIntoView(-1,i.col);break;default:n.scrollIntoView(i.row,i.col)}}else{var R=new t.CellRangeEventArgs(n.cells,new t.CellRange(i.row,i.col));n.onSelectionChanging(R);n.onSelectionChanged(R);n.invalidate()}}else{var E=this._htDown.row,x=i.row,S=this._lbSel;if(E>x){x=E;E=i.row}var H=this._lbSelStateRows||{};if(this._lbSel)for(var M=S.row;M<=S.row2;M++)(M<E||M>x)&&(n.rows[M].isSelected=H[M]);for(var M=E;M<=x;M++){H.hasOwnProperty(M)||(H[M]=n.rows[M].isSelected);n.rows[M].isSelected=!this._lbSelState}this._lbSel=new t.CellRange(E,0,x,0);n.scrollIntoView(i.row,i.col)}};_MouseHandler.prototype._splitRange=function(e){var i=this._g,o=i.columns.length,n=i.rows.length,r=[];if(e.columnSpan==o)for(var l=e.topRow;l<=e.bottomRow;l++)r.push(new t.CellRange(l,0,l,o-1));else if(e.rowSpan==n)for(var s=e.leftCol;s<=e.rightCol;s++)r.push(new t.CellRange(0,s,n-1,s));else r.push(e.clone());return r};_MouseHandler._SZ_MIN=0;_MouseHandler._SZ_MAX_COLGRP_EDGE=50;return _MouseHandler}();t._MouseHandler=r}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){e.grid||(e.grid={}),e._registerModule("wijmo.grid",e.grid)}(wijmo||(wijmo={}));